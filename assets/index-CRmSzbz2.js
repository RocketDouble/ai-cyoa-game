(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function o(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function c(d){if(d.ep)return;d.ep=!0;const f=o(d);fetch(d.href,f)}})();function vg(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var Do={exports:{}},tr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yf;function Sg(){if(Yf)return tr;Yf=1;var x=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function o(c,d,f){var h=null;if(f!==void 0&&(h=""+f),d.key!==void 0&&(h=""+d.key),"key"in d){f={};for(var g in d)g!=="key"&&(f[g]=d[g])}else f=d;return d=f.ref,{$$typeof:x,type:c,key:h,ref:d!==void 0?d:null,props:f}}return tr.Fragment=i,tr.jsx=o,tr.jsxs=o,tr}var qf;function jg(){return qf||(qf=1,Do.exports=Sg()),Do.exports}var s=jg(),Ho={exports:{}},me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vf;function kg(){if(Vf)return me;Vf=1;var x=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),z=Symbol.iterator;function G(v){return v===null||typeof v!="object"?null:(v=z&&v[z]||v["@@iterator"],typeof v=="function"?v:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,I={};function ue(v,O,K){this.props=v,this.context=O,this.refs=I,this.updater=K||B}ue.prototype.isReactComponent={},ue.prototype.setState=function(v,O){if(typeof v!="object"&&typeof v!="function"&&v!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,v,O,"setState")},ue.prototype.forceUpdate=function(v){this.updater.enqueueForceUpdate(this,v,"forceUpdate")};function oe(){}oe.prototype=ue.prototype;function Q(v,O,K){this.props=v,this.context=O,this.refs=I,this.updater=K||B}var W=Q.prototype=new oe;W.constructor=Q,q(W,ue.prototype),W.isPureReactComponent=!0;var je=Array.isArray;function be(){}var V={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function U(v,O,K){var F=K.ref;return{$$typeof:x,type:v,key:O,ref:F!==void 0?F:null,props:K}}function Y(v,O){return U(v.type,O,v.props)}function se(v){return typeof v=="object"&&v!==null&&v.$$typeof===x}function ie(v){var O={"=":"=0",":":"=2"};return"$"+v.replace(/[=:]/g,function(K){return O[K]})}var qe=/\/+/g;function ae(v,O){return typeof v=="object"&&v!==null&&v.key!=null?ie(""+v.key):O.toString(36)}function xe(v){switch(v.status){case"fulfilled":return v.value;case"rejected":throw v.reason;default:switch(typeof v.status=="string"?v.then(be,be):(v.status="pending",v.then(function(O){v.status==="pending"&&(v.status="fulfilled",v.value=O)},function(O){v.status==="pending"&&(v.status="rejected",v.reason=O)})),v.status){case"fulfilled":return v.value;case"rejected":throw v.reason}}throw v}function E(v,O,K,F,de){var he=typeof v;(he==="undefined"||he==="boolean")&&(v=null);var Se=!1;if(v===null)Se=!0;else switch(he){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(v.$$typeof){case x:case i:Se=!0;break;case j:return Se=v._init,E(Se(v._payload),O,K,F,de)}}if(Se)return de=de(v),Se=F===""?"."+ae(v,0):F,je(de)?(K="",Se!=null&&(K=Se.replace(qe,"$&/")+"/"),E(de,O,K,"",function(Mt){return Mt})):de!=null&&(se(de)&&(de=Y(de,K+(de.key==null||v&&v.key===de.key?"":(""+de.key).replace(qe,"$&/")+"/")+Se)),O.push(de)),1;Se=0;var Ue=F===""?".":F+":";if(je(v))for(var Xe=0;Xe<v.length;Xe++)F=v[Xe],he=Ue+ae(F,Xe),Se+=E(F,O,K,he,de);else if(Xe=G(v),typeof Xe=="function")for(v=Xe.call(v),Xe=0;!(F=v.next()).done;)F=F.value,he=Ue+ae(F,Xe++),Se+=E(F,O,K,he,de);else if(he==="object"){if(typeof v.then=="function")return E(xe(v),O,K,F,de);throw O=String(v),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Se}function L(v,O,K){if(v==null)return v;var F=[],de=0;return E(v,F,"","",function(he){return O.call(K,he,de++)}),F}function X(v){if(v._status===-1){var O=v._result;O=O(),O.then(function(K){(v._status===0||v._status===-1)&&(v._status=1,v._result=K)},function(K){(v._status===0||v._status===-1)&&(v._status=2,v._result=K)}),v._status===-1&&(v._status=0,v._result=O)}if(v._status===1)return v._result.default;throw v._result}var re=typeof reportError=="function"?reportError:function(v){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof v=="object"&&v!==null&&typeof v.message=="string"?String(v.message):String(v),error:v});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",v);return}console.error(v)},ge={map:L,forEach:function(v,O,K){L(v,function(){O.apply(this,arguments)},K)},count:function(v){var O=0;return L(v,function(){O++}),O},toArray:function(v){return L(v,function(O){return O})||[]},only:function(v){if(!se(v))throw Error("React.Children.only expected to receive a single React element child.");return v}};return me.Activity=T,me.Children=ge,me.Component=ue,me.Fragment=o,me.Profiler=d,me.PureComponent=Q,me.StrictMode=c,me.Suspense=p,me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,me.__COMPILER_RUNTIME={__proto__:null,c:function(v){return V.H.useMemoCache(v)}},me.cache=function(v){return function(){return v.apply(null,arguments)}},me.cacheSignal=function(){return null},me.cloneElement=function(v,O,K){if(v==null)throw Error("The argument must be a React element, but you passed "+v+".");var F=q({},v.props),de=v.key;if(O!=null)for(he in O.key!==void 0&&(de=""+O.key),O)!R.call(O,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&O.ref===void 0||(F[he]=O[he]);var he=arguments.length-2;if(he===1)F.children=K;else if(1<he){for(var Se=Array(he),Ue=0;Ue<he;Ue++)Se[Ue]=arguments[Ue+2];F.children=Se}return U(v.type,de,F)},me.createContext=function(v){return v={$$typeof:h,_currentValue:v,_currentValue2:v,_threadCount:0,Provider:null,Consumer:null},v.Provider=v,v.Consumer={$$typeof:f,_context:v},v},me.createElement=function(v,O,K){var F,de={},he=null;if(O!=null)for(F in O.key!==void 0&&(he=""+O.key),O)R.call(O,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(de[F]=O[F]);var Se=arguments.length-2;if(Se===1)de.children=K;else if(1<Se){for(var Ue=Array(Se),Xe=0;Xe<Se;Xe++)Ue[Xe]=arguments[Xe+2];de.children=Ue}if(v&&v.defaultProps)for(F in Se=v.defaultProps,Se)de[F]===void 0&&(de[F]=Se[F]);return U(v,he,de)},me.createRef=function(){return{current:null}},me.forwardRef=function(v){return{$$typeof:g,render:v}},me.isValidElement=se,me.lazy=function(v){return{$$typeof:j,_payload:{_status:-1,_result:v},_init:X}},me.memo=function(v,O){return{$$typeof:y,type:v,compare:O===void 0?null:O}},me.startTransition=function(v){var O=V.T,K={};V.T=K;try{var F=v(),de=V.S;de!==null&&de(K,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(be,re)}catch(he){re(he)}finally{O!==null&&K.types!==null&&(O.types=K.types),V.T=O}},me.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},me.use=function(v){return V.H.use(v)},me.useActionState=function(v,O,K){return V.H.useActionState(v,O,K)},me.useCallback=function(v,O){return V.H.useCallback(v,O)},me.useContext=function(v){return V.H.useContext(v)},me.useDebugValue=function(){},me.useDeferredValue=function(v,O){return V.H.useDeferredValue(v,O)},me.useEffect=function(v,O){return V.H.useEffect(v,O)},me.useEffectEvent=function(v){return V.H.useEffectEvent(v)},me.useId=function(){return V.H.useId()},me.useImperativeHandle=function(v,O,K){return V.H.useImperativeHandle(v,O,K)},me.useInsertionEffect=function(v,O){return V.H.useInsertionEffect(v,O)},me.useLayoutEffect=function(v,O){return V.H.useLayoutEffect(v,O)},me.useMemo=function(v,O){return V.H.useMemo(v,O)},me.useOptimistic=function(v,O){return V.H.useOptimistic(v,O)},me.useReducer=function(v,O,K){return V.H.useReducer(v,O,K)},me.useRef=function(v){return V.H.useRef(v)},me.useState=function(v){return V.H.useState(v)},me.useSyncExternalStore=function(v,O,K){return V.H.useSyncExternalStore(v,O,K)},me.useTransition=function(){return V.H.useTransition()},me.version="19.2.0",me}var Xf;function Vo(){return Xf||(Xf=1,Ho.exports=kg()),Ho.exports}var A=Vo();const Ng=vg(A);var Lo={exports:{}},ar={},Go={exports:{}},Bo={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kf;function wg(){return Kf||(Kf=1,(function(x){function i(E,L){var X=E.length;E.push(L);e:for(;0<X;){var re=X-1>>>1,ge=E[re];if(0<d(ge,L))E[re]=L,E[X]=ge,X=re;else break e}}function o(E){return E.length===0?null:E[0]}function c(E){if(E.length===0)return null;var L=E[0],X=E.pop();if(X!==L){E[0]=X;e:for(var re=0,ge=E.length,v=ge>>>1;re<v;){var O=2*(re+1)-1,K=E[O],F=O+1,de=E[F];if(0>d(K,X))F<ge&&0>d(de,K)?(E[re]=de,E[F]=X,re=F):(E[re]=K,E[O]=X,re=O);else if(F<ge&&0>d(de,X))E[re]=de,E[F]=X,re=F;else break e}}return L}function d(E,L){var X=E.sortIndex-L.sortIndex;return X!==0?X:E.id-L.id}if(x.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;x.unstable_now=function(){return f.now()}}else{var h=Date,g=h.now();x.unstable_now=function(){return h.now()-g}}var p=[],y=[],j=1,T=null,z=3,G=!1,B=!1,q=!1,I=!1,ue=typeof setTimeout=="function"?setTimeout:null,oe=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function W(E){for(var L=o(y);L!==null;){if(L.callback===null)c(y);else if(L.startTime<=E)c(y),L.sortIndex=L.expirationTime,i(p,L);else break;L=o(y)}}function je(E){if(q=!1,W(E),!B)if(o(p)!==null)B=!0,be||(be=!0,ie());else{var L=o(y);L!==null&&xe(je,L.startTime-E)}}var be=!1,V=-1,R=5,U=-1;function Y(){return I?!0:!(x.unstable_now()-U<R)}function se(){if(I=!1,be){var E=x.unstable_now();U=E;var L=!0;try{e:{B=!1,q&&(q=!1,oe(V),V=-1),G=!0;var X=z;try{t:{for(W(E),T=o(p);T!==null&&!(T.expirationTime>E&&Y());){var re=T.callback;if(typeof re=="function"){T.callback=null,z=T.priorityLevel;var ge=re(T.expirationTime<=E);if(E=x.unstable_now(),typeof ge=="function"){T.callback=ge,W(E),L=!0;break t}T===o(p)&&c(p),W(E)}else c(p);T=o(p)}if(T!==null)L=!0;else{var v=o(y);v!==null&&xe(je,v.startTime-E),L=!1}}break e}finally{T=null,z=X,G=!1}L=void 0}}finally{L?ie():be=!1}}}var ie;if(typeof Q=="function")ie=function(){Q(se)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,ae=qe.port2;qe.port1.onmessage=se,ie=function(){ae.postMessage(null)}}else ie=function(){ue(se,0)};function xe(E,L){V=ue(function(){E(x.unstable_now())},L)}x.unstable_IdlePriority=5,x.unstable_ImmediatePriority=1,x.unstable_LowPriority=4,x.unstable_NormalPriority=3,x.unstable_Profiling=null,x.unstable_UserBlockingPriority=2,x.unstable_cancelCallback=function(E){E.callback=null},x.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<E?Math.floor(1e3/E):5},x.unstable_getCurrentPriorityLevel=function(){return z},x.unstable_next=function(E){switch(z){case 1:case 2:case 3:var L=3;break;default:L=z}var X=z;z=L;try{return E()}finally{z=X}},x.unstable_requestPaint=function(){I=!0},x.unstable_runWithPriority=function(E,L){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var X=z;z=E;try{return L()}finally{z=X}},x.unstable_scheduleCallback=function(E,L,X){var re=x.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,E){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=X+ge,E={id:j++,callback:L,priorityLevel:E,startTime:X,expirationTime:ge,sortIndex:-1},X>re?(E.sortIndex=X,i(y,E),o(p)===null&&E===o(y)&&(q?(oe(V),V=-1):q=!0,xe(je,X-re))):(E.sortIndex=ge,i(p,E),B||G||(B=!0,be||(be=!0,ie()))),E},x.unstable_shouldYield=Y,x.unstable_wrapCallback=function(E){var L=z;return function(){var X=z;z=L;try{return E.apply(this,arguments)}finally{z=X}}}})(Bo)),Bo}var Qf;function Cg(){return Qf||(Qf=1,Go.exports=wg()),Go.exports}var Yo={exports:{}},ot={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var If;function Tg(){if(If)return ot;If=1;var x=Vo();function i(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var j=2;j<arguments.length;j++)y+="&args[]="+encodeURIComponent(arguments[j])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var c={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},d=Symbol.for("react.portal");function f(p,y,j){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:T==null?null:""+T,children:p,containerInfo:y,implementation:j}}var h=x.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ot.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=c,ot.createPortal=function(p,y){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(i(299));return f(p,y,null,j)},ot.flushSync=function(p){var y=h.T,j=c.p;try{if(h.T=null,c.p=2,p)return p()}finally{h.T=y,c.p=j,c.d.f()}},ot.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,c.d.C(p,y))},ot.prefetchDNS=function(p){typeof p=="string"&&c.d.D(p)},ot.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var j=y.as,T=g(j,y.crossOrigin),z=typeof y.integrity=="string"?y.integrity:void 0,G=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;j==="style"?c.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:T,integrity:z,fetchPriority:G}):j==="script"&&c.d.X(p,{crossOrigin:T,integrity:z,fetchPriority:G,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ot.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var j=g(y.as,y.crossOrigin);c.d.M(p,{crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&c.d.M(p)},ot.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var j=y.as,T=g(j,y.crossOrigin);c.d.L(p,j,{crossOrigin:T,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ot.preloadModule=function(p,y){if(typeof p=="string")if(y){var j=g(y.as,y.crossOrigin);c.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else c.d.m(p)},ot.requestFormReset=function(p){c.d.r(p)},ot.unstable_batchedUpdates=function(p,y){return p(y)},ot.useFormState=function(p,y,j){return h.H.useFormState(p,y,j)},ot.useFormStatus=function(){return h.H.useHostTransitionStatus()},ot.version="19.2.0",ot}var Zf;function Eg(){if(Zf)return Yo.exports;Zf=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(i){console.error(i)}}return x(),Yo.exports=Tg(),Yo.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jf;function Ag(){if(Jf)return ar;Jf=1;var x=Cg(),i=Vo(),o=Eg();function c(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function f(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(f(e)!==e)throw Error(c(188))}function y(e){var t=e.alternate;if(!t){if(t=f(e),t===null)throw Error(c(188));return t!==e?null:e}for(var a=e,l=t;;){var n=a.return;if(n===null)break;var r=n.alternate;if(r===null){if(l=n.return,l!==null){a=l;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===a)return p(n),e;if(r===l)return p(n),t;r=r.sibling}throw Error(c(188))}if(a.return!==l.return)a=n,l=r;else{for(var u=!1,m=n.child;m;){if(m===a){u=!0,a=n,l=r;break}if(m===l){u=!0,l=n,a=r;break}m=m.sibling}if(!u){for(m=r.child;m;){if(m===a){u=!0,a=r,l=n;break}if(m===l){u=!0,l=r,a=n;break}m=m.sibling}if(!u)throw Error(c(189))}}if(a.alternate!==l)throw Error(c(190))}if(a.tag!==3)throw Error(c(188));return a.stateNode.current===a?e:t}function j(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=j(e),t!==null)return t;e=e.sibling}return null}var T=Object.assign,z=Symbol.for("react.element"),G=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),ue=Symbol.for("react.profiler"),oe=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),se=Symbol.iterator;function ie(e){return e===null||typeof e!="object"?null:(e=se&&e[se]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Symbol.for("react.client.reference");function ae(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===qe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case q:return"Fragment";case ue:return"Profiler";case I:return"StrictMode";case je:return"Suspense";case be:return"SuspenseList";case U:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case B:return"Portal";case Q:return e.displayName||"Context";case oe:return(e._context.displayName||"Context")+".Consumer";case W:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case V:return t=e.displayName||null,t!==null?t:ae(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return ae(e(t))}catch{}}return null}var xe=Array.isArray,E=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},re=[],ge=-1;function v(e){return{current:e}}function O(e){0>ge||(e.current=re[ge],re[ge]=null,ge--)}function K(e,t){ge++,re[ge]=e.current,e.current=t}var F=v(null),de=v(null),he=v(null),Se=v(null);function Ue(e,t){switch(K(he,t),K(de,e),K(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?uf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=uf(t),e=df(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}O(F),K(F,e)}function Xe(){O(F),O(de),O(he)}function Mt(e){e.memoizedState!==null&&K(Se,e);var t=F.current,a=df(t,e.type);t!==a&&(K(de,e),K(F,a))}function Qt(e){de.current===e&&(O(F),O(de)),Se.current===e&&(O(Se),Wn._currentValue=X)}var ka,xl;function ea(e){if(ka===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);ka=t&&t[1]||"",xl=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ka+e+xl}var an=!1;function ln(e,t){if(!e||an)return"";an=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var H=function(){throw Error()};if(Object.defineProperty(H.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(H,[])}catch(M){var C=M}Reflect.construct(e,[],H)}else{try{H.call()}catch(M){C=M}e.call(H.prototype)}}else{try{throw Error()}catch(M){C=M}(H=e())&&typeof H.catch=="function"&&H.catch(function(){})}}catch(M){if(M&&C&&typeof M.stack=="string")return[M.stack,C.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=l.DetermineComponentFrameRoot(),u=r[0],m=r[1];if(u&&m){var b=u.split(`
`),w=m.split(`
`);for(n=l=0;l<b.length&&!b[l].includes("DetermineComponentFrameRoot");)l++;for(;n<w.length&&!w[n].includes("DetermineComponentFrameRoot");)n++;if(l===b.length||n===w.length)for(l=b.length-1,n=w.length-1;1<=l&&0<=n&&b[l]!==w[n];)n--;for(;1<=l&&0<=n;l--,n--)if(b[l]!==w[n]){if(l!==1||n!==1)do if(l--,n--,0>n||b[l]!==w[n]){var _=`
`+b[l].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=l&&0<=n);break}}}finally{an=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?ea(a):""}function Na(e,t){switch(e.tag){case 26:case 27:case 5:return ea(e.type);case 16:return ea("Lazy");case 13:return e.child!==t&&t!==null?ea("Suspense Fallback"):ea("Suspense");case 19:return ea("SuspenseList");case 0:case 15:return ln(e.type,!1);case 11:return ln(e.type.render,!1);case 1:return ln(e.type,!0);case 31:return ea("Activity");default:return""}}function nn(e){try{var t="",a=null;do t+=Na(e,a),a=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var rn=Object.prototype.hasOwnProperty,sn=x.unstable_scheduleCallback,on=x.unstable_cancelCallback,Z=x.unstable_shouldYield,J=x.unstable_requestPaint,$=x.unstable_now,ve=x.unstable_getCurrentPriorityLevel,le=x.unstable_ImmediatePriority,fe=x.unstable_UserBlockingPriority,Oe=x.unstable_NormalPriority,Ke=x.unstable_LowPriority,Rt=x.unstable_IdlePriority,ut=x.log,l0=x.unstable_setDisableYieldValue,cn=null,bt=null;function wa(e){if(typeof ut=="function"&&l0(e),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(cn,e)}catch{}}var vt=Math.clz32?Math.clz32:s0,n0=Math.log,r0=Math.LN2;function s0(e){return e>>>=0,e===0?32:31-(n0(e)/r0|0)|0}var nr=256,rr=262144,sr=4194304;function Fa(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ir(e,t,a){var l=e.pendingLanes;if(l===0)return 0;var n=0,r=e.suspendedLanes,u=e.pingedLanes;e=e.warmLanes;var m=l&134217727;return m!==0?(l=m&~r,l!==0?n=Fa(l):(u&=m,u!==0?n=Fa(u):a||(a=m&~e,a!==0&&(n=Fa(a))))):(m=l&~r,m!==0?n=Fa(m):u!==0?n=Fa(u):a||(a=l&~e,a!==0&&(n=Fa(a)))),n===0?0:t!==0&&t!==n&&(t&r)===0&&(r=n&-n,a=t&-t,r>=a||r===32&&(a&4194048)!==0)?t:n}function un(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function i0(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xo(){var e=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),e}function ks(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function dn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function o0(e,t,a,l,n,r){var u=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var m=e.entanglements,b=e.expirationTimes,w=e.hiddenUpdates;for(a=u&~a;0<a;){var _=31-vt(a),H=1<<_;m[_]=0,b[_]=-1;var C=w[_];if(C!==null)for(w[_]=null,_=0;_<C.length;_++){var M=C[_];M!==null&&(M.lane&=-536870913)}a&=~H}l!==0&&Ko(e,l,0),r!==0&&n===0&&e.tag!==0&&(e.suspendedLanes|=r&~(u&~t))}function Ko(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-vt(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|a&261930}function Qo(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var l=31-vt(a),n=1<<l;n&t|e[l]&t&&(e[l]|=t),a&=~n}}function Io(e,t){var a=t&-t;return a=(a&42)!==0?1:Ns(a),(a&(e.suspendedLanes|t))!==0?0:a}function Ns(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ws(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Zo(){var e=L.p;return e!==0?e:(e=window.event,e===void 0?32:_f(e.type))}function Jo(e,t){var a=L.p;try{return L.p=e,t()}finally{L.p=a}}var Ca=Math.random().toString(36).slice(2),lt="__reactFiber$"+Ca,ft="__reactProps$"+Ca,pl="__reactContainer$"+Ca,Cs="__reactEvents$"+Ca,c0="__reactListeners$"+Ca,u0="__reactHandles$"+Ca,$o="__reactResources$"+Ca,fn="__reactMarker$"+Ca;function Ts(e){delete e[lt],delete e[ft],delete e[Cs],delete e[c0],delete e[u0]}function bl(e){var t=e[lt];if(t)return t;for(var a=e.parentNode;a;){if(t=a[pl]||a[lt]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=pf(e);e!==null;){if(a=e[lt])return a;e=pf(e)}return t}e=a,a=e.parentNode}return null}function vl(e){if(e=e[lt]||e[pl]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function mn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(c(33))}function Sl(e){var t=e[$o];return t||(t=e[$o]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function tt(e){e[fn]=!0}var Wo=new Set,Fo={};function Pa(e,t){jl(e,t),jl(e+"Capture",t)}function jl(e,t){for(Fo[e]=t,e=0;e<t.length;e++)Wo.add(t[e])}var d0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Po={},ec={};function f0(e){return rn.call(ec,e)?!0:rn.call(Po,e)?!1:d0.test(e)?ec[e]=!0:(Po[e]=!0,!1)}function or(e,t,a){if(f0(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function cr(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function ta(e,t,a,l){if(l===null)e.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+l)}}function Ot(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function tc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function m0(e,t,a){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var n=l.get,r=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(u){a=""+u,r.call(this,u)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return a},setValue:function(u){a=""+u},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Es(e){if(!e._valueTracker){var t=tc(e)?"checked":"value";e._valueTracker=m0(e,t,""+e[t])}}function ac(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),l="";return e&&(l=tc(e)?e.checked?"true":"false":e.value),e=l,e!==a?(t.setValue(e),!0):!1}function ur(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var g0=/[\n"\\]/g;function zt(e){return e.replace(g0,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function As(e,t,a,l,n,r,u,m){e.name="",u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"?e.type=u:e.removeAttribute("type"),t!=null?u==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ot(t)):e.value!==""+Ot(t)&&(e.value=""+Ot(t)):u!=="submit"&&u!=="reset"||e.removeAttribute("value"),t!=null?Ms(e,u,Ot(t)):a!=null?Ms(e,u,Ot(a)):l!=null&&e.removeAttribute("value"),n==null&&r!=null&&(e.defaultChecked=!!r),n!=null&&(e.checked=n&&typeof n!="function"&&typeof n!="symbol"),m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?e.name=""+Ot(m):e.removeAttribute("name")}function lc(e,t,a,l,n,r,u,m){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(e.type=r),t!=null||a!=null){if(!(r!=="submit"&&r!=="reset"||t!=null)){Es(e);return}a=a!=null?""+Ot(a):"",t=t!=null?""+Ot(t):a,m||t===e.value||(e.value=t),e.defaultValue=t}l=l??n,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=m?e.checked:!!l,e.defaultChecked=!!l,u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.name=u),Es(e)}function Ms(e,t,a){t==="number"&&ur(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function kl(e,t,a,l){if(e=e.options,t){t={};for(var n=0;n<a.length;n++)t["$"+a[n]]=!0;for(a=0;a<e.length;a++)n=t.hasOwnProperty("$"+e[a].value),e[a].selected!==n&&(e[a].selected=n),n&&l&&(e[a].defaultSelected=!0)}else{for(a=""+Ot(a),t=null,n=0;n<e.length;n++){if(e[n].value===a){e[n].selected=!0,l&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function nc(e,t,a){if(t!=null&&(t=""+Ot(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Ot(a):""}function rc(e,t,a,l){if(t==null){if(l!=null){if(a!=null)throw Error(c(92));if(xe(l)){if(1<l.length)throw Error(c(93));l=l[0]}a=l}a==null&&(a=""),t=a}a=Ot(t),e.defaultValue=a,l=e.textContent,l===a&&l!==""&&l!==null&&(e.value=l),Es(e)}function Nl(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var h0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sc(e,t,a){var l=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,a):typeof a!="number"||a===0||h0.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function ic(e,t,a){if(t!=null&&typeof t!="object")throw Error(c(62));if(e=e.style,a!=null){for(var l in a)!a.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var n in t)l=t[n],t.hasOwnProperty(n)&&a[n]!==l&&sc(e,n,l)}else for(var r in t)t.hasOwnProperty(r)&&sc(e,r,t[r])}function Rs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var y0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),x0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dr(e){return x0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function aa(){}var Os=null;function zs(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wl=null,Cl=null;function oc(e){var t=vl(e);if(t&&(e=t.stateNode)){var a=e[ft]||null;e:switch(e=t.stateNode,t.type){case"input":if(As(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+zt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var l=a[t];if(l!==e&&l.form===e.form){var n=l[ft]||null;if(!n)throw Error(c(90));As(l,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<a.length;t++)l=a[t],l.form===e.form&&ac(l)}break e;case"textarea":nc(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&kl(e,!!a.multiple,t,!1)}}}var _s=!1;function cc(e,t,a){if(_s)return e(t,a);_s=!0;try{var l=e(t);return l}finally{if(_s=!1,(wl!==null||Cl!==null)&&(Fr(),wl&&(t=wl,e=Cl,Cl=wl=null,oc(t),e)))for(t=0;t<e.length;t++)oc(e[t])}}function gn(e,t){var a=e.stateNode;if(a===null)return null;var l=a[ft]||null;if(l===null)return null;a=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(c(231,t,typeof a));return a}var la=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Us=!1;if(la)try{var hn={};Object.defineProperty(hn,"passive",{get:function(){Us=!0}}),window.addEventListener("test",hn,hn),window.removeEventListener("test",hn,hn)}catch{Us=!1}var Ta=null,Ds=null,fr=null;function uc(){if(fr)return fr;var e,t=Ds,a=t.length,l,n="value"in Ta?Ta.value:Ta.textContent,r=n.length;for(e=0;e<a&&t[e]===n[e];e++);var u=a-e;for(l=1;l<=u&&t[a-l]===n[r-l];l++);return fr=n.slice(e,1<l?1-l:void 0)}function mr(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gr(){return!0}function dc(){return!1}function mt(e){function t(a,l,n,r,u){this._reactName=a,this._targetInst=n,this.type=l,this.nativeEvent=r,this.target=u,this.currentTarget=null;for(var m in e)e.hasOwnProperty(m)&&(a=e[m],this[m]=a?a(r):r[m]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?gr:dc,this.isPropagationStopped=dc,this}return T(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=gr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=gr)},persist:function(){},isPersistent:gr}),t}var el={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hr=mt(el),yn=T({},el,{view:0,detail:0}),p0=mt(yn),Hs,Ls,xn,yr=T({},yn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bs,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==xn&&(xn&&e.type==="mousemove"?(Hs=e.screenX-xn.screenX,Ls=e.screenY-xn.screenY):Ls=Hs=0,xn=e),Hs)},movementY:function(e){return"movementY"in e?e.movementY:Ls}}),fc=mt(yr),b0=T({},yr,{dataTransfer:0}),v0=mt(b0),S0=T({},yn,{relatedTarget:0}),Gs=mt(S0),j0=T({},el,{animationName:0,elapsedTime:0,pseudoElement:0}),k0=mt(j0),N0=T({},el,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),w0=mt(N0),C0=T({},el,{data:0}),mc=mt(C0),T0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},A0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function M0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=A0[e])?!!t[e]:!1}function Bs(){return M0}var R0=T({},yn,{key:function(e){if(e.key){var t=T0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=mr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?E0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bs,charCode:function(e){return e.type==="keypress"?mr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),O0=mt(R0),z0=T({},yr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gc=mt(z0),_0=T({},yn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bs}),U0=mt(_0),D0=T({},el,{propertyName:0,elapsedTime:0,pseudoElement:0}),H0=mt(D0),L0=T({},yr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),G0=mt(L0),B0=T({},el,{newState:0,oldState:0}),Y0=mt(B0),q0=[9,13,27,32],Ys=la&&"CompositionEvent"in window,pn=null;la&&"documentMode"in document&&(pn=document.documentMode);var V0=la&&"TextEvent"in window&&!pn,hc=la&&(!Ys||pn&&8<pn&&11>=pn),yc=" ",xc=!1;function pc(e,t){switch(e){case"keyup":return q0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Tl=!1;function X0(e,t){switch(e){case"compositionend":return bc(t);case"keypress":return t.which!==32?null:(xc=!0,yc);case"textInput":return e=t.data,e===yc&&xc?null:e;default:return null}}function K0(e,t){if(Tl)return e==="compositionend"||!Ys&&pc(e,t)?(e=uc(),fr=Ds=Ta=null,Tl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hc&&t.locale!=="ko"?null:t.data;default:return null}}var Q0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Q0[e.type]:t==="textarea"}function Sc(e,t,a,l){wl?Cl?Cl.push(l):Cl=[l]:wl=l,t=rs(t,"onChange"),0<t.length&&(a=new hr("onChange","change",null,a,l),e.push({event:a,listeners:t}))}var bn=null,vn=null;function I0(e){lf(e,0)}function xr(e){var t=mn(e);if(ac(t))return e}function jc(e,t){if(e==="change")return t}var kc=!1;if(la){var qs;if(la){var Vs="oninput"in document;if(!Vs){var Nc=document.createElement("div");Nc.setAttribute("oninput","return;"),Vs=typeof Nc.oninput=="function"}qs=Vs}else qs=!1;kc=qs&&(!document.documentMode||9<document.documentMode)}function wc(){bn&&(bn.detachEvent("onpropertychange",Cc),vn=bn=null)}function Cc(e){if(e.propertyName==="value"&&xr(vn)){var t=[];Sc(t,vn,e,zs(e)),cc(I0,t)}}function Z0(e,t,a){e==="focusin"?(wc(),bn=t,vn=a,bn.attachEvent("onpropertychange",Cc)):e==="focusout"&&wc()}function J0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xr(vn)}function $0(e,t){if(e==="click")return xr(t)}function W0(e,t){if(e==="input"||e==="change")return xr(t)}function F0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var St=typeof Object.is=="function"?Object.is:F0;function Sn(e,t){if(St(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),l=Object.keys(t);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var n=a[l];if(!rn.call(t,n)||!St(e[n],t[n]))return!1}return!0}function Tc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ec(e,t){var a=Tc(e);e=0;for(var l;a;){if(a.nodeType===3){if(l=e+a.textContent.length,e<=t&&l>=t)return{node:a,offset:t-e};e=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Tc(a)}}function Ac(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ac(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Mc(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=ur(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=ur(e.document)}return t}function Xs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var P0=la&&"documentMode"in document&&11>=document.documentMode,El=null,Ks=null,jn=null,Qs=!1;function Rc(e,t,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Qs||El==null||El!==ur(l)||(l=El,"selectionStart"in l&&Xs(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),jn&&Sn(jn,l)||(jn=l,l=rs(Ks,"onSelect"),0<l.length&&(t=new hr("onSelect","select",null,t,a),e.push({event:t,listeners:l}),t.target=El)))}function tl(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Al={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionrun:tl("Transition","TransitionRun"),transitionstart:tl("Transition","TransitionStart"),transitioncancel:tl("Transition","TransitionCancel"),transitionend:tl("Transition","TransitionEnd")},Is={},Oc={};la&&(Oc=document.createElement("div").style,"AnimationEvent"in window||(delete Al.animationend.animation,delete Al.animationiteration.animation,delete Al.animationstart.animation),"TransitionEvent"in window||delete Al.transitionend.transition);function al(e){if(Is[e])return Is[e];if(!Al[e])return e;var t=Al[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in Oc)return Is[e]=t[a];return e}var zc=al("animationend"),_c=al("animationiteration"),Uc=al("animationstart"),em=al("transitionrun"),tm=al("transitionstart"),am=al("transitioncancel"),Dc=al("transitionend"),Hc=new Map,Zs="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zs.push("scrollEnd");function qt(e,t){Hc.set(e,t),Pa(t,[e])}var pr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},_t=[],Ml=0,Js=0;function br(){for(var e=Ml,t=Js=Ml=0;t<e;){var a=_t[t];_t[t++]=null;var l=_t[t];_t[t++]=null;var n=_t[t];_t[t++]=null;var r=_t[t];if(_t[t++]=null,l!==null&&n!==null){var u=l.pending;u===null?n.next=n:(n.next=u.next,u.next=n),l.pending=n}r!==0&&Lc(a,n,r)}}function vr(e,t,a,l){_t[Ml++]=e,_t[Ml++]=t,_t[Ml++]=a,_t[Ml++]=l,Js|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function $s(e,t,a,l){return vr(e,t,a,l),Sr(e)}function ll(e,t){return vr(e,null,null,t),Sr(e)}function Lc(e,t,a){e.lanes|=a;var l=e.alternate;l!==null&&(l.lanes|=a);for(var n=!1,r=e.return;r!==null;)r.childLanes|=a,l=r.alternate,l!==null&&(l.childLanes|=a),r.tag===22&&(e=r.stateNode,e===null||e._visibility&1||(n=!0)),e=r,r=r.return;return e.tag===3?(r=e.stateNode,n&&t!==null&&(n=31-vt(a),e=r.hiddenUpdates,l=e[n],l===null?e[n]=[t]:l.push(t),t.lane=a|536870912),r):null}function Sr(e){if(50<Xn)throw Xn=0,ro=null,Error(c(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Rl={};function lm(e,t,a,l){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(e,t,a,l){return new lm(e,t,a,l)}function Ws(e){return e=e.prototype,!(!e||!e.isReactComponent)}function na(e,t){var a=e.alternate;return a===null?(a=jt(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Gc(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function jr(e,t,a,l,n,r){var u=0;if(l=e,typeof e=="function")Ws(e)&&(u=1);else if(typeof e=="string")u=og(e,a,F.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case U:return e=jt(31,a,t,n),e.elementType=U,e.lanes=r,e;case q:return nl(a.children,n,r,t);case I:u=8,n|=24;break;case ue:return e=jt(12,a,t,n|2),e.elementType=ue,e.lanes=r,e;case je:return e=jt(13,a,t,n),e.elementType=je,e.lanes=r,e;case be:return e=jt(19,a,t,n),e.elementType=be,e.lanes=r,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Q:u=10;break e;case oe:u=9;break e;case W:u=11;break e;case V:u=14;break e;case R:u=16,l=null;break e}u=29,a=Error(c(130,e===null?"null":typeof e,"")),l=null}return t=jt(u,a,t,n),t.elementType=e,t.type=l,t.lanes=r,t}function nl(e,t,a,l){return e=jt(7,e,l,t),e.lanes=a,e}function Fs(e,t,a){return e=jt(6,e,null,t),e.lanes=a,e}function Bc(e){var t=jt(18,null,null,0);return t.stateNode=e,t}function Ps(e,t,a){return t=jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Yc=new WeakMap;function Ut(e,t){if(typeof e=="object"&&e!==null){var a=Yc.get(e);return a!==void 0?a:(t={value:e,source:t,stack:nn(t)},Yc.set(e,t),t)}return{value:e,source:t,stack:nn(t)}}var Ol=[],zl=0,kr=null,kn=0,Dt=[],Ht=0,Ea=null,It=1,Zt="";function ra(e,t){Ol[zl++]=kn,Ol[zl++]=kr,kr=e,kn=t}function qc(e,t,a){Dt[Ht++]=It,Dt[Ht++]=Zt,Dt[Ht++]=Ea,Ea=e;var l=It;e=Zt;var n=32-vt(l)-1;l&=~(1<<n),a+=1;var r=32-vt(t)+n;if(30<r){var u=n-n%5;r=(l&(1<<u)-1).toString(32),l>>=u,n-=u,It=1<<32-vt(t)+n|a<<n|l,Zt=r+e}else It=1<<r|a<<n|l,Zt=e}function ei(e){e.return!==null&&(ra(e,1),qc(e,1,0))}function ti(e){for(;e===kr;)kr=Ol[--zl],Ol[zl]=null,kn=Ol[--zl],Ol[zl]=null;for(;e===Ea;)Ea=Dt[--Ht],Dt[Ht]=null,Zt=Dt[--Ht],Dt[Ht]=null,It=Dt[--Ht],Dt[Ht]=null}function Vc(e,t){Dt[Ht++]=It,Dt[Ht++]=Zt,Dt[Ht++]=Ea,It=t.id,Zt=t.overflow,Ea=e}var nt=null,Be=null,Ee=!1,Aa=null,Lt=!1,ai=Error(c(519));function Ma(e){var t=Error(c(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nn(Ut(t,e)),ai}function Xc(e){var t=e.stateNode,a=e.type,l=e.memoizedProps;switch(t[lt]=e,t[ft]=l,a){case"dialog":Ne("cancel",t),Ne("close",t);break;case"iframe":case"object":case"embed":Ne("load",t);break;case"video":case"audio":for(a=0;a<Qn.length;a++)Ne(Qn[a],t);break;case"source":Ne("error",t);break;case"img":case"image":case"link":Ne("error",t),Ne("load",t);break;case"details":Ne("toggle",t);break;case"input":Ne("invalid",t),lc(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Ne("invalid",t);break;case"textarea":Ne("invalid",t),rc(t,l.value,l.defaultValue,l.children)}a=l.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||l.suppressHydrationWarning===!0||of(t.textContent,a)?(l.popover!=null&&(Ne("beforetoggle",t),Ne("toggle",t)),l.onScroll!=null&&Ne("scroll",t),l.onScrollEnd!=null&&Ne("scrollend",t),l.onClick!=null&&(t.onclick=aa),t=!0):t=!1,t||Ma(e,!0)}function Kc(e){for(nt=e.return;nt;)switch(nt.tag){case 5:case 31:case 13:Lt=!1;return;case 27:case 3:Lt=!0;return;default:nt=nt.return}}function _l(e){if(e!==nt)return!1;if(!Ee)return Kc(e),Ee=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||So(e.type,e.memoizedProps)),a=!a),a&&Be&&Ma(e),Kc(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(c(317));Be=xf(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(c(317));Be=xf(e)}else t===27?(t=Be,Xa(e.type)?(e=Co,Co=null,Be=e):Be=t):Be=nt?Bt(e.stateNode.nextSibling):null;return!0}function rl(){Be=nt=null,Ee=!1}function li(){var e=Aa;return e!==null&&(xt===null?xt=e:xt.push.apply(xt,e),Aa=null),e}function Nn(e){Aa===null?Aa=[e]:Aa.push(e)}var ni=v(null),sl=null,sa=null;function Ra(e,t,a){K(ni,t._currentValue),t._currentValue=a}function ia(e){e._currentValue=ni.current,O(ni)}function ri(e,t,a){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===a)break;e=e.return}}function si(e,t,a,l){var n=e.child;for(n!==null&&(n.return=e);n!==null;){var r=n.dependencies;if(r!==null){var u=n.child;r=r.firstContext;e:for(;r!==null;){var m=r;r=n;for(var b=0;b<t.length;b++)if(m.context===t[b]){r.lanes|=a,m=r.alternate,m!==null&&(m.lanes|=a),ri(r.return,a,e),l||(u=null);break e}r=m.next}}else if(n.tag===18){if(u=n.return,u===null)throw Error(c(341));u.lanes|=a,r=u.alternate,r!==null&&(r.lanes|=a),ri(u,a,e),u=null}else u=n.child;if(u!==null)u.return=n;else for(u=n;u!==null;){if(u===e){u=null;break}if(n=u.sibling,n!==null){n.return=u.return,u=n;break}u=u.return}n=u}}function Ul(e,t,a,l){e=null;for(var n=t,r=!1;n!==null;){if(!r){if((n.flags&524288)!==0)r=!0;else if((n.flags&262144)!==0)break}if(n.tag===10){var u=n.alternate;if(u===null)throw Error(c(387));if(u=u.memoizedProps,u!==null){var m=n.type;St(n.pendingProps.value,u.value)||(e!==null?e.push(m):e=[m])}}else if(n===Se.current){if(u=n.alternate,u===null)throw Error(c(387));u.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(e!==null?e.push(Wn):e=[Wn])}n=n.return}e!==null&&si(t,e,a,l),t.flags|=262144}function Nr(e){for(e=e.firstContext;e!==null;){if(!St(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function il(e){sl=e,sa=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function rt(e){return Qc(sl,e)}function wr(e,t){return sl===null&&il(e),Qc(e,t)}function Qc(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},sa===null){if(e===null)throw Error(c(308));sa=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else sa=sa.next=t;return a}var nm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},rm=x.unstable_scheduleCallback,sm=x.unstable_NormalPriority,$e={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ii(){return{controller:new nm,data:new Map,refCount:0}}function wn(e){e.refCount--,e.refCount===0&&rm(sm,function(){e.controller.abort()})}var Cn=null,oi=0,Dl=0,Hl=null;function im(e,t){if(Cn===null){var a=Cn=[];oi=0,Dl=fo(),Hl={status:"pending",value:void 0,then:function(l){a.push(l)}}}return oi++,t.then(Ic,Ic),t}function Ic(){if(--oi===0&&Cn!==null){Hl!==null&&(Hl.status="fulfilled");var e=Cn;Cn=null,Dl=0,Hl=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function om(e,t){var a=[],l={status:"pending",value:null,reason:null,then:function(n){a.push(n)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var n=0;n<a.length;n++)(0,a[n])(t)},function(n){for(l.status="rejected",l.reason=n,n=0;n<a.length;n++)(0,a[n])(void 0)}),l}var Zc=E.S;E.S=function(e,t){Rd=$(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&im(e,t),Zc!==null&&Zc(e,t)};var ol=v(null);function ci(){var e=ol.current;return e!==null?e:Ge.pooledCache}function Cr(e,t){t===null?K(ol,ol.current):K(ol,t.pool)}function Jc(){var e=ci();return e===null?null:{parent:$e._currentValue,pool:e}}var Ll=Error(c(460)),ui=Error(c(474)),Tr=Error(c(542)),Er={then:function(){}};function $c(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Wc(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(aa,aa),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Pc(e),e;default:if(typeof t.status=="string")t.then(aa,aa);else{if(e=Ge,e!==null&&100<e.shellSuspendCounter)throw Error(c(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var n=t;n.status="fulfilled",n.value=l}},function(l){if(t.status==="pending"){var n=t;n.status="rejected",n.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Pc(e),e}throw ul=t,Ll}}function cl(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(ul=a,Ll):a}}var ul=null;function Fc(){if(ul===null)throw Error(c(459));var e=ul;return ul=null,e}function Pc(e){if(e===Ll||e===Tr)throw Error(c(483))}var Gl=null,Tn=0;function Ar(e){var t=Tn;return Tn+=1,Gl===null&&(Gl=[]),Wc(Gl,e,t)}function En(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Mr(e,t){throw t.$$typeof===z?Error(c(525)):(e=Object.prototype.toString.call(t),Error(c(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function eu(e){function t(k,S){if(e){var N=k.deletions;N===null?(k.deletions=[S],k.flags|=16):N.push(S)}}function a(k,S){if(!e)return null;for(;S!==null;)t(k,S),S=S.sibling;return null}function l(k){for(var S=new Map;k!==null;)k.key!==null?S.set(k.key,k):S.set(k.index,k),k=k.sibling;return S}function n(k,S){return k=na(k,S),k.index=0,k.sibling=null,k}function r(k,S,N){return k.index=N,e?(N=k.alternate,N!==null?(N=N.index,N<S?(k.flags|=67108866,S):N):(k.flags|=67108866,S)):(k.flags|=1048576,S)}function u(k){return e&&k.alternate===null&&(k.flags|=67108866),k}function m(k,S,N,D){return S===null||S.tag!==6?(S=Fs(N,k.mode,D),S.return=k,S):(S=n(S,N),S.return=k,S)}function b(k,S,N,D){var ne=N.type;return ne===q?_(k,S,N.props.children,D,N.key):S!==null&&(S.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===R&&cl(ne)===S.type)?(S=n(S,N.props),En(S,N),S.return=k,S):(S=jr(N.type,N.key,N.props,null,k.mode,D),En(S,N),S.return=k,S)}function w(k,S,N,D){return S===null||S.tag!==4||S.stateNode.containerInfo!==N.containerInfo||S.stateNode.implementation!==N.implementation?(S=Ps(N,k.mode,D),S.return=k,S):(S=n(S,N.children||[]),S.return=k,S)}function _(k,S,N,D,ne){return S===null||S.tag!==7?(S=nl(N,k.mode,D,ne),S.return=k,S):(S=n(S,N),S.return=k,S)}function H(k,S,N){if(typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint")return S=Fs(""+S,k.mode,N),S.return=k,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case G:return N=jr(S.type,S.key,S.props,null,k.mode,N),En(N,S),N.return=k,N;case B:return S=Ps(S,k.mode,N),S.return=k,S;case R:return S=cl(S),H(k,S,N)}if(xe(S)||ie(S))return S=nl(S,k.mode,N,null),S.return=k,S;if(typeof S.then=="function")return H(k,Ar(S),N);if(S.$$typeof===Q)return H(k,wr(k,S),N);Mr(k,S)}return null}function C(k,S,N,D){var ne=S!==null?S.key:null;if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return ne!==null?null:m(k,S,""+N,D);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case G:return N.key===ne?b(k,S,N,D):null;case B:return N.key===ne?w(k,S,N,D):null;case R:return N=cl(N),C(k,S,N,D)}if(xe(N)||ie(N))return ne!==null?null:_(k,S,N,D,null);if(typeof N.then=="function")return C(k,S,Ar(N),D);if(N.$$typeof===Q)return C(k,S,wr(k,N),D);Mr(k,N)}return null}function M(k,S,N,D,ne){if(typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint")return k=k.get(N)||null,m(S,k,""+D,ne);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case G:return k=k.get(D.key===null?N:D.key)||null,b(S,k,D,ne);case B:return k=k.get(D.key===null?N:D.key)||null,w(S,k,D,ne);case R:return D=cl(D),M(k,S,N,D,ne)}if(xe(D)||ie(D))return k=k.get(N)||null,_(S,k,D,ne,null);if(typeof D.then=="function")return M(k,S,N,Ar(D),ne);if(D.$$typeof===Q)return M(k,S,N,wr(S,D),ne);Mr(S,D)}return null}function P(k,S,N,D){for(var ne=null,Ae=null,ee=S,pe=S=0,Te=null;ee!==null&&pe<N.length;pe++){ee.index>pe?(Te=ee,ee=null):Te=ee.sibling;var Me=C(k,ee,N[pe],D);if(Me===null){ee===null&&(ee=Te);break}e&&ee&&Me.alternate===null&&t(k,ee),S=r(Me,S,pe),Ae===null?ne=Me:Ae.sibling=Me,Ae=Me,ee=Te}if(pe===N.length)return a(k,ee),Ee&&ra(k,pe),ne;if(ee===null){for(;pe<N.length;pe++)ee=H(k,N[pe],D),ee!==null&&(S=r(ee,S,pe),Ae===null?ne=ee:Ae.sibling=ee,Ae=ee);return Ee&&ra(k,pe),ne}for(ee=l(ee);pe<N.length;pe++)Te=M(ee,k,pe,N[pe],D),Te!==null&&(e&&Te.alternate!==null&&ee.delete(Te.key===null?pe:Te.key),S=r(Te,S,pe),Ae===null?ne=Te:Ae.sibling=Te,Ae=Te);return e&&ee.forEach(function(Ja){return t(k,Ja)}),Ee&&ra(k,pe),ne}function ce(k,S,N,D){if(N==null)throw Error(c(151));for(var ne=null,Ae=null,ee=S,pe=S=0,Te=null,Me=N.next();ee!==null&&!Me.done;pe++,Me=N.next()){ee.index>pe?(Te=ee,ee=null):Te=ee.sibling;var Ja=C(k,ee,Me.value,D);if(Ja===null){ee===null&&(ee=Te);break}e&&ee&&Ja.alternate===null&&t(k,ee),S=r(Ja,S,pe),Ae===null?ne=Ja:Ae.sibling=Ja,Ae=Ja,ee=Te}if(Me.done)return a(k,ee),Ee&&ra(k,pe),ne;if(ee===null){for(;!Me.done;pe++,Me=N.next())Me=H(k,Me.value,D),Me!==null&&(S=r(Me,S,pe),Ae===null?ne=Me:Ae.sibling=Me,Ae=Me);return Ee&&ra(k,pe),ne}for(ee=l(ee);!Me.done;pe++,Me=N.next())Me=M(ee,k,pe,Me.value,D),Me!==null&&(e&&Me.alternate!==null&&ee.delete(Me.key===null?pe:Me.key),S=r(Me,S,pe),Ae===null?ne=Me:Ae.sibling=Me,Ae=Me);return e&&ee.forEach(function(bg){return t(k,bg)}),Ee&&ra(k,pe),ne}function Le(k,S,N,D){if(typeof N=="object"&&N!==null&&N.type===q&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case G:e:{for(var ne=N.key;S!==null;){if(S.key===ne){if(ne=N.type,ne===q){if(S.tag===7){a(k,S.sibling),D=n(S,N.props.children),D.return=k,k=D;break e}}else if(S.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===R&&cl(ne)===S.type){a(k,S.sibling),D=n(S,N.props),En(D,N),D.return=k,k=D;break e}a(k,S);break}else t(k,S);S=S.sibling}N.type===q?(D=nl(N.props.children,k.mode,D,N.key),D.return=k,k=D):(D=jr(N.type,N.key,N.props,null,k.mode,D),En(D,N),D.return=k,k=D)}return u(k);case B:e:{for(ne=N.key;S!==null;){if(S.key===ne)if(S.tag===4&&S.stateNode.containerInfo===N.containerInfo&&S.stateNode.implementation===N.implementation){a(k,S.sibling),D=n(S,N.children||[]),D.return=k,k=D;break e}else{a(k,S);break}else t(k,S);S=S.sibling}D=Ps(N,k.mode,D),D.return=k,k=D}return u(k);case R:return N=cl(N),Le(k,S,N,D)}if(xe(N))return P(k,S,N,D);if(ie(N)){if(ne=ie(N),typeof ne!="function")throw Error(c(150));return N=ne.call(N),ce(k,S,N,D)}if(typeof N.then=="function")return Le(k,S,Ar(N),D);if(N.$$typeof===Q)return Le(k,S,wr(k,N),D);Mr(k,N)}return typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint"?(N=""+N,S!==null&&S.tag===6?(a(k,S.sibling),D=n(S,N),D.return=k,k=D):(a(k,S),D=Fs(N,k.mode,D),D.return=k,k=D),u(k)):a(k,S)}return function(k,S,N,D){try{Tn=0;var ne=Le(k,S,N,D);return Gl=null,ne}catch(ee){if(ee===Ll||ee===Tr)throw ee;var Ae=jt(29,ee,null,k.mode);return Ae.lanes=D,Ae.return=k,Ae}finally{}}}var dl=eu(!0),tu=eu(!1),Oa=!1;function di(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function za(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function _a(e,t,a){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Re&2)!==0){var n=l.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),l.pending=t,t=Sr(e),Lc(e,null,a),t}return vr(e,l,t,a),Sr(e)}function An(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,a|=l,t.lanes=a,Qo(e,a)}}function mi(e,t){var a=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var n=null,r=null;if(a=a.firstBaseUpdate,a!==null){do{var u={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};r===null?n=r=u:r=r.next=u,a=a.next}while(a!==null);r===null?n=r=t:r=r.next=t}else n=r=t;a={baseState:l.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:l.shared,callbacks:l.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var gi=!1;function Mn(){if(gi){var e=Hl;if(e!==null)throw e}}function Rn(e,t,a,l){gi=!1;var n=e.updateQueue;Oa=!1;var r=n.firstBaseUpdate,u=n.lastBaseUpdate,m=n.shared.pending;if(m!==null){n.shared.pending=null;var b=m,w=b.next;b.next=null,u===null?r=w:u.next=w,u=b;var _=e.alternate;_!==null&&(_=_.updateQueue,m=_.lastBaseUpdate,m!==u&&(m===null?_.firstBaseUpdate=w:m.next=w,_.lastBaseUpdate=b))}if(r!==null){var H=n.baseState;u=0,_=w=b=null,m=r;do{var C=m.lane&-536870913,M=C!==m.lane;if(M?(Ce&C)===C:(l&C)===C){C!==0&&C===Dl&&(gi=!0),_!==null&&(_=_.next={lane:0,tag:m.tag,payload:m.payload,callback:null,next:null});e:{var P=e,ce=m;C=t;var Le=a;switch(ce.tag){case 1:if(P=ce.payload,typeof P=="function"){H=P.call(Le,H,C);break e}H=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=ce.payload,C=typeof P=="function"?P.call(Le,H,C):P,C==null)break e;H=T({},H,C);break e;case 2:Oa=!0}}C=m.callback,C!==null&&(e.flags|=64,M&&(e.flags|=8192),M=n.callbacks,M===null?n.callbacks=[C]:M.push(C))}else M={lane:C,tag:m.tag,payload:m.payload,callback:m.callback,next:null},_===null?(w=_=M,b=H):_=_.next=M,u|=C;if(m=m.next,m===null){if(m=n.shared.pending,m===null)break;M=m,m=M.next,M.next=null,n.lastBaseUpdate=M,n.shared.pending=null}}while(!0);_===null&&(b=H),n.baseState=b,n.firstBaseUpdate=w,n.lastBaseUpdate=_,r===null&&(n.shared.lanes=0),Ga|=u,e.lanes=u,e.memoizedState=H}}function au(e,t){if(typeof e!="function")throw Error(c(191,e));e.call(t)}function lu(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)au(a[e],t)}var Bl=v(null),Rr=v(0);function nu(e,t){e=ya,K(Rr,e),K(Bl,t),ya=e|t.baseLanes}function hi(){K(Rr,ya),K(Bl,Bl.current)}function yi(){ya=Rr.current,O(Bl),O(Rr)}var kt=v(null),Gt=null;function Ua(e){var t=e.alternate;K(Ze,Ze.current&1),K(kt,e),Gt===null&&(t===null||Bl.current!==null||t.memoizedState!==null)&&(Gt=e)}function xi(e){K(Ze,Ze.current),K(kt,e),Gt===null&&(Gt=e)}function ru(e){e.tag===22?(K(Ze,Ze.current),K(kt,e),Gt===null&&(Gt=e)):Da()}function Da(){K(Ze,Ze.current),K(kt,kt.current)}function Nt(e){O(kt),Gt===e&&(Gt=null),O(Ze)}var Ze=v(0);function Or(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||No(a)||wo(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var oa=0,ye=null,De=null,We=null,zr=!1,Yl=!1,fl=!1,_r=0,On=0,ql=null,cm=0;function Qe(){throw Error(c(321))}function pi(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!St(e[a],t[a]))return!1;return!0}function bi(e,t,a,l,n,r){return oa=r,ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,E.H=e===null||e.memoizedState===null?qu:_i,fl=!1,r=a(l,n),fl=!1,Yl&&(r=iu(t,a,l,n)),su(e),r}function su(e){E.H=Un;var t=De!==null&&De.next!==null;if(oa=0,We=De=ye=null,zr=!1,On=0,ql=null,t)throw Error(c(300));e===null||Fe||(e=e.dependencies,e!==null&&Nr(e)&&(Fe=!0))}function iu(e,t,a,l){ye=e;var n=0;do{if(Yl&&(ql=null),On=0,Yl=!1,25<=n)throw Error(c(301));if(n+=1,We=De=null,e.updateQueue!=null){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}E.H=Vu,r=t(a,l)}while(Yl);return r}function um(){var e=E.H,t=e.useState()[0];return t=typeof t.then=="function"?zn(t):t,e=e.useState()[0],(De!==null?De.memoizedState:null)!==e&&(ye.flags|=1024),t}function vi(){var e=_r!==0;return _r=0,e}function Si(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function ji(e){if(zr){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}zr=!1}oa=0,We=De=ye=null,Yl=!1,On=_r=0,ql=null}function dt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?ye.memoizedState=We=e:We=We.next=e,We}function Je(){if(De===null){var e=ye.alternate;e=e!==null?e.memoizedState:null}else e=De.next;var t=We===null?ye.memoizedState:We.next;if(t!==null)We=t,De=e;else{if(e===null)throw ye.alternate===null?Error(c(467)):Error(c(310));De=e,e={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},We===null?ye.memoizedState=We=e:We=We.next=e}return We}function Ur(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zn(e){var t=On;return On+=1,ql===null&&(ql=[]),e=Wc(ql,e,t),t=ye,(We===null?t.memoizedState:We.next)===null&&(t=t.alternate,E.H=t===null||t.memoizedState===null?qu:_i),e}function Dr(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return zn(e);if(e.$$typeof===Q)return rt(e)}throw Error(c(438,String(e)))}function ki(e){var t=null,a=ye.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var l=ye.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(n){return n.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=Ur(),ye.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),l=0;l<e;l++)a[l]=Y;return t.index++,a}function ca(e,t){return typeof t=="function"?t(e):t}function Hr(e){var t=Je();return Ni(t,De,e)}function Ni(e,t,a){var l=e.queue;if(l===null)throw Error(c(311));l.lastRenderedReducer=a;var n=e.baseQueue,r=l.pending;if(r!==null){if(n!==null){var u=n.next;n.next=r.next,r.next=u}t.baseQueue=n=r,l.pending=null}if(r=e.baseState,n===null)e.memoizedState=r;else{t=n.next;var m=u=null,b=null,w=t,_=!1;do{var H=w.lane&-536870913;if(H!==w.lane?(Ce&H)===H:(oa&H)===H){var C=w.revertLane;if(C===0)b!==null&&(b=b.next={lane:0,revertLane:0,gesture:null,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),H===Dl&&(_=!0);else if((oa&C)===C){w=w.next,C===Dl&&(_=!0);continue}else H={lane:0,revertLane:w.revertLane,gesture:null,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null},b===null?(m=b=H,u=r):b=b.next=H,ye.lanes|=C,Ga|=C;H=w.action,fl&&a(r,H),r=w.hasEagerState?w.eagerState:a(r,H)}else C={lane:H,revertLane:w.revertLane,gesture:w.gesture,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null},b===null?(m=b=C,u=r):b=b.next=C,ye.lanes|=H,Ga|=H;w=w.next}while(w!==null&&w!==t);if(b===null?u=r:b.next=m,!St(r,e.memoizedState)&&(Fe=!0,_&&(a=Hl,a!==null)))throw a;e.memoizedState=r,e.baseState=u,e.baseQueue=b,l.lastRenderedState=r}return n===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function wi(e){var t=Je(),a=t.queue;if(a===null)throw Error(c(311));a.lastRenderedReducer=e;var l=a.dispatch,n=a.pending,r=t.memoizedState;if(n!==null){a.pending=null;var u=n=n.next;do r=e(r,u.action),u=u.next;while(u!==n);St(r,t.memoizedState)||(Fe=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),a.lastRenderedState=r}return[r,l]}function ou(e,t,a){var l=ye,n=Je(),r=Ee;if(r){if(a===void 0)throw Error(c(407));a=a()}else a=t();var u=!St((De||n).memoizedState,a);if(u&&(n.memoizedState=a,Fe=!0),n=n.queue,Ei(du.bind(null,l,n,e),[e]),n.getSnapshot!==t||u||We!==null&&We.memoizedState.tag&1){if(l.flags|=2048,Vl(9,{destroy:void 0},uu.bind(null,l,n,a,t),null),Ge===null)throw Error(c(349));r||(oa&127)!==0||cu(l,t,a)}return a}function cu(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=ye.updateQueue,t===null?(t=Ur(),ye.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function uu(e,t,a,l){t.value=a,t.getSnapshot=l,fu(t)&&mu(e)}function du(e,t,a){return a(function(){fu(t)&&mu(e)})}function fu(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!St(e,a)}catch{return!0}}function mu(e){var t=ll(e,2);t!==null&&pt(t,e,2)}function Ci(e){var t=dt();if(typeof e=="function"){var a=e;if(e=a(),fl){wa(!0);try{a()}finally{wa(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:e},t}function gu(e,t,a,l){return e.baseState=a,Ni(e,De,typeof l=="function"?l:ca)}function dm(e,t,a,l,n){if(Br(e))throw Error(c(485));if(e=t.action,e!==null){var r={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(u){r.listeners.push(u)}};E.T!==null?a(!0):r.isTransition=!1,l(r),a=t.pending,a===null?(r.next=t.pending=r,hu(t,r)):(r.next=a.next,t.pending=a.next=r)}}function hu(e,t){var a=t.action,l=t.payload,n=e.state;if(t.isTransition){var r=E.T,u={};E.T=u;try{var m=a(n,l),b=E.S;b!==null&&b(u,m),yu(e,t,m)}catch(w){Ti(e,t,w)}finally{r!==null&&u.types!==null&&(r.types=u.types),E.T=r}}else try{r=a(n,l),yu(e,t,r)}catch(w){Ti(e,t,w)}}function yu(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(l){xu(e,t,l)},function(l){return Ti(e,t,l)}):xu(e,t,a)}function xu(e,t,a){t.status="fulfilled",t.value=a,pu(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,hu(e,a)))}function Ti(e,t,a){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=a,pu(t),t=t.next;while(t!==l)}e.action=null}function pu(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function bu(e,t){return t}function vu(e,t){if(Ee){var a=Ge.formState;if(a!==null){e:{var l=ye;if(Ee){if(Be){t:{for(var n=Be,r=Lt;n.nodeType!==8;){if(!r){n=null;break t}if(n=Bt(n.nextSibling),n===null){n=null;break t}}r=n.data,n=r==="F!"||r==="F"?n:null}if(n){Be=Bt(n.nextSibling),l=n.data==="F!";break e}}Ma(l)}l=!1}l&&(t=a[0])}}return a=dt(),a.memoizedState=a.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:t},a.queue=l,a=Gu.bind(null,ye,l),l.dispatch=a,l=Ci(!1),r=zi.bind(null,ye,!1,l.queue),l=dt(),n={state:t,dispatch:null,action:e,pending:null},l.queue=n,a=dm.bind(null,ye,n,r,a),n.dispatch=a,l.memoizedState=e,[t,a,!1]}function Su(e){var t=Je();return ju(t,De,e)}function ju(e,t,a){if(t=Ni(e,t,bu)[0],e=Hr(ca)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=zn(t)}catch(u){throw u===Ll?Tr:u}else l=t;t=Je();var n=t.queue,r=n.dispatch;return a!==t.memoizedState&&(ye.flags|=2048,Vl(9,{destroy:void 0},fm.bind(null,n,a),null)),[l,r,e]}function fm(e,t){e.action=t}function ku(e){var t=Je(),a=De;if(a!==null)return ju(t,a,e);Je(),t=t.memoizedState,a=Je();var l=a.queue.dispatch;return a.memoizedState=e,[t,l,!1]}function Vl(e,t,a,l){return e={tag:e,create:a,deps:l,inst:t,next:null},t=ye.updateQueue,t===null&&(t=Ur(),ye.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(l=a.next,a.next=e,e.next=l,t.lastEffect=e),e}function Nu(){return Je().memoizedState}function Lr(e,t,a,l){var n=dt();ye.flags|=e,n.memoizedState=Vl(1|t,{destroy:void 0},a,l===void 0?null:l)}function Gr(e,t,a,l){var n=Je();l=l===void 0?null:l;var r=n.memoizedState.inst;De!==null&&l!==null&&pi(l,De.memoizedState.deps)?n.memoizedState=Vl(t,r,a,l):(ye.flags|=e,n.memoizedState=Vl(1|t,r,a,l))}function wu(e,t){Lr(8390656,8,e,t)}function Ei(e,t){Gr(2048,8,e,t)}function mm(e){ye.flags|=4;var t=ye.updateQueue;if(t===null)t=Ur(),ye.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function Cu(e){var t=Je().memoizedState;return mm({ref:t,nextImpl:e}),function(){if((Re&2)!==0)throw Error(c(440));return t.impl.apply(void 0,arguments)}}function Tu(e,t){return Gr(4,2,e,t)}function Eu(e,t){return Gr(4,4,e,t)}function Au(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Mu(e,t,a){a=a!=null?a.concat([e]):null,Gr(4,4,Au.bind(null,t,e),a)}function Ai(){}function Ru(e,t){var a=Je();t=t===void 0?null:t;var l=a.memoizedState;return t!==null&&pi(t,l[1])?l[0]:(a.memoizedState=[e,t],e)}function Ou(e,t){var a=Je();t=t===void 0?null:t;var l=a.memoizedState;if(t!==null&&pi(t,l[1]))return l[0];if(l=e(),fl){wa(!0);try{e()}finally{wa(!1)}}return a.memoizedState=[l,t],l}function Mi(e,t,a){return a===void 0||(oa&1073741824)!==0&&(Ce&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=zd(),ye.lanes|=e,Ga|=e,a)}function zu(e,t,a,l){return St(a,t)?a:Bl.current!==null?(e=Mi(e,a,l),St(e,t)||(Fe=!0),e):(oa&42)===0||(oa&1073741824)!==0&&(Ce&261930)===0?(Fe=!0,e.memoizedState=a):(e=zd(),ye.lanes|=e,Ga|=e,t)}function _u(e,t,a,l,n){var r=L.p;L.p=r!==0&&8>r?r:8;var u=E.T,m={};E.T=m,zi(e,!1,t,a);try{var b=n(),w=E.S;if(w!==null&&w(m,b),b!==null&&typeof b=="object"&&typeof b.then=="function"){var _=om(b,l);_n(e,t,_,Tt(e))}else _n(e,t,l,Tt(e))}catch(H){_n(e,t,{then:function(){},status:"rejected",reason:H},Tt())}finally{L.p=r,u!==null&&m.types!==null&&(u.types=m.types),E.T=u}}function gm(){}function Ri(e,t,a,l){if(e.tag!==5)throw Error(c(476));var n=Uu(e).queue;_u(e,n,t,X,a===null?gm:function(){return Du(e),a(l)})}function Uu(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:X},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ca,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Du(e){var t=Uu(e);t.next===null&&(t=e.alternate.memoizedState),_n(e,t.next.queue,{},Tt())}function Oi(){return rt(Wn)}function Hu(){return Je().memoizedState}function Lu(){return Je().memoizedState}function hm(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Tt();e=za(a);var l=_a(t,e,a);l!==null&&(pt(l,t,a),An(l,t,a)),t={cache:ii()},e.payload=t;return}t=t.return}}function ym(e,t,a){var l=Tt();a={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Br(e)?Bu(t,a):(a=$s(e,t,a,l),a!==null&&(pt(a,e,l),Yu(a,t,l)))}function Gu(e,t,a){var l=Tt();_n(e,t,a,l)}function _n(e,t,a,l){var n={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Br(e))Bu(t,n);else{var r=e.alternate;if(e.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var u=t.lastRenderedState,m=r(u,a);if(n.hasEagerState=!0,n.eagerState=m,St(m,u))return vr(e,t,n,0),Ge===null&&br(),!1}catch{}finally{}if(a=$s(e,t,n,l),a!==null)return pt(a,e,l),Yu(a,t,l),!0}return!1}function zi(e,t,a,l){if(l={lane:2,revertLane:fo(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Br(e)){if(t)throw Error(c(479))}else t=$s(e,a,l,2),t!==null&&pt(t,e,2)}function Br(e){var t=e.alternate;return e===ye||t!==null&&t===ye}function Bu(e,t){Yl=zr=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Yu(e,t,a){if((a&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,a|=l,t.lanes=a,Qo(e,a)}}var Un={readContext:rt,use:Dr,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useLayoutEffect:Qe,useInsertionEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useSyncExternalStore:Qe,useId:Qe,useHostTransitionStatus:Qe,useFormState:Qe,useActionState:Qe,useOptimistic:Qe,useMemoCache:Qe,useCacheRefresh:Qe};Un.useEffectEvent=Qe;var qu={readContext:rt,use:Dr,useCallback:function(e,t){return dt().memoizedState=[e,t===void 0?null:t],e},useContext:rt,useEffect:wu,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,Lr(4194308,4,Au.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Lr(4194308,4,e,t)},useInsertionEffect:function(e,t){Lr(4,2,e,t)},useMemo:function(e,t){var a=dt();t=t===void 0?null:t;var l=e();if(fl){wa(!0);try{e()}finally{wa(!1)}}return a.memoizedState=[l,t],l},useReducer:function(e,t,a){var l=dt();if(a!==void 0){var n=a(t);if(fl){wa(!0);try{a(t)}finally{wa(!1)}}}else n=t;return l.memoizedState=l.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=ym.bind(null,ye,e),[l.memoizedState,e]},useRef:function(e){var t=dt();return e={current:e},t.memoizedState=e},useState:function(e){e=Ci(e);var t=e.queue,a=Gu.bind(null,ye,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Ai,useDeferredValue:function(e,t){var a=dt();return Mi(a,e,t)},useTransition:function(){var e=Ci(!1);return e=_u.bind(null,ye,e.queue,!0,!1),dt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var l=ye,n=dt();if(Ee){if(a===void 0)throw Error(c(407));a=a()}else{if(a=t(),Ge===null)throw Error(c(349));(Ce&127)!==0||cu(l,t,a)}n.memoizedState=a;var r={value:a,getSnapshot:t};return n.queue=r,wu(du.bind(null,l,r,e),[e]),l.flags|=2048,Vl(9,{destroy:void 0},uu.bind(null,l,r,a,t),null),a},useId:function(){var e=dt(),t=Ge.identifierPrefix;if(Ee){var a=Zt,l=It;a=(l&~(1<<32-vt(l)-1)).toString(32)+a,t="_"+t+"R_"+a,a=_r++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=cm++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Oi,useFormState:vu,useActionState:vu,useOptimistic:function(e){var t=dt();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=zi.bind(null,ye,!0,a),a.dispatch=t,[e,t]},useMemoCache:ki,useCacheRefresh:function(){return dt().memoizedState=hm.bind(null,ye)},useEffectEvent:function(e){var t=dt(),a={impl:e};return t.memoizedState=a,function(){if((Re&2)!==0)throw Error(c(440));return a.impl.apply(void 0,arguments)}}},_i={readContext:rt,use:Dr,useCallback:Ru,useContext:rt,useEffect:Ei,useImperativeHandle:Mu,useInsertionEffect:Tu,useLayoutEffect:Eu,useMemo:Ou,useReducer:Hr,useRef:Nu,useState:function(){return Hr(ca)},useDebugValue:Ai,useDeferredValue:function(e,t){var a=Je();return zu(a,De.memoizedState,e,t)},useTransition:function(){var e=Hr(ca)[0],t=Je().memoizedState;return[typeof e=="boolean"?e:zn(e),t]},useSyncExternalStore:ou,useId:Hu,useHostTransitionStatus:Oi,useFormState:Su,useActionState:Su,useOptimistic:function(e,t){var a=Je();return gu(a,De,e,t)},useMemoCache:ki,useCacheRefresh:Lu};_i.useEffectEvent=Cu;var Vu={readContext:rt,use:Dr,useCallback:Ru,useContext:rt,useEffect:Ei,useImperativeHandle:Mu,useInsertionEffect:Tu,useLayoutEffect:Eu,useMemo:Ou,useReducer:wi,useRef:Nu,useState:function(){return wi(ca)},useDebugValue:Ai,useDeferredValue:function(e,t){var a=Je();return De===null?Mi(a,e,t):zu(a,De.memoizedState,e,t)},useTransition:function(){var e=wi(ca)[0],t=Je().memoizedState;return[typeof e=="boolean"?e:zn(e),t]},useSyncExternalStore:ou,useId:Hu,useHostTransitionStatus:Oi,useFormState:ku,useActionState:ku,useOptimistic:function(e,t){var a=Je();return De!==null?gu(a,De,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:ki,useCacheRefresh:Lu};Vu.useEffectEvent=Cu;function Ui(e,t,a,l){t=e.memoizedState,a=a(l,t),a=a==null?t:T({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Di={enqueueSetState:function(e,t,a){e=e._reactInternals;var l=Tt(),n=za(l);n.payload=t,a!=null&&(n.callback=a),t=_a(e,n,l),t!==null&&(pt(t,e,l),An(t,e,l))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var l=Tt(),n=za(l);n.tag=1,n.payload=t,a!=null&&(n.callback=a),t=_a(e,n,l),t!==null&&(pt(t,e,l),An(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Tt(),l=za(a);l.tag=2,t!=null&&(l.callback=t),t=_a(e,l,a),t!==null&&(pt(t,e,a),An(t,e,a))}};function Xu(e,t,a,l,n,r,u){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,r,u):t.prototype&&t.prototype.isPureReactComponent?!Sn(a,l)||!Sn(n,r):!0}function Ku(e,t,a,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,l),t.state!==e&&Di.enqueueReplaceState(t,t.state,null)}function ml(e,t){var a=t;if("ref"in t){a={};for(var l in t)l!=="ref"&&(a[l]=t[l])}if(e=e.defaultProps){a===t&&(a=T({},a));for(var n in e)a[n]===void 0&&(a[n]=e[n])}return a}function Qu(e){pr(e)}function Iu(e){console.error(e)}function Zu(e){pr(e)}function Yr(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function Ju(e,t,a){try{var l=e.onCaughtError;l(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Hi(e,t,a){return a=za(a),a.tag=3,a.payload={element:null},a.callback=function(){Yr(e,t)},a}function $u(e){return e=za(e),e.tag=3,e}function Wu(e,t,a,l){var n=a.type.getDerivedStateFromError;if(typeof n=="function"){var r=l.value;e.payload=function(){return n(r)},e.callback=function(){Ju(t,a,l)}}var u=a.stateNode;u!==null&&typeof u.componentDidCatch=="function"&&(e.callback=function(){Ju(t,a,l),typeof n!="function"&&(Ba===null?Ba=new Set([this]):Ba.add(this));var m=l.stack;this.componentDidCatch(l.value,{componentStack:m!==null?m:""})})}function xm(e,t,a,l,n){if(a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=a.alternate,t!==null&&Ul(t,a,n,!0),a=kt.current,a!==null){switch(a.tag){case 31:case 13:return Gt===null?Pr():a.alternate===null&&Ie===0&&(Ie=3),a.flags&=-257,a.flags|=65536,a.lanes=n,l===Er?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([l]):t.add(l),oo(e,l,n)),!1;case 22:return a.flags|=65536,l===Er?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([l]):a.add(l)),oo(e,l,n)),!1}throw Error(c(435,a.tag))}return oo(e,l,n),Pr(),!1}if(Ee)return t=kt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=n,l!==ai&&(e=Error(c(422),{cause:l}),Nn(Ut(e,a)))):(l!==ai&&(t=Error(c(423),{cause:l}),Nn(Ut(t,a))),e=e.current.alternate,e.flags|=65536,n&=-n,e.lanes|=n,l=Ut(l,a),n=Hi(e.stateNode,l,n),mi(e,n),Ie!==4&&(Ie=2)),!1;var r=Error(c(520),{cause:l});if(r=Ut(r,a),Vn===null?Vn=[r]:Vn.push(r),Ie!==4&&(Ie=2),t===null)return!0;l=Ut(l,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=n&-n,a.lanes|=e,e=Hi(a.stateNode,l,e),mi(a,e),!1;case 1:if(t=a.type,r=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(Ba===null||!Ba.has(r))))return a.flags|=65536,n&=-n,a.lanes|=n,n=$u(n),Wu(n,e,a,l),mi(a,n),!1}a=a.return}while(a!==null);return!1}var Li=Error(c(461)),Fe=!1;function st(e,t,a,l){t.child=e===null?tu(t,null,a,l):dl(t,e.child,a,l)}function Fu(e,t,a,l,n){a=a.render;var r=t.ref;if("ref"in l){var u={};for(var m in l)m!=="ref"&&(u[m]=l[m])}else u=l;return il(t),l=bi(e,t,a,u,r,n),m=vi(),e!==null&&!Fe?(Si(e,t,n),ua(e,t,n)):(Ee&&m&&ei(t),t.flags|=1,st(e,t,l,n),t.child)}function Pu(e,t,a,l,n){if(e===null){var r=a.type;return typeof r=="function"&&!Ws(r)&&r.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=r,ed(e,t,r,l,n)):(e=jr(a.type,null,l,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(r=e.child,!Qi(e,n)){var u=r.memoizedProps;if(a=a.compare,a=a!==null?a:Sn,a(u,l)&&e.ref===t.ref)return ua(e,t,n)}return t.flags|=1,e=na(r,l),e.ref=t.ref,e.return=t,t.child=e}function ed(e,t,a,l,n){if(e!==null){var r=e.memoizedProps;if(Sn(r,l)&&e.ref===t.ref)if(Fe=!1,t.pendingProps=l=r,Qi(e,n))(e.flags&131072)!==0&&(Fe=!0);else return t.lanes=e.lanes,ua(e,t,n)}return Gi(e,t,a,l,n)}function td(e,t,a,l){var n=l.children,r=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(r=r!==null?r.baseLanes|a:a,e!==null){for(l=t.child=e.child,n=0;l!==null;)n=n|l.lanes|l.childLanes,l=l.sibling;l=n&~r}else l=0,t.child=null;return ad(e,t,r,a,l)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Cr(t,r!==null?r.cachePool:null),r!==null?nu(t,r):hi(),ru(t);else return l=t.lanes=536870912,ad(e,t,r!==null?r.baseLanes|a:a,a,l)}else r!==null?(Cr(t,r.cachePool),nu(t,r),Da(),t.memoizedState=null):(e!==null&&Cr(t,null),hi(),Da());return st(e,t,n,a),t.child}function Dn(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function ad(e,t,a,l,n){var r=ci();return r=r===null?null:{parent:$e._currentValue,pool:r},t.memoizedState={baseLanes:a,cachePool:r},e!==null&&Cr(t,null),hi(),ru(t),e!==null&&Ul(e,t,l,!0),t.childLanes=n,null}function qr(e,t){return t=Xr({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function ld(e,t,a){return dl(t,e.child,null,a),e=qr(t,t.pendingProps),e.flags|=2,Nt(t),t.memoizedState=null,e}function pm(e,t,a){var l=t.pendingProps,n=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ee){if(l.mode==="hidden")return e=qr(t,l),t.lanes=536870912,Dn(null,e);if(xi(t),(e=Be)?(e=yf(e,Lt),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ea!==null?{id:It,overflow:Zt}:null,retryLane:536870912,hydrationErrors:null},a=Bc(e),a.return=t,t.child=a,nt=t,Be=null)):e=null,e===null)throw Ma(t);return t.lanes=536870912,null}return qr(t,l)}var r=e.memoizedState;if(r!==null){var u=r.dehydrated;if(xi(t),n)if(t.flags&256)t.flags&=-257,t=ld(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(c(558));else if(Fe||Ul(e,t,a,!1),n=(a&e.childLanes)!==0,Fe||n){if(l=Ge,l!==null&&(u=Io(l,a),u!==0&&u!==r.retryLane))throw r.retryLane=u,ll(e,u),pt(l,e,u),Li;Pr(),t=ld(e,t,a)}else e=r.treeContext,Be=Bt(u.nextSibling),nt=t,Ee=!0,Aa=null,Lt=!1,e!==null&&Vc(t,e),t=qr(t,l),t.flags|=4096;return t}return e=na(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Vr(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(c(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function Gi(e,t,a,l,n){return il(t),a=bi(e,t,a,l,void 0,n),l=vi(),e!==null&&!Fe?(Si(e,t,n),ua(e,t,n)):(Ee&&l&&ei(t),t.flags|=1,st(e,t,a,n),t.child)}function nd(e,t,a,l,n,r){return il(t),t.updateQueue=null,a=iu(t,l,a,n),su(e),l=vi(),e!==null&&!Fe?(Si(e,t,r),ua(e,t,r)):(Ee&&l&&ei(t),t.flags|=1,st(e,t,a,r),t.child)}function rd(e,t,a,l,n){if(il(t),t.stateNode===null){var r=Rl,u=a.contextType;typeof u=="object"&&u!==null&&(r=rt(u)),r=new a(l,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Di,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=l,r.state=t.memoizedState,r.refs={},di(t),u=a.contextType,r.context=typeof u=="object"&&u!==null?rt(u):Rl,r.state=t.memoizedState,u=a.getDerivedStateFromProps,typeof u=="function"&&(Ui(t,a,u,l),r.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(u=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),u!==r.state&&Di.enqueueReplaceState(r,r.state,null),Rn(t,l,r,n),Mn(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){r=t.stateNode;var m=t.memoizedProps,b=ml(a,m);r.props=b;var w=r.context,_=a.contextType;u=Rl,typeof _=="object"&&_!==null&&(u=rt(_));var H=a.getDerivedStateFromProps;_=typeof H=="function"||typeof r.getSnapshotBeforeUpdate=="function",m=t.pendingProps!==m,_||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(m||w!==u)&&Ku(t,r,l,u),Oa=!1;var C=t.memoizedState;r.state=C,Rn(t,l,r,n),Mn(),w=t.memoizedState,m||C!==w||Oa?(typeof H=="function"&&(Ui(t,a,H,l),w=t.memoizedState),(b=Oa||Xu(t,a,b,l,C,w,u))?(_||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=w),r.props=l,r.state=w,r.context=u,l=b):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{r=t.stateNode,fi(e,t),u=t.memoizedProps,_=ml(a,u),r.props=_,H=t.pendingProps,C=r.context,w=a.contextType,b=Rl,typeof w=="object"&&w!==null&&(b=rt(w)),m=a.getDerivedStateFromProps,(w=typeof m=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(u!==H||C!==b)&&Ku(t,r,l,b),Oa=!1,C=t.memoizedState,r.state=C,Rn(t,l,r,n),Mn();var M=t.memoizedState;u!==H||C!==M||Oa||e!==null&&e.dependencies!==null&&Nr(e.dependencies)?(typeof m=="function"&&(Ui(t,a,m,l),M=t.memoizedState),(_=Oa||Xu(t,a,_,l,C,M,b)||e!==null&&e.dependencies!==null&&Nr(e.dependencies))?(w||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(l,M,b),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(l,M,b)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||u===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=M),r.props=l,r.state=M,r.context=b,l=_):(typeof r.componentDidUpdate!="function"||u===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),l=!1)}return r=l,Vr(e,t),l=(t.flags&128)!==0,r||l?(r=t.stateNode,a=l&&typeof a.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,e!==null&&l?(t.child=dl(t,e.child,null,n),t.child=dl(t,null,a,n)):st(e,t,a,n),t.memoizedState=r.state,e=t.child):e=ua(e,t,n),e}function sd(e,t,a,l){return rl(),t.flags|=256,st(e,t,a,l),t.child}var Bi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yi(e){return{baseLanes:e,cachePool:Jc()}}function qi(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Ct),e}function id(e,t,a){var l=t.pendingProps,n=!1,r=(t.flags&128)!==0,u;if((u=r)||(u=e!==null&&e.memoizedState===null?!1:(Ze.current&2)!==0),u&&(n=!0,t.flags&=-129),u=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ee){if(n?Ua(t):Da(),(e=Be)?(e=yf(e,Lt),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ea!==null?{id:It,overflow:Zt}:null,retryLane:536870912,hydrationErrors:null},a=Bc(e),a.return=t,t.child=a,nt=t,Be=null)):e=null,e===null)throw Ma(t);return wo(e)?t.lanes=32:t.lanes=536870912,null}var m=l.children;return l=l.fallback,n?(Da(),n=t.mode,m=Xr({mode:"hidden",children:m},n),l=nl(l,n,a,null),m.return=t,l.return=t,m.sibling=l,t.child=m,l=t.child,l.memoizedState=Yi(a),l.childLanes=qi(e,u,a),t.memoizedState=Bi,Dn(null,l)):(Ua(t),Vi(t,m))}var b=e.memoizedState;if(b!==null&&(m=b.dehydrated,m!==null)){if(r)t.flags&256?(Ua(t),t.flags&=-257,t=Xi(e,t,a)):t.memoizedState!==null?(Da(),t.child=e.child,t.flags|=128,t=null):(Da(),m=l.fallback,n=t.mode,l=Xr({mode:"visible",children:l.children},n),m=nl(m,n,a,null),m.flags|=2,l.return=t,m.return=t,l.sibling=m,t.child=l,dl(t,e.child,null,a),l=t.child,l.memoizedState=Yi(a),l.childLanes=qi(e,u,a),t.memoizedState=Bi,t=Dn(null,l));else if(Ua(t),wo(m)){if(u=m.nextSibling&&m.nextSibling.dataset,u)var w=u.dgst;u=w,l=Error(c(419)),l.stack="",l.digest=u,Nn({value:l,source:null,stack:null}),t=Xi(e,t,a)}else if(Fe||Ul(e,t,a,!1),u=(a&e.childLanes)!==0,Fe||u){if(u=Ge,u!==null&&(l=Io(u,a),l!==0&&l!==b.retryLane))throw b.retryLane=l,ll(e,l),pt(u,e,l),Li;No(m)||Pr(),t=Xi(e,t,a)}else No(m)?(t.flags|=192,t.child=e.child,t=null):(e=b.treeContext,Be=Bt(m.nextSibling),nt=t,Ee=!0,Aa=null,Lt=!1,e!==null&&Vc(t,e),t=Vi(t,l.children),t.flags|=4096);return t}return n?(Da(),m=l.fallback,n=t.mode,b=e.child,w=b.sibling,l=na(b,{mode:"hidden",children:l.children}),l.subtreeFlags=b.subtreeFlags&65011712,w!==null?m=na(w,m):(m=nl(m,n,a,null),m.flags|=2),m.return=t,l.return=t,l.sibling=m,t.child=l,Dn(null,l),l=t.child,m=e.child.memoizedState,m===null?m=Yi(a):(n=m.cachePool,n!==null?(b=$e._currentValue,n=n.parent!==b?{parent:b,pool:b}:n):n=Jc(),m={baseLanes:m.baseLanes|a,cachePool:n}),l.memoizedState=m,l.childLanes=qi(e,u,a),t.memoizedState=Bi,Dn(e.child,l)):(Ua(t),a=e.child,e=a.sibling,a=na(a,{mode:"visible",children:l.children}),a.return=t,a.sibling=null,e!==null&&(u=t.deletions,u===null?(t.deletions=[e],t.flags|=16):u.push(e)),t.child=a,t.memoizedState=null,a)}function Vi(e,t){return t=Xr({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Xr(e,t){return e=jt(22,e,null,t),e.lanes=0,e}function Xi(e,t,a){return dl(t,e.child,null,a),e=Vi(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function od(e,t,a){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),ri(e.return,t,a)}function Ki(e,t,a,l,n,r){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:n,treeForkCount:r}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=l,u.tail=a,u.tailMode=n,u.treeForkCount=r)}function cd(e,t,a){var l=t.pendingProps,n=l.revealOrder,r=l.tail;l=l.children;var u=Ze.current,m=(u&2)!==0;if(m?(u=u&1|2,t.flags|=128):u&=1,K(Ze,u),st(e,t,l,a),l=Ee?kn:0,!m&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&od(e,a,t);else if(e.tag===19)od(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(n){case"forwards":for(a=t.child,n=null;a!==null;)e=a.alternate,e!==null&&Or(e)===null&&(n=a),a=a.sibling;a=n,a===null?(n=t.child,t.child=null):(n=a.sibling,a.sibling=null),Ki(t,!1,n,a,r,l);break;case"backwards":case"unstable_legacy-backwards":for(a=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Or(e)===null){t.child=n;break}e=n.sibling,n.sibling=a,a=n,n=e}Ki(t,!0,a,null,r,l);break;case"together":Ki(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function ua(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),Ga|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(Ul(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(c(153));if(t.child!==null){for(e=t.child,a=na(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=na(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Qi(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Nr(e)))}function bm(e,t,a){switch(t.tag){case 3:Ue(t,t.stateNode.containerInfo),Ra(t,$e,e.memoizedState.cache),rl();break;case 27:case 5:Mt(t);break;case 4:Ue(t,t.stateNode.containerInfo);break;case 10:Ra(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,xi(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(Ua(t),t.flags|=128,null):(a&t.child.childLanes)!==0?id(e,t,a):(Ua(t),e=ua(e,t,a),e!==null?e.sibling:null);Ua(t);break;case 19:var n=(e.flags&128)!==0;if(l=(a&t.childLanes)!==0,l||(Ul(e,t,a,!1),l=(a&t.childLanes)!==0),n){if(l)return cd(e,t,a);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),K(Ze,Ze.current),l)break;return null;case 22:return t.lanes=0,td(e,t,a,t.pendingProps);case 24:Ra(t,$e,e.memoizedState.cache)}return ua(e,t,a)}function ud(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Fe=!0;else{if(!Qi(e,a)&&(t.flags&128)===0)return Fe=!1,bm(e,t,a);Fe=(e.flags&131072)!==0}else Fe=!1,Ee&&(t.flags&1048576)!==0&&qc(t,kn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=cl(t.elementType),t.type=e,typeof e=="function")Ws(e)?(l=ml(e,l),t.tag=1,t=rd(null,t,e,l,a)):(t.tag=0,t=Gi(null,t,e,l,a));else{if(e!=null){var n=e.$$typeof;if(n===W){t.tag=11,t=Fu(null,t,e,l,a);break e}else if(n===V){t.tag=14,t=Pu(null,t,e,l,a);break e}}throw t=ae(e)||e,Error(c(306,t,""))}}return t;case 0:return Gi(e,t,t.type,t.pendingProps,a);case 1:return l=t.type,n=ml(l,t.pendingProps),rd(e,t,l,n,a);case 3:e:{if(Ue(t,t.stateNode.containerInfo),e===null)throw Error(c(387));l=t.pendingProps;var r=t.memoizedState;n=r.element,fi(e,t),Rn(t,l,null,a);var u=t.memoizedState;if(l=u.cache,Ra(t,$e,l),l!==r.cache&&si(t,[$e],a,!0),Mn(),l=u.element,r.isDehydrated)if(r={element:l,isDehydrated:!1,cache:u.cache},t.updateQueue.baseState=r,t.memoizedState=r,t.flags&256){t=sd(e,t,l,a);break e}else if(l!==n){n=Ut(Error(c(424)),t),Nn(n),t=sd(e,t,l,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Be=Bt(e.firstChild),nt=t,Ee=!0,Aa=null,Lt=!0,a=tu(t,null,l,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(rl(),l===n){t=ua(e,t,a);break e}st(e,t,l,a)}t=t.child}return t;case 26:return Vr(e,t),e===null?(a=jf(t.type,null,t.pendingProps,null))?t.memoizedState=a:Ee||(a=t.type,e=t.pendingProps,l=ss(he.current).createElement(a),l[lt]=t,l[ft]=e,it(l,a,e),tt(l),t.stateNode=l):t.memoizedState=jf(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Mt(t),e===null&&Ee&&(l=t.stateNode=bf(t.type,t.pendingProps,he.current),nt=t,Lt=!0,n=Be,Xa(t.type)?(Co=n,Be=Bt(l.firstChild)):Be=n),st(e,t,t.pendingProps.children,a),Vr(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ee&&((n=l=Be)&&(l=Jm(l,t.type,t.pendingProps,Lt),l!==null?(t.stateNode=l,nt=t,Be=Bt(l.firstChild),Lt=!1,n=!0):n=!1),n||Ma(t)),Mt(t),n=t.type,r=t.pendingProps,u=e!==null?e.memoizedProps:null,l=r.children,So(n,r)?l=null:u!==null&&So(n,u)&&(t.flags|=32),t.memoizedState!==null&&(n=bi(e,t,um,null,null,a),Wn._currentValue=n),Vr(e,t),st(e,t,l,a),t.child;case 6:return e===null&&Ee&&((e=a=Be)&&(a=$m(a,t.pendingProps,Lt),a!==null?(t.stateNode=a,nt=t,Be=null,e=!0):e=!1),e||Ma(t)),null;case 13:return id(e,t,a);case 4:return Ue(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=dl(t,null,l,a):st(e,t,l,a),t.child;case 11:return Fu(e,t,t.type,t.pendingProps,a);case 7:return st(e,t,t.pendingProps,a),t.child;case 8:return st(e,t,t.pendingProps.children,a),t.child;case 12:return st(e,t,t.pendingProps.children,a),t.child;case 10:return l=t.pendingProps,Ra(t,t.type,l.value),st(e,t,l.children,a),t.child;case 9:return n=t.type._context,l=t.pendingProps.children,il(t),n=rt(n),l=l(n),t.flags|=1,st(e,t,l,a),t.child;case 14:return Pu(e,t,t.type,t.pendingProps,a);case 15:return ed(e,t,t.type,t.pendingProps,a);case 19:return cd(e,t,a);case 31:return pm(e,t,a);case 22:return td(e,t,a,t.pendingProps);case 24:return il(t),l=rt($e),e===null?(n=ci(),n===null&&(n=Ge,r=ii(),n.pooledCache=r,r.refCount++,r!==null&&(n.pooledCacheLanes|=a),n=r),t.memoizedState={parent:l,cache:n},di(t),Ra(t,$e,n)):((e.lanes&a)!==0&&(fi(e,t),Rn(t,null,null,a),Mn()),n=e.memoizedState,r=t.memoizedState,n.parent!==l?(n={parent:l,cache:l},t.memoizedState=n,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=n),Ra(t,$e,l)):(l=r.cache,Ra(t,$e,l),l!==n.cache&&si(t,[$e],a,!0))),st(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(c(156,t.tag))}function da(e){e.flags|=4}function Ii(e,t,a,l,n){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(n&335544128)===n)if(e.stateNode.complete)e.flags|=8192;else if(Hd())e.flags|=8192;else throw ul=Er,ui}else e.flags&=-16777217}function dd(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Tf(t))if(Hd())e.flags|=8192;else throw ul=Er,ui}function Kr(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Xo():536870912,e.lanes|=t,Il|=t)}function Hn(e,t){if(!Ee)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Ye(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,l=0;if(t)for(var n=e.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags&65011712,l|=n.flags&65011712,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)a|=n.lanes|n.childLanes,l|=n.subtreeFlags,l|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=l,e.childLanes=a,t}function vm(e,t,a){var l=t.pendingProps;switch(ti(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ye(t),null;case 1:return Ye(t),null;case 3:return a=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),ia($e),Xe(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(_l(t)?da(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,li())),Ye(t),null;case 26:var n=t.type,r=t.memoizedState;return e===null?(da(t),r!==null?(Ye(t),dd(t,r)):(Ye(t),Ii(t,n,null,l,a))):r?r!==e.memoizedState?(da(t),Ye(t),dd(t,r)):(Ye(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&da(t),Ye(t),Ii(t,n,e,l,a)),null;case 27:if(Qt(t),a=he.current,n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&da(t);else{if(!l){if(t.stateNode===null)throw Error(c(166));return Ye(t),null}e=F.current,_l(t)?Xc(t):(e=bf(n,l,a),t.stateNode=e,da(t))}return Ye(t),null;case 5:if(Qt(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&da(t);else{if(!l){if(t.stateNode===null)throw Error(c(166));return Ye(t),null}if(r=F.current,_l(t))Xc(t);else{var u=ss(he.current);switch(r){case 1:r=u.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:r=u.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":r=u.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":r=u.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":r=u.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof l.is=="string"?u.createElement("select",{is:l.is}):u.createElement("select"),l.multiple?r.multiple=!0:l.size&&(r.size=l.size);break;default:r=typeof l.is=="string"?u.createElement(n,{is:l.is}):u.createElement(n)}}r[lt]=t,r[ft]=l;e:for(u=t.child;u!==null;){if(u.tag===5||u.tag===6)r.appendChild(u.stateNode);else if(u.tag!==4&&u.tag!==27&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}t.stateNode=r;e:switch(it(r,n,l),n){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&da(t)}}return Ye(t),Ii(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&da(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(c(166));if(e=he.current,_l(t)){if(e=t.stateNode,a=t.memoizedProps,l=null,n=nt,n!==null)switch(n.tag){case 27:case 5:l=n.memoizedProps}e[lt]=t,e=!!(e.nodeValue===a||l!==null&&l.suppressHydrationWarning===!0||of(e.nodeValue,a)),e||Ma(t,!0)}else e=ss(e).createTextNode(l),e[lt]=t,t.stateNode=e}return Ye(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(l=_l(t),a!==null){if(e===null){if(!l)throw Error(c(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(c(557));e[lt]=t}else rl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ye(t),e=!1}else a=li(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(Nt(t),t):(Nt(t),null);if((t.flags&128)!==0)throw Error(c(558))}return Ye(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(n=_l(t),l!==null&&l.dehydrated!==null){if(e===null){if(!n)throw Error(c(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(c(317));n[lt]=t}else rl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ye(t),n=!1}else n=li(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return t.flags&256?(Nt(t),t):(Nt(t),null)}return Nt(t),(t.flags&128)!==0?(t.lanes=a,t):(a=l!==null,e=e!==null&&e.memoizedState!==null,a&&(l=t.child,n=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(n=l.alternate.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==n&&(l.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),Kr(t,t.updateQueue),Ye(t),null);case 4:return Xe(),e===null&&yo(t.stateNode.containerInfo),Ye(t),null;case 10:return ia(t.type),Ye(t),null;case 19:if(O(Ze),l=t.memoizedState,l===null)return Ye(t),null;if(n=(t.flags&128)!==0,r=l.rendering,r===null)if(n)Hn(l,!1);else{if(Ie!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(r=Or(e),r!==null){for(t.flags|=128,Hn(l,!1),e=r.updateQueue,t.updateQueue=e,Kr(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Gc(a,e),a=a.sibling;return K(Ze,Ze.current&1|2),Ee&&ra(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&$()>$r&&(t.flags|=128,n=!0,Hn(l,!1),t.lanes=4194304)}else{if(!n)if(e=Or(r),e!==null){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,Kr(t,e),Hn(l,!0),l.tail===null&&l.tailMode==="hidden"&&!r.alternate&&!Ee)return Ye(t),null}else 2*$()-l.renderingStartTime>$r&&a!==536870912&&(t.flags|=128,n=!0,Hn(l,!1),t.lanes=4194304);l.isBackwards?(r.sibling=t.child,t.child=r):(e=l.last,e!==null?e.sibling=r:t.child=r,l.last=r)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=$(),e.sibling=null,a=Ze.current,K(Ze,n?a&1|2:a&1),Ee&&ra(t,l.treeForkCount),e):(Ye(t),null);case 22:case 23:return Nt(t),yi(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(a&536870912)!==0&&(t.flags&128)===0&&(Ye(t),t.subtreeFlags&6&&(t.flags|=8192)):Ye(t),a=t.updateQueue,a!==null&&Kr(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==a&&(t.flags|=2048),e!==null&&O(ol),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),ia($e),Ye(t),null;case 25:return null;case 30:return null}throw Error(c(156,t.tag))}function Sm(e,t){switch(ti(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ia($e),Xe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Qt(t),null;case 31:if(t.memoizedState!==null){if(Nt(t),t.alternate===null)throw Error(c(340));rl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Nt(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(c(340));rl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return O(Ze),null;case 4:return Xe(),null;case 10:return ia(t.type),null;case 22:case 23:return Nt(t),yi(),e!==null&&O(ol),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ia($e),null;case 25:return null;default:return null}}function fd(e,t){switch(ti(t),t.tag){case 3:ia($e),Xe();break;case 26:case 27:case 5:Qt(t);break;case 4:Xe();break;case 31:t.memoizedState!==null&&Nt(t);break;case 13:Nt(t);break;case 19:O(Ze);break;case 10:ia(t.type);break;case 22:case 23:Nt(t),yi(),e!==null&&O(ol);break;case 24:ia($e)}}function Ln(e,t){try{var a=t.updateQueue,l=a!==null?a.lastEffect:null;if(l!==null){var n=l.next;a=n;do{if((a.tag&e)===e){l=void 0;var r=a.create,u=a.inst;l=r(),u.destroy=l}a=a.next}while(a!==n)}}catch(m){_e(t,t.return,m)}}function Ha(e,t,a){try{var l=t.updateQueue,n=l!==null?l.lastEffect:null;if(n!==null){var r=n.next;l=r;do{if((l.tag&e)===e){var u=l.inst,m=u.destroy;if(m!==void 0){u.destroy=void 0,n=t;var b=a,w=m;try{w()}catch(_){_e(n,b,_)}}}l=l.next}while(l!==r)}}catch(_){_e(t,t.return,_)}}function md(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{lu(t,a)}catch(l){_e(e,e.return,l)}}}function gd(e,t,a){a.props=ml(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(l){_e(e,t,l)}}function Gn(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof a=="function"?e.refCleanup=a(l):a.current=l}}catch(n){_e(e,t,n)}}function Jt(e,t){var a=e.ref,l=e.refCleanup;if(a!==null)if(typeof l=="function")try{l()}catch(n){_e(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(n){_e(e,t,n)}else a.current=null}function hd(e){var t=e.type,a=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&l.focus();break e;case"img":a.src?l.src=a.src:a.srcSet&&(l.srcset=a.srcSet)}}catch(n){_e(e,e.return,n)}}function Zi(e,t,a){try{var l=e.stateNode;Vm(l,e.type,a,t),l[ft]=t}catch(n){_e(e,e.return,n)}}function yd(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Xa(e.type)||e.tag===4}function Ji(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Xa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $i(e,t,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=aa));else if(l!==4&&(l===27&&Xa(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for($i(e,t,a),e=e.sibling;e!==null;)$i(e,t,a),e=e.sibling}function Qr(e,t,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(l!==4&&(l===27&&Xa(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Qr(e,t,a),e=e.sibling;e!==null;)Qr(e,t,a),e=e.sibling}function xd(e){var t=e.stateNode,a=e.memoizedProps;try{for(var l=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);it(t,l,a),t[lt]=e,t[ft]=a}catch(r){_e(e,e.return,r)}}var fa=!1,Pe=!1,Wi=!1,pd=typeof WeakSet=="function"?WeakSet:Set,at=null;function jm(e,t){if(e=e.containerInfo,bo=ms,e=Mc(e),Xs(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var n=l.anchorOffset,r=l.focusNode;l=l.focusOffset;try{a.nodeType,r.nodeType}catch{a=null;break e}var u=0,m=-1,b=-1,w=0,_=0,H=e,C=null;t:for(;;){for(var M;H!==a||n!==0&&H.nodeType!==3||(m=u+n),H!==r||l!==0&&H.nodeType!==3||(b=u+l),H.nodeType===3&&(u+=H.nodeValue.length),(M=H.firstChild)!==null;)C=H,H=M;for(;;){if(H===e)break t;if(C===a&&++w===n&&(m=u),C===r&&++_===l&&(b=u),(M=H.nextSibling)!==null)break;H=C,C=H.parentNode}H=M}a=m===-1||b===-1?null:{start:m,end:b}}else a=null}a=a||{start:0,end:0}}else a=null;for(vo={focusedElem:e,selectionRange:a},ms=!1,at=t;at!==null;)if(t=at,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,at=e;else for(;at!==null;){switch(t=at,r=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)n=e[a],n.ref.impl=n.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&r!==null){e=void 0,a=t,n=r.memoizedProps,r=r.memoizedState,l=a.stateNode;try{var P=ml(a.type,n);e=l.getSnapshotBeforeUpdate(P,r),l.__reactInternalSnapshotBeforeUpdate=e}catch(ce){_e(a,a.return,ce)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)ko(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":ko(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(c(163))}if(e=t.sibling,e!==null){e.return=t.return,at=e;break}at=t.return}}function bd(e,t,a){var l=a.flags;switch(a.tag){case 0:case 11:case 15:ga(e,a),l&4&&Ln(5,a);break;case 1:if(ga(e,a),l&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(u){_e(a,a.return,u)}else{var n=ml(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(u){_e(a,a.return,u)}}l&64&&md(a),l&512&&Gn(a,a.return);break;case 3:if(ga(e,a),l&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{lu(e,t)}catch(u){_e(a,a.return,u)}}break;case 27:t===null&&l&4&&xd(a);case 26:case 5:ga(e,a),t===null&&l&4&&hd(a),l&512&&Gn(a,a.return);break;case 12:ga(e,a);break;case 31:ga(e,a),l&4&&jd(e,a);break;case 13:ga(e,a),l&4&&kd(e,a),l&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Rm.bind(null,a),Wm(e,a))));break;case 22:if(l=a.memoizedState!==null||fa,!l){t=t!==null&&t.memoizedState!==null||Pe,n=fa;var r=Pe;fa=l,(Pe=t)&&!r?ha(e,a,(a.subtreeFlags&8772)!==0):ga(e,a),fa=n,Pe=r}break;case 30:break;default:ga(e,a)}}function vd(e){var t=e.alternate;t!==null&&(e.alternate=null,vd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ts(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ve=null,gt=!1;function ma(e,t,a){for(a=a.child;a!==null;)Sd(e,t,a),a=a.sibling}function Sd(e,t,a){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(cn,a)}catch{}switch(a.tag){case 26:Pe||Jt(a,t),ma(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Pe||Jt(a,t);var l=Ve,n=gt;Xa(a.type)&&(Ve=a.stateNode,gt=!1),ma(e,t,a),Zn(a.stateNode),Ve=l,gt=n;break;case 5:Pe||Jt(a,t);case 6:if(l=Ve,n=gt,Ve=null,ma(e,t,a),Ve=l,gt=n,Ve!==null)if(gt)try{(Ve.nodeType===9?Ve.body:Ve.nodeName==="HTML"?Ve.ownerDocument.body:Ve).removeChild(a.stateNode)}catch(r){_e(a,t,r)}else try{Ve.removeChild(a.stateNode)}catch(r){_e(a,t,r)}break;case 18:Ve!==null&&(gt?(e=Ve,gf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),tn(e)):gf(Ve,a.stateNode));break;case 4:l=Ve,n=gt,Ve=a.stateNode.containerInfo,gt=!0,ma(e,t,a),Ve=l,gt=n;break;case 0:case 11:case 14:case 15:Ha(2,a,t),Pe||Ha(4,a,t),ma(e,t,a);break;case 1:Pe||(Jt(a,t),l=a.stateNode,typeof l.componentWillUnmount=="function"&&gd(a,t,l)),ma(e,t,a);break;case 21:ma(e,t,a);break;case 22:Pe=(l=Pe)||a.memoizedState!==null,ma(e,t,a),Pe=l;break;default:ma(e,t,a)}}function jd(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{tn(e)}catch(a){_e(t,t.return,a)}}}function kd(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{tn(e)}catch(a){_e(t,t.return,a)}}function km(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new pd),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new pd),t;default:throw Error(c(435,e.tag))}}function Ir(e,t){var a=km(e);t.forEach(function(l){if(!a.has(l)){a.add(l);var n=Om.bind(null,e,l);l.then(n,n)}})}function ht(e,t){var a=t.deletions;if(a!==null)for(var l=0;l<a.length;l++){var n=a[l],r=e,u=t,m=u;e:for(;m!==null;){switch(m.tag){case 27:if(Xa(m.type)){Ve=m.stateNode,gt=!1;break e}break;case 5:Ve=m.stateNode,gt=!1;break e;case 3:case 4:Ve=m.stateNode.containerInfo,gt=!0;break e}m=m.return}if(Ve===null)throw Error(c(160));Sd(r,u,n),Ve=null,gt=!1,r=n.alternate,r!==null&&(r.return=null),n.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Nd(t,e),t=t.sibling}var Vt=null;function Nd(e,t){var a=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:ht(t,e),yt(e),l&4&&(Ha(3,e,e.return),Ln(3,e),Ha(5,e,e.return));break;case 1:ht(t,e),yt(e),l&512&&(Pe||a===null||Jt(a,a.return)),l&64&&fa&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?l:a.concat(l))));break;case 26:var n=Vt;if(ht(t,e),yt(e),l&512&&(Pe||a===null||Jt(a,a.return)),l&4){var r=a!==null?a.memoizedState:null;if(l=e.memoizedState,a===null)if(l===null)if(e.stateNode===null){e:{l=e.type,a=e.memoizedProps,n=n.ownerDocument||n;t:switch(l){case"title":r=n.getElementsByTagName("title")[0],(!r||r[fn]||r[lt]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=n.createElement(l),n.head.insertBefore(r,n.querySelector("head > title"))),it(r,l,a),r[lt]=e,tt(r),l=r;break e;case"link":var u=wf("link","href",n).get(l+(a.href||""));if(u){for(var m=0;m<u.length;m++)if(r=u[m],r.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&r.getAttribute("rel")===(a.rel==null?null:a.rel)&&r.getAttribute("title")===(a.title==null?null:a.title)&&r.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){u.splice(m,1);break t}}r=n.createElement(l),it(r,l,a),n.head.appendChild(r);break;case"meta":if(u=wf("meta","content",n).get(l+(a.content||""))){for(m=0;m<u.length;m++)if(r=u[m],r.getAttribute("content")===(a.content==null?null:""+a.content)&&r.getAttribute("name")===(a.name==null?null:a.name)&&r.getAttribute("property")===(a.property==null?null:a.property)&&r.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&r.getAttribute("charset")===(a.charSet==null?null:a.charSet)){u.splice(m,1);break t}}r=n.createElement(l),it(r,l,a),n.head.appendChild(r);break;default:throw Error(c(468,l))}r[lt]=e,tt(r),l=r}e.stateNode=l}else Cf(n,e.type,e.stateNode);else e.stateNode=Nf(n,l,e.memoizedProps);else r!==l?(r===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):r.count--,l===null?Cf(n,e.type,e.stateNode):Nf(n,l,e.memoizedProps)):l===null&&e.stateNode!==null&&Zi(e,e.memoizedProps,a.memoizedProps)}break;case 27:ht(t,e),yt(e),l&512&&(Pe||a===null||Jt(a,a.return)),a!==null&&l&4&&Zi(e,e.memoizedProps,a.memoizedProps);break;case 5:if(ht(t,e),yt(e),l&512&&(Pe||a===null||Jt(a,a.return)),e.flags&32){n=e.stateNode;try{Nl(n,"")}catch(P){_e(e,e.return,P)}}l&4&&e.stateNode!=null&&(n=e.memoizedProps,Zi(e,n,a!==null?a.memoizedProps:n)),l&1024&&(Wi=!0);break;case 6:if(ht(t,e),yt(e),l&4){if(e.stateNode===null)throw Error(c(162));l=e.memoizedProps,a=e.stateNode;try{a.nodeValue=l}catch(P){_e(e,e.return,P)}}break;case 3:if(cs=null,n=Vt,Vt=is(t.containerInfo),ht(t,e),Vt=n,yt(e),l&4&&a!==null&&a.memoizedState.isDehydrated)try{tn(t.containerInfo)}catch(P){_e(e,e.return,P)}Wi&&(Wi=!1,wd(e));break;case 4:l=Vt,Vt=is(e.stateNode.containerInfo),ht(t,e),yt(e),Vt=l;break;case 12:ht(t,e),yt(e);break;case 31:ht(t,e),yt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ir(e,l)));break;case 13:ht(t,e),yt(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Jr=$()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ir(e,l)));break;case 22:n=e.memoizedState!==null;var b=a!==null&&a.memoizedState!==null,w=fa,_=Pe;if(fa=w||n,Pe=_||b,ht(t,e),Pe=_,fa=w,yt(e),l&8192)e:for(t=e.stateNode,t._visibility=n?t._visibility&-2:t._visibility|1,n&&(a===null||b||fa||Pe||gl(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){b=a=t;try{if(r=b.stateNode,n)u=r.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none";else{m=b.stateNode;var H=b.memoizedProps.style,C=H!=null&&H.hasOwnProperty("display")?H.display:null;m.style.display=C==null||typeof C=="boolean"?"":(""+C).trim()}}catch(P){_e(b,b.return,P)}}}else if(t.tag===6){if(a===null){b=t;try{b.stateNode.nodeValue=n?"":b.memoizedProps}catch(P){_e(b,b.return,P)}}}else if(t.tag===18){if(a===null){b=t;try{var M=b.stateNode;n?hf(M,!0):hf(b.stateNode,!1)}catch(P){_e(b,b.return,P)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(a=l.retryQueue,a!==null&&(l.retryQueue=null,Ir(e,a))));break;case 19:ht(t,e),yt(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Ir(e,l)));break;case 30:break;case 21:break;default:ht(t,e),yt(e)}}function yt(e){var t=e.flags;if(t&2){try{for(var a,l=e.return;l!==null;){if(yd(l)){a=l;break}l=l.return}if(a==null)throw Error(c(160));switch(a.tag){case 27:var n=a.stateNode,r=Ji(e);Qr(e,r,n);break;case 5:var u=a.stateNode;a.flags&32&&(Nl(u,""),a.flags&=-33);var m=Ji(e);Qr(e,m,u);break;case 3:case 4:var b=a.stateNode.containerInfo,w=Ji(e);$i(e,w,b);break;default:throw Error(c(161))}}catch(_){_e(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wd(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;wd(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ga(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)bd(e,t.alternate,t),t=t.sibling}function gl(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ha(4,t,t.return),gl(t);break;case 1:Jt(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&gd(t,t.return,a),gl(t);break;case 27:Zn(t.stateNode);case 26:case 5:Jt(t,t.return),gl(t);break;case 22:t.memoizedState===null&&gl(t);break;case 30:gl(t);break;default:gl(t)}e=e.sibling}}function ha(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,n=e,r=t,u=r.flags;switch(r.tag){case 0:case 11:case 15:ha(n,r,a),Ln(4,r);break;case 1:if(ha(n,r,a),l=r,n=l.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(w){_e(l,l.return,w)}if(l=r,n=l.updateQueue,n!==null){var m=l.stateNode;try{var b=n.shared.hiddenCallbacks;if(b!==null)for(n.shared.hiddenCallbacks=null,n=0;n<b.length;n++)au(b[n],m)}catch(w){_e(l,l.return,w)}}a&&u&64&&md(r),Gn(r,r.return);break;case 27:xd(r);case 26:case 5:ha(n,r,a),a&&l===null&&u&4&&hd(r),Gn(r,r.return);break;case 12:ha(n,r,a);break;case 31:ha(n,r,a),a&&u&4&&jd(n,r);break;case 13:ha(n,r,a),a&&u&4&&kd(n,r);break;case 22:r.memoizedState===null&&ha(n,r,a),Gn(r,r.return);break;case 30:break;default:ha(n,r,a)}t=t.sibling}}function Fi(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&wn(a))}function Pi(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wn(e))}function Xt(e,t,a,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Cd(e,t,a,l),t=t.sibling}function Cd(e,t,a,l){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Xt(e,t,a,l),n&2048&&Ln(9,t);break;case 1:Xt(e,t,a,l);break;case 3:Xt(e,t,a,l),n&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wn(e)));break;case 12:if(n&2048){Xt(e,t,a,l),e=t.stateNode;try{var r=t.memoizedProps,u=r.id,m=r.onPostCommit;typeof m=="function"&&m(u,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(b){_e(t,t.return,b)}}else Xt(e,t,a,l);break;case 31:Xt(e,t,a,l);break;case 13:Xt(e,t,a,l);break;case 23:break;case 22:r=t.stateNode,u=t.alternate,t.memoizedState!==null?r._visibility&2?Xt(e,t,a,l):Bn(e,t):r._visibility&2?Xt(e,t,a,l):(r._visibility|=2,Xl(e,t,a,l,(t.subtreeFlags&10256)!==0||!1)),n&2048&&Fi(u,t);break;case 24:Xt(e,t,a,l),n&2048&&Pi(t.alternate,t);break;default:Xt(e,t,a,l)}}function Xl(e,t,a,l,n){for(n=n&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var r=e,u=t,m=a,b=l,w=u.flags;switch(u.tag){case 0:case 11:case 15:Xl(r,u,m,b,n),Ln(8,u);break;case 23:break;case 22:var _=u.stateNode;u.memoizedState!==null?_._visibility&2?Xl(r,u,m,b,n):Bn(r,u):(_._visibility|=2,Xl(r,u,m,b,n)),n&&w&2048&&Fi(u.alternate,u);break;case 24:Xl(r,u,m,b,n),n&&w&2048&&Pi(u.alternate,u);break;default:Xl(r,u,m,b,n)}t=t.sibling}}function Bn(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,l=t,n=l.flags;switch(l.tag){case 22:Bn(a,l),n&2048&&Fi(l.alternate,l);break;case 24:Bn(a,l),n&2048&&Pi(l.alternate,l);break;default:Bn(a,l)}t=t.sibling}}var Yn=8192;function Kl(e,t,a){if(e.subtreeFlags&Yn)for(e=e.child;e!==null;)Td(e,t,a),e=e.sibling}function Td(e,t,a){switch(e.tag){case 26:Kl(e,t,a),e.flags&Yn&&e.memoizedState!==null&&cg(a,Vt,e.memoizedState,e.memoizedProps);break;case 5:Kl(e,t,a);break;case 3:case 4:var l=Vt;Vt=is(e.stateNode.containerInfo),Kl(e,t,a),Vt=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=Yn,Yn=16777216,Kl(e,t,a),Yn=l):Kl(e,t,a));break;default:Kl(e,t,a)}}function Ed(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function qn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var l=t[a];at=l,Md(l,e)}Ed(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Ad(e),e=e.sibling}function Ad(e){switch(e.tag){case 0:case 11:case 15:qn(e),e.flags&2048&&Ha(9,e,e.return);break;case 3:qn(e);break;case 12:qn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Zr(e)):qn(e);break;default:qn(e)}}function Zr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var l=t[a];at=l,Md(l,e)}Ed(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ha(8,t,t.return),Zr(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Zr(t));break;default:Zr(t)}e=e.sibling}}function Md(e,t){for(;at!==null;){var a=at;switch(a.tag){case 0:case 11:case 15:Ha(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var l=a.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:wn(a.memoizedState.cache)}if(l=a.child,l!==null)l.return=a,at=l;else e:for(a=e;at!==null;){l=at;var n=l.sibling,r=l.return;if(vd(l),l===a){at=null;break e}if(n!==null){n.return=r,at=n;break e}at=r}}}var Nm={getCacheForType:function(e){var t=rt($e),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return rt($e).controller.signal}},wm=typeof WeakMap=="function"?WeakMap:Map,Re=0,Ge=null,ke=null,Ce=0,ze=0,wt=null,La=!1,Ql=!1,eo=!1,ya=0,Ie=0,Ga=0,hl=0,to=0,Ct=0,Il=0,Vn=null,xt=null,ao=!1,Jr=0,Rd=0,$r=1/0,Wr=null,Ba=null,et=0,Ya=null,Zl=null,xa=0,lo=0,no=null,Od=null,Xn=0,ro=null;function Tt(){return(Re&2)!==0&&Ce!==0?Ce&-Ce:E.T!==null?fo():Zo()}function zd(){if(Ct===0)if((Ce&536870912)===0||Ee){var e=rr;rr<<=1,(rr&3932160)===0&&(rr=262144),Ct=e}else Ct=536870912;return e=kt.current,e!==null&&(e.flags|=32),Ct}function pt(e,t,a){(e===Ge&&(ze===2||ze===9)||e.cancelPendingCommit!==null)&&(Jl(e,0),qa(e,Ce,Ct,!1)),dn(e,a),((Re&2)===0||e!==Ge)&&(e===Ge&&((Re&2)===0&&(hl|=a),Ie===4&&qa(e,Ce,Ct,!1)),$t(e))}function _d(e,t,a){if((Re&6)!==0)throw Error(c(327));var l=!a&&(t&127)===0&&(t&e.expiredLanes)===0||un(e,t),n=l?Em(e,t):io(e,t,!0),r=l;do{if(n===0){Ql&&!l&&qa(e,t,0,!1);break}else{if(a=e.current.alternate,r&&!Cm(a)){n=io(e,t,!1),r=!1;continue}if(n===2){if(r=t,e.errorRecoveryDisabledLanes&r)var u=0;else u=e.pendingLanes&-536870913,u=u!==0?u:u&536870912?536870912:0;if(u!==0){t=u;e:{var m=e;n=Vn;var b=m.current.memoizedState.isDehydrated;if(b&&(Jl(m,u).flags|=256),u=io(m,u,!1),u!==2){if(eo&&!b){m.errorRecoveryDisabledLanes|=r,hl|=r,n=4;break e}r=xt,xt=n,r!==null&&(xt===null?xt=r:xt.push.apply(xt,r))}n=u}if(r=!1,n!==2)continue}}if(n===1){Jl(e,0),qa(e,t,0,!0);break}e:{switch(l=e,r=n,r){case 0:case 1:throw Error(c(345));case 4:if((t&4194048)!==t)break;case 6:qa(l,t,Ct,!La);break e;case 2:xt=null;break;case 3:case 5:break;default:throw Error(c(329))}if((t&62914560)===t&&(n=Jr+300-$(),10<n)){if(qa(l,t,Ct,!La),ir(l,0,!0)!==0)break e;xa=t,l.timeoutHandle=ff(Ud.bind(null,l,a,xt,Wr,ao,t,Ct,hl,Il,La,r,"Throttled",-0,0),n);break e}Ud(l,a,xt,Wr,ao,t,Ct,hl,Il,La,r,null,-0,0)}}break}while(!0);$t(e)}function Ud(e,t,a,l,n,r,u,m,b,w,_,H,C,M){if(e.timeoutHandle=-1,H=t.subtreeFlags,H&8192||(H&16785408)===16785408){H={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:aa},Td(t,r,H);var P=(r&62914560)===r?Jr-$():(r&4194048)===r?Rd-$():0;if(P=ug(H,P),P!==null){xa=r,e.cancelPendingCommit=P(Vd.bind(null,e,t,r,a,l,n,u,m,b,_,H,null,C,M)),qa(e,r,u,!w);return}}Vd(e,t,r,a,l,n,u,m,b)}function Cm(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var l=0;l<a.length;l++){var n=a[l],r=n.getSnapshot;n=n.value;try{if(!St(r(),n))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qa(e,t,a,l){t&=~to,t&=~hl,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var n=t;0<n;){var r=31-vt(n),u=1<<r;l[r]=-1,n&=~u}a!==0&&Ko(e,a,t)}function Fr(){return(Re&6)===0?(Kn(0),!1):!0}function so(){if(ke!==null){if(ze===0)var e=ke.return;else e=ke,sa=sl=null,ji(e),Gl=null,Tn=0,e=ke;for(;e!==null;)fd(e.alternate,e),e=e.return;ke=null}}function Jl(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Qm(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),xa=0,so(),Ge=e,ke=a=na(e.current,null),Ce=t,ze=0,wt=null,La=!1,Ql=un(e,t),eo=!1,Il=Ct=to=hl=Ga=Ie=0,xt=Vn=null,ao=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var n=31-vt(l),r=1<<n;t|=e[n],l&=~r}return ya=t,br(),a}function Dd(e,t){ye=null,E.H=Un,t===Ll||t===Tr?(t=Fc(),ze=3):t===ui?(t=Fc(),ze=4):ze=t===Li?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,wt=t,ke===null&&(Ie=1,Yr(e,Ut(t,e.current)))}function Hd(){var e=kt.current;return e===null?!0:(Ce&4194048)===Ce?Gt===null:(Ce&62914560)===Ce||(Ce&536870912)!==0?e===Gt:!1}function Ld(){var e=E.H;return E.H=Un,e===null?Un:e}function Gd(){var e=E.A;return E.A=Nm,e}function Pr(){Ie=4,La||(Ce&4194048)!==Ce&&kt.current!==null||(Ql=!0),(Ga&134217727)===0&&(hl&134217727)===0||Ge===null||qa(Ge,Ce,Ct,!1)}function io(e,t,a){var l=Re;Re|=2;var n=Ld(),r=Gd();(Ge!==e||Ce!==t)&&(Wr=null,Jl(e,t)),t=!1;var u=Ie;e:do try{if(ze!==0&&ke!==null){var m=ke,b=wt;switch(ze){case 8:so(),u=6;break e;case 3:case 2:case 9:case 6:kt.current===null&&(t=!0);var w=ze;if(ze=0,wt=null,$l(e,m,b,w),a&&Ql){u=0;break e}break;default:w=ze,ze=0,wt=null,$l(e,m,b,w)}}Tm(),u=Ie;break}catch(_){Dd(e,_)}while(!0);return t&&e.shellSuspendCounter++,sa=sl=null,Re=l,E.H=n,E.A=r,ke===null&&(Ge=null,Ce=0,br()),u}function Tm(){for(;ke!==null;)Bd(ke)}function Em(e,t){var a=Re;Re|=2;var l=Ld(),n=Gd();Ge!==e||Ce!==t?(Wr=null,$r=$()+500,Jl(e,t)):Ql=un(e,t);e:do try{if(ze!==0&&ke!==null){t=ke;var r=wt;t:switch(ze){case 1:ze=0,wt=null,$l(e,t,r,1);break;case 2:case 9:if($c(r)){ze=0,wt=null,Yd(t);break}t=function(){ze!==2&&ze!==9||Ge!==e||(ze=7),$t(e)},r.then(t,t);break e;case 3:ze=7;break e;case 4:ze=5;break e;case 7:$c(r)?(ze=0,wt=null,Yd(t)):(ze=0,wt=null,$l(e,t,r,7));break;case 5:var u=null;switch(ke.tag){case 26:u=ke.memoizedState;case 5:case 27:var m=ke;if(u?Tf(u):m.stateNode.complete){ze=0,wt=null;var b=m.sibling;if(b!==null)ke=b;else{var w=m.return;w!==null?(ke=w,es(w)):ke=null}break t}}ze=0,wt=null,$l(e,t,r,5);break;case 6:ze=0,wt=null,$l(e,t,r,6);break;case 8:so(),Ie=6;break e;default:throw Error(c(462))}}Am();break}catch(_){Dd(e,_)}while(!0);return sa=sl=null,E.H=l,E.A=n,Re=a,ke!==null?0:(Ge=null,Ce=0,br(),Ie)}function Am(){for(;ke!==null&&!Z();)Bd(ke)}function Bd(e){var t=ud(e.alternate,e,ya);e.memoizedProps=e.pendingProps,t===null?es(e):ke=t}function Yd(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=nd(a,t,t.pendingProps,t.type,void 0,Ce);break;case 11:t=nd(a,t,t.pendingProps,t.type.render,t.ref,Ce);break;case 5:ji(t);default:fd(a,t),t=ke=Gc(t,ya),t=ud(a,t,ya)}e.memoizedProps=e.pendingProps,t===null?es(e):ke=t}function $l(e,t,a,l){sa=sl=null,ji(t),Gl=null,Tn=0;var n=t.return;try{if(xm(e,n,t,a,Ce)){Ie=1,Yr(e,Ut(a,e.current)),ke=null;return}}catch(r){if(n!==null)throw ke=n,r;Ie=1,Yr(e,Ut(a,e.current)),ke=null;return}t.flags&32768?(Ee||l===1?e=!0:Ql||(Ce&536870912)!==0?e=!1:(La=e=!0,(l===2||l===9||l===3||l===6)&&(l=kt.current,l!==null&&l.tag===13&&(l.flags|=16384))),qd(t,e)):es(t)}function es(e){var t=e;do{if((t.flags&32768)!==0){qd(t,La);return}e=t.return;var a=vm(t.alternate,t,ya);if(a!==null){ke=a;return}if(t=t.sibling,t!==null){ke=t;return}ke=t=e}while(t!==null);Ie===0&&(Ie=5)}function qd(e,t){do{var a=Sm(e.alternate,e);if(a!==null){a.flags&=32767,ke=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){ke=e;return}ke=e=a}while(e!==null);Ie=6,ke=null}function Vd(e,t,a,l,n,r,u,m,b){e.cancelPendingCommit=null;do ts();while(et!==0);if((Re&6)!==0)throw Error(c(327));if(t!==null){if(t===e.current)throw Error(c(177));if(r=t.lanes|t.childLanes,r|=Js,o0(e,a,r,u,m,b),e===Ge&&(ke=Ge=null,Ce=0),Zl=t,Ya=e,xa=a,lo=r,no=n,Od=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,zm(Oe,function(){return Zd(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=E.T,E.T=null,n=L.p,L.p=2,u=Re,Re|=4;try{jm(e,t,a)}finally{Re=u,L.p=n,E.T=l}}et=1,Xd(),Kd(),Qd()}}function Xd(){if(et===1){et=0;var e=Ya,t=Zl,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=E.T,E.T=null;var l=L.p;L.p=2;var n=Re;Re|=4;try{Nd(t,e);var r=vo,u=Mc(e.containerInfo),m=r.focusedElem,b=r.selectionRange;if(u!==m&&m&&m.ownerDocument&&Ac(m.ownerDocument.documentElement,m)){if(b!==null&&Xs(m)){var w=b.start,_=b.end;if(_===void 0&&(_=w),"selectionStart"in m)m.selectionStart=w,m.selectionEnd=Math.min(_,m.value.length);else{var H=m.ownerDocument||document,C=H&&H.defaultView||window;if(C.getSelection){var M=C.getSelection(),P=m.textContent.length,ce=Math.min(b.start,P),Le=b.end===void 0?ce:Math.min(b.end,P);!M.extend&&ce>Le&&(u=Le,Le=ce,ce=u);var k=Ec(m,ce),S=Ec(m,Le);if(k&&S&&(M.rangeCount!==1||M.anchorNode!==k.node||M.anchorOffset!==k.offset||M.focusNode!==S.node||M.focusOffset!==S.offset)){var N=H.createRange();N.setStart(k.node,k.offset),M.removeAllRanges(),ce>Le?(M.addRange(N),M.extend(S.node,S.offset)):(N.setEnd(S.node,S.offset),M.addRange(N))}}}}for(H=[],M=m;M=M.parentNode;)M.nodeType===1&&H.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<H.length;m++){var D=H[m];D.element.scrollLeft=D.left,D.element.scrollTop=D.top}}ms=!!bo,vo=bo=null}finally{Re=n,L.p=l,E.T=a}}e.current=t,et=2}}function Kd(){if(et===2){et=0;var e=Ya,t=Zl,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=E.T,E.T=null;var l=L.p;L.p=2;var n=Re;Re|=4;try{bd(e,t.alternate,t)}finally{Re=n,L.p=l,E.T=a}}et=3}}function Qd(){if(et===4||et===3){et=0,J();var e=Ya,t=Zl,a=xa,l=Od;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?et=5:(et=0,Zl=Ya=null,Id(e,e.pendingLanes));var n=e.pendingLanes;if(n===0&&(Ba=null),ws(a),t=t.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(cn,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=E.T,n=L.p,L.p=2,E.T=null;try{for(var r=e.onRecoverableError,u=0;u<l.length;u++){var m=l[u];r(m.value,{componentStack:m.stack})}}finally{E.T=t,L.p=n}}(xa&3)!==0&&ts(),$t(e),n=e.pendingLanes,(a&261930)!==0&&(n&42)!==0?e===ro?Xn++:(Xn=0,ro=e):Xn=0,Kn(0)}}function Id(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,wn(t)))}function ts(){return Xd(),Kd(),Qd(),Zd()}function Zd(){if(et!==5)return!1;var e=Ya,t=lo;lo=0;var a=ws(xa),l=E.T,n=L.p;try{L.p=32>a?32:a,E.T=null,a=no,no=null;var r=Ya,u=xa;if(et=0,Zl=Ya=null,xa=0,(Re&6)!==0)throw Error(c(331));var m=Re;if(Re|=4,Ad(r.current),Cd(r,r.current,u,a),Re=m,Kn(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(cn,r)}catch{}return!0}finally{L.p=n,E.T=l,Id(e,t)}}function Jd(e,t,a){t=Ut(a,t),t=Hi(e.stateNode,t,2),e=_a(e,t,2),e!==null&&(dn(e,2),$t(e))}function _e(e,t,a){if(e.tag===3)Jd(e,e,a);else for(;t!==null;){if(t.tag===3){Jd(t,e,a);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Ba===null||!Ba.has(l))){e=Ut(a,e),a=$u(2),l=_a(t,a,2),l!==null&&(Wu(a,l,t,e),dn(l,2),$t(l));break}}t=t.return}}function oo(e,t,a){var l=e.pingCache;if(l===null){l=e.pingCache=new wm;var n=new Set;l.set(t,n)}else n=l.get(t),n===void 0&&(n=new Set,l.set(t,n));n.has(a)||(eo=!0,n.add(a),e=Mm.bind(null,e,t,a),t.then(e,e))}function Mm(e,t,a){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,Ge===e&&(Ce&a)===a&&(Ie===4||Ie===3&&(Ce&62914560)===Ce&&300>$()-Jr?(Re&2)===0&&Jl(e,0):to|=a,Il===Ce&&(Il=0)),$t(e)}function $d(e,t){t===0&&(t=Xo()),e=ll(e,t),e!==null&&(dn(e,t),$t(e))}function Rm(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),$d(e,a)}function Om(e,t){var a=0;switch(e.tag){case 31:case 13:var l=e.stateNode,n=e.memoizedState;n!==null&&(a=n.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(c(314))}l!==null&&l.delete(t),$d(e,a)}function zm(e,t){return sn(e,t)}var as=null,Wl=null,co=!1,ls=!1,uo=!1,Va=0;function $t(e){e!==Wl&&e.next===null&&(Wl===null?as=Wl=e:Wl=Wl.next=e),ls=!0,co||(co=!0,Um())}function Kn(e,t){if(!uo&&ls){uo=!0;do for(var a=!1,l=as;l!==null;){if(e!==0){var n=l.pendingLanes;if(n===0)var r=0;else{var u=l.suspendedLanes,m=l.pingedLanes;r=(1<<31-vt(42|e)+1)-1,r&=n&~(u&~m),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(a=!0,ef(l,r))}else r=Ce,r=ir(l,l===Ge?r:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(r&3)===0||un(l,r)||(a=!0,ef(l,r));l=l.next}while(a);uo=!1}}function _m(){Wd()}function Wd(){ls=co=!1;var e=0;Va!==0&&Km()&&(e=Va);for(var t=$(),a=null,l=as;l!==null;){var n=l.next,r=Fd(l,t);r===0?(l.next=null,a===null?as=n:a.next=n,n===null&&(Wl=a)):(a=l,(e!==0||(r&3)!==0)&&(ls=!0)),l=n}et!==0&&et!==5||Kn(e),Va!==0&&(Va=0)}function Fd(e,t){for(var a=e.suspendedLanes,l=e.pingedLanes,n=e.expirationTimes,r=e.pendingLanes&-62914561;0<r;){var u=31-vt(r),m=1<<u,b=n[u];b===-1?((m&a)===0||(m&l)!==0)&&(n[u]=i0(m,t)):b<=t&&(e.expiredLanes|=m),r&=~m}if(t=Ge,a=Ce,a=ir(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,a===0||e===t&&(ze===2||ze===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&on(l),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||un(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(l!==null&&on(l),ws(a)){case 2:case 8:a=fe;break;case 32:a=Oe;break;case 268435456:a=Rt;break;default:a=Oe}return l=Pd.bind(null,e),a=sn(a,l),e.callbackPriority=t,e.callbackNode=a,t}return l!==null&&l!==null&&on(l),e.callbackPriority=2,e.callbackNode=null,2}function Pd(e,t){if(et!==0&&et!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(ts()&&e.callbackNode!==a)return null;var l=Ce;return l=ir(e,e===Ge?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(_d(e,l,t),Fd(e,$()),e.callbackNode!=null&&e.callbackNode===a?Pd.bind(null,e):null)}function ef(e,t){if(ts())return null;_d(e,t,!0)}function Um(){Im(function(){(Re&6)!==0?sn(le,_m):Wd()})}function fo(){if(Va===0){var e=Dl;e===0&&(e=nr,nr<<=1,(nr&261888)===0&&(nr=256)),Va=e}return Va}function tf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:dr(""+e)}function af(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function Dm(e,t,a,l,n){if(t==="submit"&&a&&a.stateNode===n){var r=tf((n[ft]||null).action),u=l.submitter;u&&(t=(t=u[ft]||null)?tf(t.formAction):u.getAttribute("formAction"),t!==null&&(r=t,u=null));var m=new hr("action","action",null,l,n);e.push({event:m,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Va!==0){var b=u?af(n,u):new FormData(n);Ri(a,{pending:!0,data:b,method:n.method,action:r},null,b)}}else typeof r=="function"&&(m.preventDefault(),b=u?af(n,u):new FormData(n),Ri(a,{pending:!0,data:b,method:n.method,action:r},r,b))},currentTarget:n}]})}}for(var mo=0;mo<Zs.length;mo++){var go=Zs[mo],Hm=go.toLowerCase(),Lm=go[0].toUpperCase()+go.slice(1);qt(Hm,"on"+Lm)}qt(zc,"onAnimationEnd"),qt(_c,"onAnimationIteration"),qt(Uc,"onAnimationStart"),qt("dblclick","onDoubleClick"),qt("focusin","onFocus"),qt("focusout","onBlur"),qt(em,"onTransitionRun"),qt(tm,"onTransitionStart"),qt(am,"onTransitionCancel"),qt(Dc,"onTransitionEnd"),jl("onMouseEnter",["mouseout","mouseover"]),jl("onMouseLeave",["mouseout","mouseover"]),jl("onPointerEnter",["pointerout","pointerover"]),jl("onPointerLeave",["pointerout","pointerover"]),Pa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qn));function lf(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var l=e[a],n=l.event;l=l.listeners;e:{var r=void 0;if(t)for(var u=l.length-1;0<=u;u--){var m=l[u],b=m.instance,w=m.currentTarget;if(m=m.listener,b!==r&&n.isPropagationStopped())break e;r=m,n.currentTarget=w;try{r(n)}catch(_){pr(_)}n.currentTarget=null,r=b}else for(u=0;u<l.length;u++){if(m=l[u],b=m.instance,w=m.currentTarget,m=m.listener,b!==r&&n.isPropagationStopped())break e;r=m,n.currentTarget=w;try{r(n)}catch(_){pr(_)}n.currentTarget=null,r=b}}}}function Ne(e,t){var a=t[Cs];a===void 0&&(a=t[Cs]=new Set);var l=e+"__bubble";a.has(l)||(nf(t,e,2,!1),a.add(l))}function ho(e,t,a){var l=0;t&&(l|=4),nf(a,e,l,t)}var ns="_reactListening"+Math.random().toString(36).slice(2);function yo(e){if(!e[ns]){e[ns]=!0,Wo.forEach(function(a){a!=="selectionchange"&&(Gm.has(a)||ho(a,!1,e),ho(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ns]||(t[ns]=!0,ho("selectionchange",!1,t))}}function nf(e,t,a,l){switch(_f(t)){case 2:var n=mg;break;case 8:n=gg;break;default:n=Ro}a=n.bind(null,t,a,e),n=void 0,!Us||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),l?n!==void 0?e.addEventListener(t,a,{capture:!0,passive:n}):e.addEventListener(t,a,!0):n!==void 0?e.addEventListener(t,a,{passive:n}):e.addEventListener(t,a,!1)}function xo(e,t,a,l,n){var r=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var u=l.tag;if(u===3||u===4){var m=l.stateNode.containerInfo;if(m===n)break;if(u===4)for(u=l.return;u!==null;){var b=u.tag;if((b===3||b===4)&&u.stateNode.containerInfo===n)return;u=u.return}for(;m!==null;){if(u=bl(m),u===null)return;if(b=u.tag,b===5||b===6||b===26||b===27){l=r=u;continue e}m=m.parentNode}}l=l.return}cc(function(){var w=r,_=zs(a),H=[];e:{var C=Hc.get(e);if(C!==void 0){var M=hr,P=e;switch(e){case"keypress":if(mr(a)===0)break e;case"keydown":case"keyup":M=O0;break;case"focusin":P="focus",M=Gs;break;case"focusout":P="blur",M=Gs;break;case"beforeblur":case"afterblur":M=Gs;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=fc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=v0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=U0;break;case zc:case _c:case Uc:M=k0;break;case Dc:M=H0;break;case"scroll":case"scrollend":M=p0;break;case"wheel":M=G0;break;case"copy":case"cut":case"paste":M=w0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=gc;break;case"toggle":case"beforetoggle":M=Y0}var ce=(t&4)!==0,Le=!ce&&(e==="scroll"||e==="scrollend"),k=ce?C!==null?C+"Capture":null:C;ce=[];for(var S=w,N;S!==null;){var D=S;if(N=D.stateNode,D=D.tag,D!==5&&D!==26&&D!==27||N===null||k===null||(D=gn(S,k),D!=null&&ce.push(In(S,D,N))),Le)break;S=S.return}0<ce.length&&(C=new M(C,P,null,a,_),H.push({event:C,listeners:ce}))}}if((t&7)===0){e:{if(C=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",C&&a!==Os&&(P=a.relatedTarget||a.fromElement)&&(bl(P)||P[pl]))break e;if((M||C)&&(C=_.window===_?_:(C=_.ownerDocument)?C.defaultView||C.parentWindow:window,M?(P=a.relatedTarget||a.toElement,M=w,P=P?bl(P):null,P!==null&&(Le=f(P),ce=P.tag,P!==Le||ce!==5&&ce!==27&&ce!==6)&&(P=null)):(M=null,P=w),M!==P)){if(ce=fc,D="onMouseLeave",k="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(ce=gc,D="onPointerLeave",k="onPointerEnter",S="pointer"),Le=M==null?C:mn(M),N=P==null?C:mn(P),C=new ce(D,S+"leave",M,a,_),C.target=Le,C.relatedTarget=N,D=null,bl(_)===w&&(ce=new ce(k,S+"enter",P,a,_),ce.target=N,ce.relatedTarget=Le,D=ce),Le=D,M&&P)t:{for(ce=Bm,k=M,S=P,N=0,D=k;D;D=ce(D))N++;D=0;for(var ne=S;ne;ne=ce(ne))D++;for(;0<N-D;)k=ce(k),N--;for(;0<D-N;)S=ce(S),D--;for(;N--;){if(k===S||S!==null&&k===S.alternate){ce=k;break t}k=ce(k),S=ce(S)}ce=null}else ce=null;M!==null&&rf(H,C,M,ce,!1),P!==null&&Le!==null&&rf(H,Le,P,ce,!0)}}e:{if(C=w?mn(w):window,M=C.nodeName&&C.nodeName.toLowerCase(),M==="select"||M==="input"&&C.type==="file")var Ae=jc;else if(vc(C))if(kc)Ae=W0;else{Ae=J0;var ee=Z0}else M=C.nodeName,!M||M.toLowerCase()!=="input"||C.type!=="checkbox"&&C.type!=="radio"?w&&Rs(w.elementType)&&(Ae=jc):Ae=$0;if(Ae&&(Ae=Ae(e,w))){Sc(H,Ae,a,_);break e}ee&&ee(e,C,w),e==="focusout"&&w&&C.type==="number"&&w.memoizedProps.value!=null&&Ms(C,"number",C.value)}switch(ee=w?mn(w):window,e){case"focusin":(vc(ee)||ee.contentEditable==="true")&&(El=ee,Ks=w,jn=null);break;case"focusout":jn=Ks=El=null;break;case"mousedown":Qs=!0;break;case"contextmenu":case"mouseup":case"dragend":Qs=!1,Rc(H,a,_);break;case"selectionchange":if(P0)break;case"keydown":case"keyup":Rc(H,a,_)}var pe;if(Ys)e:{switch(e){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else Tl?pc(e,a)&&(Te="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Te="onCompositionStart");Te&&(hc&&a.locale!=="ko"&&(Tl||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&Tl&&(pe=uc()):(Ta=_,Ds="value"in Ta?Ta.value:Ta.textContent,Tl=!0)),ee=rs(w,Te),0<ee.length&&(Te=new mc(Te,e,null,a,_),H.push({event:Te,listeners:ee}),pe?Te.data=pe:(pe=bc(a),pe!==null&&(Te.data=pe)))),(pe=V0?X0(e,a):K0(e,a))&&(Te=rs(w,"onBeforeInput"),0<Te.length&&(ee=new mc("onBeforeInput","beforeinput",null,a,_),H.push({event:ee,listeners:Te}),ee.data=pe)),Dm(H,e,w,a,_)}lf(H,t)})}function In(e,t,a){return{instance:e,listener:t,currentTarget:a}}function rs(e,t){for(var a=t+"Capture",l=[];e!==null;){var n=e,r=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||r===null||(n=gn(e,a),n!=null&&l.unshift(In(e,n,r)),n=gn(e,t),n!=null&&l.push(In(e,n,r))),e.tag===3)return l;e=e.return}return[]}function Bm(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function rf(e,t,a,l,n){for(var r=t._reactName,u=[];a!==null&&a!==l;){var m=a,b=m.alternate,w=m.stateNode;if(m=m.tag,b!==null&&b===l)break;m!==5&&m!==26&&m!==27||w===null||(b=w,n?(w=gn(a,r),w!=null&&u.unshift(In(a,w,b))):n||(w=gn(a,r),w!=null&&u.push(In(a,w,b)))),a=a.return}u.length!==0&&e.push({event:t,listeners:u})}var Ym=/\r\n?/g,qm=/\u0000|\uFFFD/g;function sf(e){return(typeof e=="string"?e:""+e).replace(Ym,`
`).replace(qm,"")}function of(e,t){return t=sf(t),sf(e)===t}function He(e,t,a,l,n,r){switch(a){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||Nl(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&Nl(e,""+l);break;case"className":cr(e,"class",l);break;case"tabIndex":cr(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":cr(e,a,l);break;case"style":ic(e,l,r);break;case"data":if(t!=="object"){cr(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(a);break}l=dr(""+l),e.setAttribute(a,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(a==="formAction"?(t!=="input"&&He(e,t,"name",n.name,n,null),He(e,t,"formEncType",n.formEncType,n,null),He(e,t,"formMethod",n.formMethod,n,null),He(e,t,"formTarget",n.formTarget,n,null)):(He(e,t,"encType",n.encType,n,null),He(e,t,"method",n.method,n,null),He(e,t,"target",n.target,n,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(a);break}l=dr(""+l),e.setAttribute(a,l);break;case"onClick":l!=null&&(e.onclick=aa);break;case"onScroll":l!=null&&Ne("scroll",e);break;case"onScrollEnd":l!=null&&Ne("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(c(61));if(a=l.__html,a!=null){if(n.children!=null)throw Error(c(60));e.innerHTML=a}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}a=dr(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,""+l):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":l===!0?e.setAttribute(a,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(a,l):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(a,l):e.removeAttribute(a);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(a):e.setAttribute(a,l);break;case"popover":Ne("beforetoggle",e),Ne("toggle",e),or(e,"popover",l);break;case"xlinkActuate":ta(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":ta(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":ta(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":ta(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":ta(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":ta(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":ta(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":ta(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":ta(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":or(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=y0.get(a)||a,or(e,a,l))}}function po(e,t,a,l,n,r){switch(a){case"style":ic(e,l,r);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(c(61));if(a=l.__html,a!=null){if(n.children!=null)throw Error(c(60));e.innerHTML=a}}break;case"children":typeof l=="string"?Nl(e,l):(typeof l=="number"||typeof l=="bigint")&&Nl(e,""+l);break;case"onScroll":l!=null&&Ne("scroll",e);break;case"onScrollEnd":l!=null&&Ne("scrollend",e);break;case"onClick":l!=null&&(e.onclick=aa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fo.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(n=a.endsWith("Capture"),t=a.slice(2,n?a.length-7:void 0),r=e[ft]||null,r=r!=null?r[a]:null,typeof r=="function"&&e.removeEventListener(t,r,n),typeof l=="function")){typeof r!="function"&&r!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,l,n);break e}a in e?e[a]=l:l===!0?e.setAttribute(a,""):or(e,a,l)}}}function it(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ne("error",e),Ne("load",e);var l=!1,n=!1,r;for(r in a)if(a.hasOwnProperty(r)){var u=a[r];if(u!=null)switch(r){case"src":l=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:He(e,t,r,u,a,null)}}n&&He(e,t,"srcSet",a.srcSet,a,null),l&&He(e,t,"src",a.src,a,null);return;case"input":Ne("invalid",e);var m=r=u=n=null,b=null,w=null;for(l in a)if(a.hasOwnProperty(l)){var _=a[l];if(_!=null)switch(l){case"name":n=_;break;case"type":u=_;break;case"checked":b=_;break;case"defaultChecked":w=_;break;case"value":r=_;break;case"defaultValue":m=_;break;case"children":case"dangerouslySetInnerHTML":if(_!=null)throw Error(c(137,t));break;default:He(e,t,l,_,a,null)}}lc(e,r,m,b,w,u,n,!1);return;case"select":Ne("invalid",e),l=u=r=null;for(n in a)if(a.hasOwnProperty(n)&&(m=a[n],m!=null))switch(n){case"value":r=m;break;case"defaultValue":u=m;break;case"multiple":l=m;default:He(e,t,n,m,a,null)}t=r,a=u,e.multiple=!!l,t!=null?kl(e,!!l,t,!1):a!=null&&kl(e,!!l,a,!0);return;case"textarea":Ne("invalid",e),r=n=l=null;for(u in a)if(a.hasOwnProperty(u)&&(m=a[u],m!=null))switch(u){case"value":l=m;break;case"defaultValue":n=m;break;case"children":r=m;break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(c(91));break;default:He(e,t,u,m,a,null)}rc(e,l,n,r);return;case"option":for(b in a)if(a.hasOwnProperty(b)&&(l=a[b],l!=null))switch(b){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:He(e,t,b,l,a,null)}return;case"dialog":Ne("beforetoggle",e),Ne("toggle",e),Ne("cancel",e),Ne("close",e);break;case"iframe":case"object":Ne("load",e);break;case"video":case"audio":for(l=0;l<Qn.length;l++)Ne(Qn[l],e);break;case"image":Ne("error",e),Ne("load",e);break;case"details":Ne("toggle",e);break;case"embed":case"source":case"link":Ne("error",e),Ne("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(w in a)if(a.hasOwnProperty(w)&&(l=a[w],l!=null))switch(w){case"children":case"dangerouslySetInnerHTML":throw Error(c(137,t));default:He(e,t,w,l,a,null)}return;default:if(Rs(t)){for(_ in a)a.hasOwnProperty(_)&&(l=a[_],l!==void 0&&po(e,t,_,l,a,void 0));return}}for(m in a)a.hasOwnProperty(m)&&(l=a[m],l!=null&&He(e,t,m,l,a,null))}function Vm(e,t,a,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,r=null,u=null,m=null,b=null,w=null,_=null;for(M in a){var H=a[M];if(a.hasOwnProperty(M)&&H!=null)switch(M){case"checked":break;case"value":break;case"defaultValue":b=H;default:l.hasOwnProperty(M)||He(e,t,M,null,l,H)}}for(var C in l){var M=l[C];if(H=a[C],l.hasOwnProperty(C)&&(M!=null||H!=null))switch(C){case"type":r=M;break;case"name":n=M;break;case"checked":w=M;break;case"defaultChecked":_=M;break;case"value":u=M;break;case"defaultValue":m=M;break;case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(c(137,t));break;default:M!==H&&He(e,t,C,M,l,H)}}As(e,u,m,b,w,_,r,n);return;case"select":M=u=m=C=null;for(r in a)if(b=a[r],a.hasOwnProperty(r)&&b!=null)switch(r){case"value":break;case"multiple":M=b;default:l.hasOwnProperty(r)||He(e,t,r,null,l,b)}for(n in l)if(r=l[n],b=a[n],l.hasOwnProperty(n)&&(r!=null||b!=null))switch(n){case"value":C=r;break;case"defaultValue":m=r;break;case"multiple":u=r;default:r!==b&&He(e,t,n,r,l,b)}t=m,a=u,l=M,C!=null?kl(e,!!a,C,!1):!!l!=!!a&&(t!=null?kl(e,!!a,t,!0):kl(e,!!a,a?[]:"",!1));return;case"textarea":M=C=null;for(m in a)if(n=a[m],a.hasOwnProperty(m)&&n!=null&&!l.hasOwnProperty(m))switch(m){case"value":break;case"children":break;default:He(e,t,m,null,l,n)}for(u in l)if(n=l[u],r=a[u],l.hasOwnProperty(u)&&(n!=null||r!=null))switch(u){case"value":C=n;break;case"defaultValue":M=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(c(91));break;default:n!==r&&He(e,t,u,n,l,r)}nc(e,C,M);return;case"option":for(var P in a)if(C=a[P],a.hasOwnProperty(P)&&C!=null&&!l.hasOwnProperty(P))switch(P){case"selected":e.selected=!1;break;default:He(e,t,P,null,l,C)}for(b in l)if(C=l[b],M=a[b],l.hasOwnProperty(b)&&C!==M&&(C!=null||M!=null))switch(b){case"selected":e.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:He(e,t,b,C,l,M)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ce in a)C=a[ce],a.hasOwnProperty(ce)&&C!=null&&!l.hasOwnProperty(ce)&&He(e,t,ce,null,l,C);for(w in l)if(C=l[w],M=a[w],l.hasOwnProperty(w)&&C!==M&&(C!=null||M!=null))switch(w){case"children":case"dangerouslySetInnerHTML":if(C!=null)throw Error(c(137,t));break;default:He(e,t,w,C,l,M)}return;default:if(Rs(t)){for(var Le in a)C=a[Le],a.hasOwnProperty(Le)&&C!==void 0&&!l.hasOwnProperty(Le)&&po(e,t,Le,void 0,l,C);for(_ in l)C=l[_],M=a[_],!l.hasOwnProperty(_)||C===M||C===void 0&&M===void 0||po(e,t,_,C,l,M);return}}for(var k in a)C=a[k],a.hasOwnProperty(k)&&C!=null&&!l.hasOwnProperty(k)&&He(e,t,k,null,l,C);for(H in l)C=l[H],M=a[H],!l.hasOwnProperty(H)||C===M||C==null&&M==null||He(e,t,H,C,l,M)}function cf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Xm(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),l=0;l<a.length;l++){var n=a[l],r=n.transferSize,u=n.initiatorType,m=n.duration;if(r&&m&&cf(u)){for(u=0,m=n.responseEnd,l+=1;l<a.length;l++){var b=a[l],w=b.startTime;if(w>m)break;var _=b.transferSize,H=b.initiatorType;_&&cf(H)&&(b=b.responseEnd,u+=_*(b<m?1:(m-w)/(b-w)))}if(--l,t+=8*(r+u)/(n.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var bo=null,vo=null;function ss(e){return e.nodeType===9?e:e.ownerDocument}function uf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function df(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function So(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jo=null;function Km(){var e=window.event;return e&&e.type==="popstate"?e===jo?!1:(jo=e,!0):(jo=null,!1)}var ff=typeof setTimeout=="function"?setTimeout:void 0,Qm=typeof clearTimeout=="function"?clearTimeout:void 0,mf=typeof Promise=="function"?Promise:void 0,Im=typeof queueMicrotask=="function"?queueMicrotask:typeof mf<"u"?function(e){return mf.resolve(null).then(e).catch(Zm)}:ff;function Zm(e){setTimeout(function(){throw e})}function Xa(e){return e==="head"}function gf(e,t){var a=t,l=0;do{var n=a.nextSibling;if(e.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"||a==="/&"){if(l===0){e.removeChild(n),tn(t);return}l--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")l++;else if(a==="html")Zn(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Zn(a);for(var r=a.firstChild;r;){var u=r.nextSibling,m=r.nodeName;r[fn]||m==="SCRIPT"||m==="STYLE"||m==="LINK"&&r.rel.toLowerCase()==="stylesheet"||a.removeChild(r),r=u}}else a==="body"&&Zn(e.ownerDocument.body);a=n}while(a);tn(t)}function hf(e,t){var a=e;e=0;do{var l=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),l&&l.nodeType===8)if(a=l.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=l}while(a)}function ko(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":ko(a),Ts(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Jm(e,t,a,l){for(;e.nodeType===1;){var n=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[fn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(r=e.getAttribute("rel"),r==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(r!==n.rel||e.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||e.getAttribute("title")!==(n.title==null?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(r=e.getAttribute("src"),(r!==(n.src==null?null:n.src)||e.getAttribute("type")!==(n.type==null?null:n.type)||e.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var r=n.name==null?null:""+n.name;if(n.type==="hidden"&&e.getAttribute("name")===r)return e}else return e;if(e=Bt(e.nextSibling),e===null)break}return null}function $m(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Bt(e.nextSibling),e===null))return null;return e}function yf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Bt(e.nextSibling),e===null))return null;return e}function No(e){return e.data==="$?"||e.data==="$~"}function wo(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Wm(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var l=function(){t(),a.removeEventListener("DOMContentLoaded",l)};a.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function Bt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Co=null;function xf(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return Bt(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function pf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function bf(e,t,a){switch(t=ss(a),e){case"html":if(e=t.documentElement,!e)throw Error(c(452));return e;case"head":if(e=t.head,!e)throw Error(c(453));return e;case"body":if(e=t.body,!e)throw Error(c(454));return e;default:throw Error(c(451))}}function Zn(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ts(e)}var Yt=new Map,vf=new Set;function is(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var pa=L.d;L.d={f:Fm,r:Pm,D:eg,C:tg,L:ag,m:lg,X:rg,S:ng,M:sg};function Fm(){var e=pa.f(),t=Fr();return e||t}function Pm(e){var t=vl(e);t!==null&&t.tag===5&&t.type==="form"?Du(t):pa.r(e)}var Fl=typeof document>"u"?null:document;function Sf(e,t,a){var l=Fl;if(l&&typeof t=="string"&&t){var n=zt(t);n='link[rel="'+e+'"][href="'+n+'"]',typeof a=="string"&&(n+='[crossorigin="'+a+'"]'),vf.has(n)||(vf.add(n),e={rel:e,crossOrigin:a,href:t},l.querySelector(n)===null&&(t=l.createElement("link"),it(t,"link",e),tt(t),l.head.appendChild(t)))}}function eg(e){pa.D(e),Sf("dns-prefetch",e,null)}function tg(e,t){pa.C(e,t),Sf("preconnect",e,t)}function ag(e,t,a){pa.L(e,t,a);var l=Fl;if(l&&e&&t){var n='link[rel="preload"][as="'+zt(t)+'"]';t==="image"&&a&&a.imageSrcSet?(n+='[imagesrcset="'+zt(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(n+='[imagesizes="'+zt(a.imageSizes)+'"]')):n+='[href="'+zt(e)+'"]';var r=n;switch(t){case"style":r=Pl(e);break;case"script":r=en(e)}Yt.has(r)||(e=T({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),Yt.set(r,e),l.querySelector(n)!==null||t==="style"&&l.querySelector(Jn(r))||t==="script"&&l.querySelector($n(r))||(t=l.createElement("link"),it(t,"link",e),tt(t),l.head.appendChild(t)))}}function lg(e,t){pa.m(e,t);var a=Fl;if(a&&e){var l=t&&typeof t.as=="string"?t.as:"script",n='link[rel="modulepreload"][as="'+zt(l)+'"][href="'+zt(e)+'"]',r=n;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=en(e)}if(!Yt.has(r)&&(e=T({rel:"modulepreload",href:e},t),Yt.set(r,e),a.querySelector(n)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector($n(r)))return}l=a.createElement("link"),it(l,"link",e),tt(l),a.head.appendChild(l)}}}function ng(e,t,a){pa.S(e,t,a);var l=Fl;if(l&&e){var n=Sl(l).hoistableStyles,r=Pl(e);t=t||"default";var u=n.get(r);if(!u){var m={loading:0,preload:null};if(u=l.querySelector(Jn(r)))m.loading=5;else{e=T({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Yt.get(r))&&To(e,a);var b=u=l.createElement("link");tt(b),it(b,"link",e),b._p=new Promise(function(w,_){b.onload=w,b.onerror=_}),b.addEventListener("load",function(){m.loading|=1}),b.addEventListener("error",function(){m.loading|=2}),m.loading|=4,os(u,t,l)}u={type:"stylesheet",instance:u,count:1,state:m},n.set(r,u)}}}function rg(e,t){pa.X(e,t);var a=Fl;if(a&&e){var l=Sl(a).hoistableScripts,n=en(e),r=l.get(n);r||(r=a.querySelector($n(n)),r||(e=T({src:e,async:!0},t),(t=Yt.get(n))&&Eo(e,t),r=a.createElement("script"),tt(r),it(r,"link",e),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},l.set(n,r))}}function sg(e,t){pa.M(e,t);var a=Fl;if(a&&e){var l=Sl(a).hoistableScripts,n=en(e),r=l.get(n);r||(r=a.querySelector($n(n)),r||(e=T({src:e,async:!0,type:"module"},t),(t=Yt.get(n))&&Eo(e,t),r=a.createElement("script"),tt(r),it(r,"link",e),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},l.set(n,r))}}function jf(e,t,a,l){var n=(n=he.current)?is(n):null;if(!n)throw Error(c(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Pl(a.href),a=Sl(n).hoistableStyles,l=a.get(t),l||(l={type:"style",instance:null,count:0,state:null},a.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Pl(a.href);var r=Sl(n).hoistableStyles,u=r.get(e);if(u||(n=n.ownerDocument||n,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(e,u),(r=n.querySelector(Jn(e)))&&!r._p&&(u.instance=r,u.state.loading=5),Yt.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Yt.set(e,a),r||ig(n,e,a,u.state))),t&&l===null)throw Error(c(528,""));return u}if(t&&l!==null)throw Error(c(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=en(a),a=Sl(n).hoistableScripts,l=a.get(t),l||(l={type:"script",instance:null,count:0,state:null},a.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(c(444,e))}}function Pl(e){return'href="'+zt(e)+'"'}function Jn(e){return'link[rel="stylesheet"]['+e+"]"}function kf(e){return T({},e,{"data-precedence":e.precedence,precedence:null})}function ig(e,t,a,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),it(t,"link",a),tt(t),e.head.appendChild(t))}function en(e){return'[src="'+zt(e)+'"]'}function $n(e){return"script[async]"+e}function Nf(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+zt(a.href)+'"]');if(l)return t.instance=l,tt(l),l;var n=T({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),tt(l),it(l,"style",n),os(l,a.precedence,e),t.instance=l;case"stylesheet":n=Pl(a.href);var r=e.querySelector(Jn(n));if(r)return t.state.loading|=4,t.instance=r,tt(r),r;l=kf(a),(n=Yt.get(n))&&To(l,n),r=(e.ownerDocument||e).createElement("link"),tt(r);var u=r;return u._p=new Promise(function(m,b){u.onload=m,u.onerror=b}),it(r,"link",l),t.state.loading|=4,os(r,a.precedence,e),t.instance=r;case"script":return r=en(a.src),(n=e.querySelector($n(r)))?(t.instance=n,tt(n),n):(l=a,(n=Yt.get(r))&&(l=T({},a),Eo(l,n)),e=e.ownerDocument||e,n=e.createElement("script"),tt(n),it(n,"link",l),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(c(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,os(l,a.precedence,e));return t.instance}function os(e,t,a){for(var l=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=l.length?l[l.length-1]:null,r=n,u=0;u<l.length;u++){var m=l[u];if(m.dataset.precedence===t)r=m;else if(r!==n)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function To(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Eo(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var cs=null;function wf(e,t,a){if(cs===null){var l=new Map,n=cs=new Map;n.set(a,l)}else n=cs,l=n.get(a),l||(l=new Map,n.set(a,l));if(l.has(e))return l;for(l.set(e,null),a=a.getElementsByTagName(e),n=0;n<a.length;n++){var r=a[n];if(!(r[fn]||r[lt]||e==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var u=r.getAttribute(t)||"";u=e+u;var m=l.get(u);m?m.push(r):l.set(u,[r])}}return l}function Cf(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function og(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Tf(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function cg(e,t,a,l){if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var n=Pl(l.href),r=t.querySelector(Jn(n));if(r){t=r._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=us.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=r,tt(r);return}r=t.ownerDocument||t,l=kf(l),(n=Yt.get(n))&&To(l,n),r=r.createElement("link"),tt(r);var u=r;u._p=new Promise(function(m,b){u.onload=m,u.onerror=b}),it(r,"link",l),a.instance=r}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=us.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Ao=0;function ug(e,t){return e.stylesheets&&e.count===0&&fs(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var l=setTimeout(function(){if(e.stylesheets&&fs(e,e.stylesheets),e.unsuspend){var r=e.unsuspend;e.unsuspend=null,r()}},6e4+t);0<e.imgBytes&&Ao===0&&(Ao=62500*Xm());var n=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&fs(e,e.stylesheets),e.unsuspend)){var r=e.unsuspend;e.unsuspend=null,r()}},(e.imgBytes>Ao?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(n)}}:null}function us(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fs(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ds=null;function fs(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ds=new Map,t.forEach(dg,e),ds=null,us.call(e))}function dg(e,t){if(!(t.state.loading&4)){var a=ds.get(e);if(a)var l=a.get(null);else{a=new Map,ds.set(e,a);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<n.length;r++){var u=n[r];(u.nodeName==="LINK"||u.getAttribute("media")!=="not all")&&(a.set(u.dataset.precedence,u),l=u)}l&&a.set(null,l)}n=t.instance,u=n.getAttribute("data-precedence"),r=a.get(u)||l,r===l&&a.set(null,n),a.set(u,n),this.count++,l=us.bind(this),n.addEventListener("load",l),n.addEventListener("error",l),r?r.parentNode.insertBefore(n,r.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(n,e.firstChild)),t.state.loading|=4}}var Wn={$$typeof:Q,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function fg(e,t,a,l,n,r,u,m,b){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ks(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ks(0),this.hiddenUpdates=ks(null),this.identifierPrefix=l,this.onUncaughtError=n,this.onCaughtError=r,this.onRecoverableError=u,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=b,this.incompleteTransitions=new Map}function Ef(e,t,a,l,n,r,u,m,b,w,_,H){return e=new fg(e,t,a,u,b,w,_,H,m),t=1,r===!0&&(t|=24),r=jt(3,null,null,t),e.current=r,r.stateNode=e,t=ii(),t.refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:l,isDehydrated:a,cache:t},di(r),e}function Af(e){return e?(e=Rl,e):Rl}function Mf(e,t,a,l,n,r){n=Af(n),l.context===null?l.context=n:l.pendingContext=n,l=za(t),l.payload={element:a},r=r===void 0?null:r,r!==null&&(l.callback=r),a=_a(e,l,t),a!==null&&(pt(a,e,t),An(a,e,t))}function Rf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Mo(e,t){Rf(e,t),(e=e.alternate)&&Rf(e,t)}function Of(e){if(e.tag===13||e.tag===31){var t=ll(e,67108864);t!==null&&pt(t,e,67108864),Mo(e,67108864)}}function zf(e){if(e.tag===13||e.tag===31){var t=Tt();t=Ns(t);var a=ll(e,t);a!==null&&pt(a,e,t),Mo(e,t)}}var ms=!0;function mg(e,t,a,l){var n=E.T;E.T=null;var r=L.p;try{L.p=2,Ro(e,t,a,l)}finally{L.p=r,E.T=n}}function gg(e,t,a,l){var n=E.T;E.T=null;var r=L.p;try{L.p=8,Ro(e,t,a,l)}finally{L.p=r,E.T=n}}function Ro(e,t,a,l){if(ms){var n=Oo(l);if(n===null)xo(e,t,l,gs,a),Uf(e,l);else if(yg(n,e,t,a,l))l.stopPropagation();else if(Uf(e,l),t&4&&-1<hg.indexOf(e)){for(;n!==null;){var r=vl(n);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var u=Fa(r.pendingLanes);if(u!==0){var m=r;for(m.pendingLanes|=2,m.entangledLanes|=2;u;){var b=1<<31-vt(u);m.entanglements[1]|=b,u&=~b}$t(r),(Re&6)===0&&($r=$()+500,Kn(0))}}break;case 31:case 13:m=ll(r,2),m!==null&&pt(m,r,2),Fr(),Mo(r,2)}if(r=Oo(l),r===null&&xo(e,t,l,gs,a),r===n)break;n=r}n!==null&&l.stopPropagation()}else xo(e,t,l,null,a)}}function Oo(e){return e=zs(e),zo(e)}var gs=null;function zo(e){if(gs=null,e=bl(e),e!==null){var t=f(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=h(t),e!==null)return e;e=null}else if(a===31){if(e=g(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return gs=e,null}function _f(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ve()){case le:return 2;case fe:return 8;case Oe:case Ke:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var _o=!1,Ka=null,Qa=null,Ia=null,Fn=new Map,Pn=new Map,Za=[],hg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Uf(e,t){switch(e){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":Qa=null;break;case"mouseover":case"mouseout":Ia=null;break;case"pointerover":case"pointerout":Fn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pn.delete(t.pointerId)}}function er(e,t,a,l,n,r){return e===null||e.nativeEvent!==r?(e={blockedOn:t,domEventName:a,eventSystemFlags:l,nativeEvent:r,targetContainers:[n]},t!==null&&(t=vl(t),t!==null&&Of(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function yg(e,t,a,l,n){switch(t){case"focusin":return Ka=er(Ka,e,t,a,l,n),!0;case"dragenter":return Qa=er(Qa,e,t,a,l,n),!0;case"mouseover":return Ia=er(Ia,e,t,a,l,n),!0;case"pointerover":var r=n.pointerId;return Fn.set(r,er(Fn.get(r)||null,e,t,a,l,n)),!0;case"gotpointercapture":return r=n.pointerId,Pn.set(r,er(Pn.get(r)||null,e,t,a,l,n)),!0}return!1}function Df(e){var t=bl(e.target);if(t!==null){var a=f(t);if(a!==null){if(t=a.tag,t===13){if(t=h(a),t!==null){e.blockedOn=t,Jo(e.priority,function(){zf(a)});return}}else if(t===31){if(t=g(a),t!==null){e.blockedOn=t,Jo(e.priority,function(){zf(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=Oo(e.nativeEvent);if(a===null){a=e.nativeEvent;var l=new a.constructor(a.type,a);Os=l,a.target.dispatchEvent(l),Os=null}else return t=vl(a),t!==null&&Of(t),e.blockedOn=a,!1;t.shift()}return!0}function Hf(e,t,a){hs(e)&&a.delete(t)}function xg(){_o=!1,Ka!==null&&hs(Ka)&&(Ka=null),Qa!==null&&hs(Qa)&&(Qa=null),Ia!==null&&hs(Ia)&&(Ia=null),Fn.forEach(Hf),Pn.forEach(Hf)}function ys(e,t){e.blockedOn===t&&(e.blockedOn=null,_o||(_o=!0,x.unstable_scheduleCallback(x.unstable_NormalPriority,xg)))}var xs=null;function Lf(e){xs!==e&&(xs=e,x.unstable_scheduleCallback(x.unstable_NormalPriority,function(){xs===e&&(xs=null);for(var t=0;t<e.length;t+=3){var a=e[t],l=e[t+1],n=e[t+2];if(typeof l!="function"){if(zo(l||a)===null)continue;break}var r=vl(a);r!==null&&(e.splice(t,3),t-=3,Ri(r,{pending:!0,data:n,method:a.method,action:l},l,n))}}))}function tn(e){function t(b){return ys(b,e)}Ka!==null&&ys(Ka,e),Qa!==null&&ys(Qa,e),Ia!==null&&ys(Ia,e),Fn.forEach(t),Pn.forEach(t);for(var a=0;a<Za.length;a++){var l=Za[a];l.blockedOn===e&&(l.blockedOn=null)}for(;0<Za.length&&(a=Za[0],a.blockedOn===null);)Df(a),a.blockedOn===null&&Za.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(l=0;l<a.length;l+=3){var n=a[l],r=a[l+1],u=n[ft]||null;if(typeof r=="function")u||Lf(a);else if(u){var m=null;if(r&&r.hasAttribute("formAction")){if(n=r,u=r[ft]||null)m=u.formAction;else if(zo(n)!==null)continue}else m=u.action;typeof m=="function"?a[l+1]=m:(a.splice(l,3),l-=3),Lf(a)}}}function Gf(){function e(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(u){return n=u})},focusReset:"manual",scroll:"manual"})}function t(){n!==null&&(n(),n=null),l||setTimeout(a,20)}function a(){if(!l&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,n=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),n!==null&&(n(),n=null)}}}function Uo(e){this._internalRoot=e}ps.prototype.render=Uo.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(c(409));var a=t.current,l=Tt();Mf(a,l,e,t,null,null)},ps.prototype.unmount=Uo.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Mf(e.current,2,null,e,null,null),Fr(),t[pl]=null}};function ps(e){this._internalRoot=e}ps.prototype.unstable_scheduleHydration=function(e){if(e){var t=Zo();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Za.length&&t!==0&&t<Za[a].priority;a++);Za.splice(a,0,e),a===0&&Df(e)}};var Bf=i.version;if(Bf!=="19.2.0")throw Error(c(527,Bf,"19.2.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(c(188)):(e=Object.keys(e).join(","),Error(c(268,e)));return e=y(t),e=e!==null?j(e):null,e=e===null?null:e.stateNode,e};var pg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:E,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bs.isDisabled&&bs.supportsFiber)try{cn=bs.inject(pg),bt=bs}catch{}}return ar.createRoot=function(e,t){if(!d(e))throw Error(c(299));var a=!1,l="",n=Qu,r=Iu,u=Zu;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(n=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(u=t.onRecoverableError)),t=Ef(e,1,!1,null,null,a,l,null,n,r,u,Gf),e[pl]=t.current,yo(e),new Uo(t)},ar.hydrateRoot=function(e,t,a){if(!d(e))throw Error(c(299));var l=!1,n="",r=Qu,u=Iu,m=Zu,b=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(n=a.identifierPrefix),a.onUncaughtError!==void 0&&(r=a.onUncaughtError),a.onCaughtError!==void 0&&(u=a.onCaughtError),a.onRecoverableError!==void 0&&(m=a.onRecoverableError),a.formState!==void 0&&(b=a.formState)),t=Ef(e,1,!0,t,a??null,l,n,b,r,u,m,Gf),t.context=Af(null),a=t.current,l=Tt(),l=Ns(l),n=za(l),n.callback=null,_a(a,n,l),a=l,t.current.lanes=a,dn(t,a),$t(t),e[pl]=t.current,yo(e),new ps(t)},ar.version="19.2.0",ar}var $f;function Mg(){if($f)return Lo.exports;$f=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(i){console.error(i)}}return x(),Lo.exports=Ag(),Lo.exports}var Rg=Mg();const Og=({imageUrl:x,altText:i,isLoading:o=!1,error:c=null,onRetry:d,className:f="",fallbackImageUrl:h})=>{const[g,p]=A.useState(!1),[y,j]=A.useState(!1),[T,z]=A.useState(null);A.useEffect(()=>{p(!1),j(!1),z(null)},[x]);const G=A.useCallback(()=>{j(!0),p(!1),x&&z(x)},[x]),B=A.useCallback(()=>{p(!0),j(!1)},[]),q=A.useCallback(()=>{p(!1),j(!1),d&&d()},[d]),I=x||T||h;return o?s.jsx("div",{className:`relative bg-gray-100 rounded-lg overflow-hidden ${f}`,children:s.jsx("div",{className:"aspect-video w-full",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("svg",{className:"animate-spin h-8 w-8 text-blue-600 mx-auto mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Generating image..."})]})})})}):c&&!I?s.jsx("div",{className:`relative bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg ${f}`,children:s.jsx("div",{className:"aspect-video w-full",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-3",children:s.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Image Generation Failed"}),s.jsx("p",{className:"text-xs text-gray-500 mb-3 max-w-xs",children:c}),d&&s.jsxs("button",{onClick:q,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[s.jsx("svg",{className:"mr-1 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Retry"]})]})})})}):I?s.jsxs("div",{className:`relative rounded-lg overflow-hidden shadow-md ${f}`,children:[!y&&!g&&s.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center z-10",children:s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2 mx-auto"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 mx-auto"})]})})}),s.jsx("img",{src:I,alt:i,className:`w-full h-auto transition-opacity duration-300 ${y?"opacity-100":"opacity-0"}`,onLoad:G,onError:B,loading:"lazy",style:{aspectRatio:"16/9",objectFit:"cover",minHeight:"200px"}}),g&&s.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center p-4",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-10 w-10 rounded-full bg-gray-200 mb-2",children:s.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Failed to load image"}),d&&s.jsx("button",{onClick:q,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Try again"})]})}),y&&i&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-3",children:s.jsx("div",{className:"text-white text-sm opacity-0 hover:opacity-100 transition-opacity duration-200",children:i})})]}):s.jsx("div",{className:`relative bg-gray-50 border border-gray-200 rounded-lg ${f}`,children:s.jsx("div",{className:"aspect-video w-full",children:s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-gray-400",children:[s.jsx("svg",{className:"h-12 w-12 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("div",{className:"text-sm",children:"No image available"})]})})})})},zg={temperature:.7,minP:.05,repetitionPenalty:1.1,enableStreaming:!0},lr=({settings:x,onSettingsChange:i,onClose:o})=>{const[c,d]=A.useState(x),f=(p,y)=>{d(j=>({...j,[p]:y}))},h=()=>{i(c),o()},g=()=>{d(zg)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Sampler Settings"}),s.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-2xl font-bold","aria-label":"Close",children:""})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Temperature"}),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.temperature.toFixed(2)})]}),s.jsx("input",{type:"range",min:"0",max:"2",step:"0.01",value:c.temperature,onChange:p=>f("temperature",parseFloat(p.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Controls randomness. Lower = more focused, Higher = more creative"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Min P"}),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.minP.toFixed(3)})]}),s.jsx("input",{type:"range",min:"0",max:"0.5",step:"0.001",value:c.minP,onChange:p=>f("minP",parseFloat(p.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Minimum probability threshold for token selection"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Repetition Penalty"}),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.repetitionPenalty.toFixed(2)})]}),s.jsx("input",{type:"range",min:"1",max:"2",step:"0.01",value:c.repetitionPenalty,onChange:p=>f("repetitionPenalty",parseFloat(p.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-600"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Reduces repetitive text. Higher = less repetition"})]}),s.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 block mb-1",children:"Enable Text Streaming"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Show text as it's generated character by character"})]}),s.jsx("button",{type:"button",role:"switch","aria-checked":c.enableStreaming??!0,onClick:()=>f("enableStreaming",!(c.enableStreaming??!0)),className:`
                  relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent 
                  transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
                  ${c.enableStreaming??!0?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}
                `,children:s.jsx("span",{"aria-hidden":"true",className:`
                    pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 
                    transition duration-200 ease-in-out
                    ${c.enableStreaming??!0?"translate-x-5":"translate-x-0"}
                  `})})]})})]}),s.jsxs("div",{className:"flex justify-between items-center mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 transition-colors",children:"Reset to Defaults"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors",children:"Cancel"}),s.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 rounded-md transition-colors",children:"Save Changes"})]})]})]})})};class Pt{static CHARS_PER_TOKEN=4;static MAX_TOKENS=8192;static RESERVED_TOKENS=1e3;static MAX_CONTEXT_TOKENS=Pt.MAX_TOKENS-Pt.RESERVED_TOKENS;static estimateTokens(i){return Math.ceil(i.length/this.CHARS_PER_TOKEN)}static truncateToTokenLimit(i,o=this.MAX_CONTEXT_TOKENS){if(this.estimateTokens(i)<=o)return i;const d=o*this.CHARS_PER_TOKEN,f=i.substring(0,d),h=f.lastIndexOf(". ");return h>d*.8?f.substring(0,h+1)+" [truncated]":f+" [truncated]"}static buildTruncatedContext(i,o,c=this.MAX_CONTEXT_TOKENS){let d="",f=0,h=0,g=0;const p=[...i].reverse(),y=[...o].reverse();for(let j=0;j<Math.max(p.length,y.length);j++){let T="",z="";if(j<p.length){const q=p[j],I=q.text.length>300?q.text.substring(0,300)+"...":q.text;T=`Story ${i.length-j}: ${I}
`}if(j<y.length){const q=y[j];z=`Action ${o.length-j}: ${q.text}
`}const G=T+z,B=this.estimateTokens(G);if(f+B>c)break;d=G+d,f+=B,T&&h++,z&&g++}return{contextText:d,segmentsIncluded:h,choicesIncluded:g}}static buildEnhancedContext(i,o,c,d=this.MAX_CONTEXT_TOKENS){let f=null,h=null;if(i.length>0){const z=i[i.length-1];f=z.text.length>500?z.text.substring(0,500)+"...":z.text}o.length>0&&(h=o[o.length-1].text);const g=this.estimateTokens(`Previous segment: ${f||""}
Previous action: ${h||""}
Current scene: ${c}`),p=d-g,{contextText:y,segmentsIncluded:j,choicesIncluded:T}=this.buildTruncatedContext(i.slice(0,-1),o.slice(0,-1),p);return{contextText:y,previousSegment:f,previousAction:h,segmentsIncluded:j+(f?1:0),choicesIncluded:T+(h?1:0)}}static validatePromptSize(i){const o=this.estimateTokens(i);return{valid:o<=this.MAX_CONTEXT_TOKENS,estimatedTokens:o,maxTokens:this.MAX_CONTEXT_TOKENS}}static getTokenStats(i){const o=this.estimateTokens(i),c=this.MAX_CONTEXT_TOKENS-o,d=Math.round(o/this.MAX_CONTEXT_TOKENS*100);return{estimatedTokens:o,characters:i.length,maxTokens:this.MAX_CONTEXT_TOKENS,remainingTokens:Math.max(0,c),utilizationPercent:d}}}const Ff=({thinkingContent:x,className:i="",isStreaming:o=!1})=>{const[c,d]=A.useState(!1),f=A.useRef(null),h=A.useRef(0),[g,p]=A.useState(!1),y=A.useRef(null),j=A.useRef(!1),T=A.useRef(0),z=A.useRef(null),G=A.useRef(0),B=A.useRef(0),q=A.useRef(null),[I,ue]=A.useState(!0),oe=()=>{if(!f.current||!o||j.current)return;const Q=f.current,W=Q.scrollTop,je=Date.now(),be=Q.scrollHeight-Q.scrollTop<=Q.clientHeight+10,V=je-B.current,R=W-T.current;V>0&&(G.current=Math.abs(R)/V),R<-5&&G.current>.1&&!be?(p(!0),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{f.current&&(f.current.scrollHeight-f.current.scrollTop>f.current.clientHeight+10||p(!1))},3e3)):be&&!j.current&&(p(!1),y.current&&(clearTimeout(y.current),y.current=null)),T.current=W,B.current=je};return A.useEffect(()=>{if(c&&o&&f.current&&!g){const Q=x.length;if(Q>h.current){const W=f.current;W.scrollHeight-W.scrollTop<=W.clientHeight+100&&I&&(j.current=!0,requestAnimationFrame(()=>{W&&!g&&o&&(W.scrollTop=W.scrollHeight),setTimeout(()=>{j.current=!1},16)}))}h.current=Q}},[x,c,o,g,I]),A.useEffect(()=>{if(c&&o&&f.current&&!g){const Q=f.current,W=Q.querySelector("pre");W&&(q.current=new MutationObserver(()=>{!g&&o&&Q&&Q.scrollHeight-Q.scrollTop<=Q.clientHeight+50&&I&&(j.current=!0,Q.scrollTop=Q.scrollHeight,setTimeout(()=>{j.current=!1},10))}),q.current.observe(W,{childList:!0,subtree:!0,characterData:!0}))}else q.current&&(q.current.disconnect(),q.current=null);return()=>{q.current&&(q.current.disconnect(),q.current=null)}},[c,o,g,I]),A.useEffect(()=>{if(f.current){const Q=new IntersectionObserver(([W])=>{ue(W.isIntersecting)},{threshold:.1});return Q.observe(f.current),()=>{Q.disconnect()}}},[c]),A.useEffect(()=>{o||(h.current=0,p(!1),j.current=!1,T.current=0,G.current=0,B.current=0,y.current&&(clearTimeout(y.current),y.current=null),z.current&&(clearTimeout(z.current),z.current=null),q.current&&(q.current.disconnect(),q.current=null))},[o]),A.useEffect(()=>()=>{y.current&&clearTimeout(y.current),z.current&&clearTimeout(z.current),q.current&&q.current.disconnect()},[]),x.trim()?s.jsxs("div",{className:`bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg ${i}`,children:[s.jsxs("button",{onClick:()=>d(!c),className:"w-full px-4 py-3 text-left flex items-center justify-between text-blue-700 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-4 w-4 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),s.jsx("span",{className:"text-sm font-medium",children:"AI Thinking Process"}),s.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/50 px-2 py-0.5 rounded-full",children:["~",Pt.estimateTokens(x)," tokens"]})]}),s.jsx("svg",{className:`h-4 w-4 transform transition-transform ${c?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&s.jsxs("div",{className:"px-4 pb-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{ref:f,onScroll:oe,className:"bg-white dark:bg-gray-800 rounded border border-blue-200 dark:border-blue-700 p-3 max-h-64 overflow-y-auto scroll-smooth",children:s.jsxs("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono leading-relaxed",children:[x,o&&s.jsx("span",{className:"inline-block w-1 h-3 bg-blue-500 dark:bg-blue-400 ml-1 animate-pulse"})]})}),g&&o&&f.current&&f.current.scrollHeight-f.current.scrollTop>f.current.clientHeight+20&&s.jsxs("button",{onClick:()=>{f.current&&(j.current=!0,f.current.scrollTop=f.current.scrollHeight,p(!1),y.current&&(clearTimeout(y.current),y.current=null),setTimeout(()=>{j.current=!1},50))},className:"absolute bottom-2 right-2 bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded-full shadow-lg transition-colors flex items-center gap-1",title:"Scroll to bottom",children:[s.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),s.jsx("span",{children:"Follow"})]})]}),s.jsx("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400 flex items-center justify-between",children:s.jsx("span",{children:"This shows the AI's internal reasoning process before generating the story response."})})]})]}):null},Ss=({text:x,className:i=""})=>{const o=f=>{const h=[];let g=0;const p=f.split(`
`);for(let y=0;y<p.length;y++){const j=p[y];if(j.trim()===""){y<p.length-1&&h.push(s.jsx("br",{},`br-${g++}`));continue}const T=c(j,g);h.push(...T.elements),g=T.nextKey,y<p.length-1&&h.push(s.jsx("br",{},`br-${g++}`))}return h},c=(f,h)=>{const g=[];let p=h;const y=f.replace(/[]/g,'"'),j=[{regex:/\*\*(.*?)\*\*/g,type:"bold"},{regex:/__(.*?)__/g,type:"bold"},{regex:/\*(.*?)\*/g,type:"italic"},{regex:/_(.*?)_/g,type:"italic"},{regex:/(?:^|[\s.,!?;:])"([^"]*?)"(?=[\s.,!?;:]|$)/g,type:"quote"}],T=[];j.forEach(B=>{let q;const I=new RegExp(B.regex.source,B.regex.flags);for(;(q=I.exec(y))!==null;)T.push({start:q.index,end:q.index+q[0].length,content:q[1],type:B.type,fullMatch:q[0]})}),T.sort((B,q)=>B.start-q.start);const z=[];for(const B of T)z.some(I=>B.start<I.end&&B.end>I.start)||z.push(B);let G=0;for(const B of z){if(B.start>G){const I=y.substring(G,B.start);I&&g.push(s.jsx("span",{children:I},`text-${p++}`))}const q=B.content;switch(B.type){case"bold":g.push(s.jsx("strong",{className:"font-semibold",children:q},`bold-${p++}`));break;case"italic":g.push(s.jsx("em",{className:"italic text-gray-600 dark:text-gray-400",children:q},`italic-${p++}`));break;case"quote":g.push(s.jsxs("span",{className:"text-orange-700 dark:text-orange-400",children:['"',q,'"']},`quote-${p++}`));break}G=B.end}if(G<y.length){const B=y.substring(G);B&&g.push(s.jsx("span",{children:B},`text-${p++}`))}return g.length===0&&g.push(s.jsx("span",{children:y},`text-${p++}`)),{elements:g,nextKey:p}},d=o(x);return s.jsx("span",{className:i,children:d})},_g=({currentStory:x,storyHistory:i,isLoading:o,error:c,onRetry:d,onRegenerate:f,isGeneratingImage:h=!1,imageError:g=null,onImageRetry:p,samplerSettings:y,onSamplerSettingsChange:j,streamingText:T="",isStreaming:z=!1,enableImageGeneration:G=!0,canRegenerate:B=!1,thinkingContent:q="",streamingThinking:I="",onRollback:ue})=>{const[oe,Q]=A.useState(!1),[W,je]=A.useState(new Set),[be,V]=A.useState(!1),R={temperature:.7,minP:.05,repetitionPenalty:1.1},U=Y=>{ue&&ue(Y)};return o&&!z?s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:[s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6 mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}),s.jsx("div",{className:"text-center mt-6",children:s.jsxs("div",{className:"inline-flex items-center text-blue-600 dark:text-blue-400",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600 dark:text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating story..."]})})]}):c?s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Story Generation Failed"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:c}),d&&s.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Try Again"]})]})}):!x&&!z?s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:s.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-gray-100 dark:bg-gray-700 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("p",{children:"No story to display. Start a new adventure to begin!"})]})}):s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[i.length>0&&s.jsxs("button",{onClick:()=>Q(!oe),className:"inline-flex items-center text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:[s.jsx("svg",{className:`mr-1 h-4 w-4 transform transition-transform ${oe?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),oe?"Hide":"Show"," Story History (",i.length,")"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[B&&f&&!o&&!z&&s.jsxs("button",{onClick:f,className:"inline-flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm text-purple-700 dark:text-purple-300 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-700 rounded-md hover:bg-purple-100 dark:hover:bg-purple-900/50 transition-colors",title:"Regenerate this story response with different variations",children:[s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),s.jsx("span",{className:"hidden sm:inline",children:"Regenerate"})]}),j&&s.jsxs("button",{onClick:()=>V(!0),className:"inline-flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Adjust sampler settings",children:[s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),s.jsx("span",{className:"hidden sm:inline",children:"AI Sampler"})]})]})]}),be&&j&&s.jsx(lr,{settings:y||R,onSettingsChange:j,onClose:()=>V(!1)}),oe&&i.length>0&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-4 max-h-96 overflow-y-auto",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Previous Story Segments"}),s.jsx("div",{className:"space-y-4",children:i.map((Y,se)=>{const ie=W.has(Y.id),qe=Y.text.length>200,ae=ie||!qe?Y.text:`${Y.text.substring(0,200)}...`;return s.jsxs("div",{className:"border-l-2 border-gray-300 dark:border-gray-600 pl-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Segment ",se+1]}),se<i.length-1&&ue&&s.jsxs("button",{onClick:()=>U(se),className:"inline-flex items-center gap-1 px-2 py-1 text-xs text-orange-700 dark:text-orange-300 bg-orange-50 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700 rounded hover:bg-orange-100 dark:hover:bg-orange-900/50 transition-colors",title:`Rollback to this segment (will delete ${i.length-1-se} segments)`,children:[s.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Rollback"]})]}),s.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:s.jsx(Ss,{text:ae})}),qe&&s.jsx("button",{onClick:()=>{je(xe=>{const E=new Set(xe);return E.has(Y.id)?E.delete(Y.id):E.add(Y.id),E})},className:"mt-2 text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:ie?"Show less":"Show more"})]},Y.id)})})]}),(q&&q.trim()||I&&I.trim())&&s.jsx(Ff,{thinkingContent:z?I:x?.thinkingContent||q,className:"mb-4",isStreaming:z&&!!I}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 sm:p-6",children:[z&&!T&&s.jsx("div",{className:"text-center py-8",children:s.jsxs("div",{className:"inline-flex items-center text-blue-600 dark:text-blue-400",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600 dark:text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating story..."]})}),(T||x)&&s.jsx("div",{className:"prose prose-sm sm:prose-lg max-w-none",children:s.jsxs("div",{className:"text-gray-800 dark:text-gray-200 leading-relaxed break-words",style:{fontSize:"clamp(0.9rem, 2.5vw, 1.125rem)",lineHeight:"1.75",fontFamily:"Georgia, serif"},children:[s.jsx(Ss,{text:z?T:x?.text||""}),z&&T&&s.jsx("span",{className:"inline-block w-2 h-5 bg-blue-500 dark:bg-blue-400 ml-1 animate-pulse"})]})}),x?.sceneDescription&&!z&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1",children:"Scene"}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:x.sceneDescription})]}),x&&!z&&G&&s.jsx("div",{className:"mt-6",children:s.jsx(Og,{imageUrl:x.imageUrl,altText:x.sceneDescription||"Story scene",isLoading:h,error:g,onRetry:p,className:"w-full"})})]})]})},Ug=({choices:x,choiceHistory:i,isLoading:o,disabled:c=!1,onChoiceSelect:d})=>{const[f,h]=A.useState(null),[g,p]=A.useState(!1),y=A.useCallback(j=>{c||o||(h(j.id),setTimeout(()=>{d(j),h(null)},150))},[c,o,d]);return!x||x.length===0?s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:s.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-gray-100 dark:bg-gray-700 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("p",{children:"No choices available at the moment."})]})}):s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[i.length>0&&s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("button",{onClick:()=>p(!g),className:"inline-flex items-center text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:[s.jsx("svg",{className:`mr-1 h-4 w-4 transform transition-transform ${g?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),g?"Hide":"Show"," Choice History (",i.length,")"]})}),g&&i.length>0&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-4 max-h-64 overflow-y-auto",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Previous Choices"}),s.jsx("div",{className:"space-y-2",children:i.map((j,T)=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center ${j.isCustom?"bg-purple-100 dark:bg-purple-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:s.jsx("span",{className:`text-xs font-medium ${j.isCustom?"text-purple-600 dark:text-purple-400":"text-blue-600 dark:text-blue-400"}`,children:T+1})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[j.isCustom&&s.jsxs("div",{className:"flex items-center mb-1",children:[s.jsx("svg",{className:"h-3 w-3 text-purple-600 dark:text-purple-400 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})}),s.jsx("span",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:"Custom Action"})]}),s.jsx("div",{className:`text-sm leading-relaxed ${j.isCustom?"text-purple-900 dark:text-purple-200":"text-gray-700 dark:text-gray-300"}`,children:s.jsx(Ss,{text:j.text})})]})]},`${j.id}-${T}`))})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 sm:p-6",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 mb-3 sm:mb-4",children:"What do you choose?"}),o&&s.jsx("div",{className:"text-center py-4",children:s.jsxs("div",{className:"inline-flex items-center text-blue-600 dark:text-blue-400 text-sm",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600 dark:text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing your choice..."]})}),s.jsx("div",{className:"space-y-2 sm:space-y-3",children:x.map((j,T)=>{const z=f===j.id,G=c||o;return s.jsx("button",{onClick:()=>y(j),disabled:G,className:`
                  w-full text-left p-3 sm:p-4 rounded-lg border-2 transition-all duration-200 
                  ${z?"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/30 shadow-md transform scale-[0.98]":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 hover:border-blue-300 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20"}
                  ${G?"opacity-50 cursor-not-allowed":"hover:shadow-md cursor-pointer"}
                  focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800
                `,children:s.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3",children:[s.jsxs("div",{className:`
                    flex-shrink-0 w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center font-medium text-xs sm:text-sm
                    ${z?"bg-blue-500 dark:bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300"}
                  `,children:[String.fromCharCode(65+T)," "]}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:`
                      text-xs sm:text-sm leading-relaxed break-words
                      ${z?"text-blue-900 dark:text-blue-200":"text-gray-800 dark:text-gray-200"}
                    `,children:s.jsx(Ss,{text:j.text})})}),z&&s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-500 dark:text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})},j.id)})})]})]})},Dg=({isLoading:x,disabled:i=!1,onActionSubmit:o,choiceHistory:c})=>{const[d,f]=A.useState(""),[h,g]=A.useState(null),[p,y]=A.useState(!1),j=5,T=200,z=A.useCallback(Q=>{const W=Q.trim();return W.length===0?"Please enter an action":W.length<j?`Action must be at least ${j} characters`:W.length>T?`Action must not exceed ${T} characters`:null},[]),G=A.useCallback(Q=>{const W=Q.target.value;W.length<=T&&(f(W),h&&W.trim().length>0&&g(null))},[h]),B=A.useCallback(Q=>{if(Q.preventDefault(),i||x)return;const W=z(d);if(W){g(W);return}o(d.trim()),f(""),g(null)},[d,i,x,o,z]),q=A.useCallback(Q=>{if(Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),!i&&!x&&d.trim().length>0)){const W=z(d);if(W){g(W);return}o(d.trim()),f(""),g(null)}},[i,x,d,z,o]),I=d.length,ue=I>T*.9,oe=I>T;return s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[c.length>0&&s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("button",{onClick:()=>y(!p),className:"inline-flex items-center text-xs sm:text-sm text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 transition-colors",children:[s.jsx("svg",{className:`mr-1 h-4 w-4 transform transition-transform ${p?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),p?"Hide":"Show"," Action History (",c.length,")"]})}),p&&c.length>0&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-4 max-h-64 overflow-y-auto",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Your Actions"}),s.jsx("div",{className:"space-y-2",children:c.map((Q,W)=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:W+1})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:Q.text}),Q.isCustom&&s.jsxs("span",{className:"inline-flex items-center mt-1 text-xs text-purple-600 dark:text-purple-400",children:[s.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"Custom Action"]})]})]},`${Q.id}-${W}`))})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 sm:p-6",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 mb-3 sm:mb-4",children:"What do you do?"}),x&&s.jsx("div",{className:"text-center py-4",children:s.jsxs("div",{className:"inline-flex items-center text-purple-600 dark:text-purple-400 text-sm",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-purple-600 dark:text-purple-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing your action..."]})}),s.jsxs("form",{onSubmit:B,className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("textarea",{value:d,onChange:G,onKeyDown:q,disabled:i||x,placeholder:"Type your action here... (e.g., 'I carefully examine the mysterious door' or 'I call out to see if anyone is nearby')",className:`
                w-full px-3 py-3 sm:px-4 sm:py-3 rounded-lg border-2 transition-all duration-200
                text-sm sm:text-base leading-relaxed
                resize-none
                ${h?"border-red-500 dark:border-red-400 focus:ring-red-500 dark:focus:ring-red-400":"border-gray-300 dark:border-gray-600 focus:ring-purple-500 dark:focus:ring-purple-400"}
                ${i||x?"bg-gray-100 dark:bg-gray-700 cursor-not-allowed opacity-50":"bg-white dark:bg-gray-700 hover:border-purple-300 dark:hover:border-purple-500"}
                text-gray-900 dark:text-gray-100
                placeholder-gray-400 dark:placeholder-gray-500
                focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800
              `,rows:3,maxLength:T}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("div",{children:h&&s.jsxs("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h]})}),s.jsxs("span",{className:`
                text-xs sm:text-sm font-medium
                ${oe?"text-red-600 dark:text-red-400":ue?"text-yellow-600 dark:text-yellow-400":"text-gray-500 dark:text-gray-400"}
              `,children:[I," / ",T]})]})]}),s.jsx("button",{type:"submit",disabled:i||x||d.trim().length===0,className:`
              w-full py-3 px-4 rounded-lg font-medium text-sm sm:text-base
              transition-all duration-200
              ${i||x||d.trim().length===0?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-purple-600 dark:bg-purple-500 text-white hover:bg-purple-700 dark:hover:bg-purple-600 shadow-md hover:shadow-lg transform hover:scale-[1.02] active:scale-[0.98]"}
              focus:outline-none focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-400 focus:ring-offset-2 dark:focus:ring-offset-gray-800
            `,children:x?"Processing...":"Submit Action"})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center flex items-center justify-center",children:[s.jsx("svg",{className:"w-3.5 h-3.5 mr-1.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Tip: Be creative! Describe what your character does, says, or thinks."]}),s.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"Press Enter to submit  Shift+Enter for new line"})]})})]})]})},Hg=({isOpen:x,onClose:i,onConfirm:o,segmentIndex:c,segmentCount:d,choiceCount:f,error:h})=>{if(!x)return null;const g=d-c-1+1,p=f-c;return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:i}),s.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:s.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-6 w-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"ml-3 text-lg font-medium text-gray-900 dark:text-gray-100",children:"Confirm Rollback"})]}),s.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition-colors","aria-label":"Close dialog",children:s.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"mb-4",children:[h&&s.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4 mb-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-1",children:"Rollback Error"}),s.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:h})]})]})}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["You are about to rollback to ",s.jsxs("strong",{children:["Segment ",c+1]}),". This action cannot be undone."]}),s.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-md p-4 mb-4",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("h4",{className:"text-sm font-medium text-amber-800 dark:text-amber-200 mb-2",children:"The following data will be permanently deleted:"}),s.jsxs("ul",{className:"text-sm text-amber-700 dark:text-amber-300 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:g})," story segment",g!==1?"s":""]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:p})," choice",p!==1?"s":""," made after this point"]})]})]})]})}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["After rollback, you will return to Segment ",c+1," and can continue your story from that point with different choices."]})]})}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 px-6 py-4 bg-gray-50 dark:bg-gray-700 rounded-b-lg",children:[s.jsx("button",{onClick:i,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:o,disabled:!!h,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 dark:bg-red-500 hover:bg-red-700 dark:hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-red-600 dark:disabled:hover:bg-red-500",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.334 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z"})}),"Confirm Rollback"]})]})]})})]})};class yl{static parseThinkingResponse(i){const o=/<think>(.*?)<\/think>/is,c=i.match(o);if(c){const h=c[1].trim(),g=i.replace(o,"").trim();return{thinkingContent:h,cleanedResponse:g,hasThinking:!0}}const d=/<think>(.*?)$/is,f=i.match(d);if(f){const h=f[1].trim();let p=i.substring(0,i.indexOf("<think>")).trim();if(!p&&h){const y=this.extractStoryFromThinking(h);y&&(p=y)}return{thinkingContent:h,cleanedResponse:p,hasThinking:!0}}return i.includes("</think>")?{thinkingContent:"",cleanedResponse:i.replace(/<\/think>/gi,"").trim(),hasThinking:!1}:{thinkingContent:"",cleanedResponse:i,hasThinking:!1}}static createStreamingProcessor(){let i="",o="",c=!1,d=!1;return{processChunk:f=>{i+=f;let h="",g="";if(d)h=f;else{if(!c&&i.includes("<think>")){const p=i.indexOf("<think>");p>0&&(h=i.substring(0,p),i=i.substring(p)),c=!0,i=i.replace("<think>","")}if(c)if(i.includes("</think>")){const p=i.indexOf("</think>"),y=i.substring(0,p);o+=y,g=y,i=i.substring(p+8),h=i,i="",c=!1,d=!0}else o+=i,g=i,i="";else h=i,i=""}return{displayChunk:h,thinkingChunk:g,thinkingComplete:d,fullThinkingContent:o}},getState:()=>({thinkingContent:o,isInThinkingBlock:c,thinkingComplete:d}),reset:()=>{i="",o="",c=!1,d=!1}}}static extractStoryFromThinking(i){const o=[/STORY:\s*(.*?)$/is,/(?:^|\n)\s*You\s+(?:are|find|see|hear|feel|walk|run|stand|sit|look)\s+.*$/im,/(?:^|\n)\s*The\s+.*$/im,/(?:^|\n)\s*A\s+.*$/im,/(?:^|\n)\s*As\s+you\s+.*$/im,/(?:^|\n)\s*Your\s+.*$/im];for(const d of o){const f=i.match(d);if(f&&f[1]){const h=f[1].trim();if(h.length>50)return h}else if(f&&f[0]){const h=f[0].trim();if(h.length>50)return h}}const c=i.split(/[.!?]+/).filter(d=>d.trim().length>20);if(c.length>0){const d=c.slice(-2).join(". ").trim();if(d.length>50&&(d.includes("You ")||d.includes("The ")||d.includes("A ")))return d+"."}return""}static validateThinkingTags(i){const o=[],c=(i.match(/<think>/gi)||[]).length,d=(i.match(/<\/think>/gi)||[]).length;c!==d&&o.push(`Mismatched thinking tags: ${c} opening, ${d} closing`);const f=i.match(/<think>.*?<\/think>/gis)||[];for(const h of f)if((h.match(/<think>/gi)||[]).length>1){o.push("Nested thinking tags detected");break}return{isValid:o.length===0,errors:o}}static cleanupMalformedTags(i){let o=i;const c=[...o.matchAll(/<think>/gi)],d=[...o.matchAll(/<\/think>/gi)];if(c.length>d.length){const f=c.length-d.length;for(let h=0;h<f;h++){const g=o.lastIndexOf("<think>");g!==-1&&(o=o.substring(0,g)+o.substring(g+7))}}if(d.length>c.length){const f=d.length-c.length;for(let h=0;h<f;h++){const g=o.indexOf("</think>");g!==-1&&(o=o.substring(0,g)+o.substring(g+8))}}return o}}class te extends Error{code;retryable;statusCode;constructor(i,o,c=!0,d){super(i),this.name="AIServiceError",this.code=o,this.retryable=c,this.statusCode=d}}class we{static MAX_RETRIES=3;static isAnthropicAPI(i){return i.includes("api.anthropic.com")}static transformUrlForProxy(i,o){if(this.isAnthropicAPI(i))return`/api/anthropic${o}`;if(i.includes("api.openai.com"))return`/api/openai${o}`;const c=i.endsWith("/")?i.slice(0,-1):i;if(c.endsWith("/v1")&&o.startsWith("/v1/")){const f=o.substring(3);return`${c}${f}`}const d=o.startsWith("/")?o:`/${o}`;return`${c}${d}`}static convertToAnthropicMessages(i){const o=i.find(d=>d.role==="system"),c=i.filter(d=>d.role!=="system");return{system:o?.content,messages:c.map(d=>({role:d.role,content:d.content}))}}static getHeaders(i,o){const c={"Content-Type":"application/json","User-Agent":"AI-CYOA-Game/1.0"};return o.includes("api.anthropic.com")?(c["x-api-key"]=i.apiKey,c["anthropic-version"]="2023-06-01"):c.Authorization=`Bearer ${i.apiKey}`,c}static async chatCompletionStream(i,o,c,d={}){const f=this.isAnthropicAPI(i.baseUrl),h=f?"/v1/messages":"/v1/chat/completions",g=this.transformUrlForProxy(i.baseUrl,h),p=this.getHeaders(i,i.baseUrl);p.Accept="text/event-stream";let y;if(f){const{system:j,messages:T}=this.convertToAnthropicMessages(o);y={model:i.model,messages:T,max_tokens:d.maxTokens??1e3,temperature:d.temperature??.7,stream:!0},j&&(y.system=j)}else y={model:i.model,messages:o,stream:!0,temperature:d.temperature??.7,max_tokens:d.maxTokens??1e3,top_p:1,frequency_penalty:0,presence_penalty:0};try{const j=await fetch(g,{method:"POST",headers:p,body:JSON.stringify(y)});if(!j.ok)throw await this.handleErrorResponse(j);if(!j.body)throw new te("No response body received","API_ERROR");const T=j.body.getReader(),z=new TextDecoder;let G="",B="";const q=yl.createStreamingProcessor();for(;;){const{done:ue,value:oe}=await T.read();if(ue)break;B+=z.decode(oe,{stream:!0});const Q=B.split(`
`);B=Q.pop()||"";for(const W of Q){const je=W.trim();if(!(!je||je==="data: [DONE]")&&je.startsWith("data: "))try{const be=je.slice(6),V=JSON.parse(be);let R="";if(f)V.type==="content_block_delta"&&V.delta?.text&&(R=V.delta.text);else{const U=V.choices?.[0]?.delta?.content;U&&(R=U)}if(R){G+=R;const U=q.processChunk(R);U.thinkingChunk&&d.onThinkingChunk&&d.onThinkingChunk(U.thinkingChunk),U.displayChunk&&c(U.displayChunk)}}catch{}}}const{thinkingContent:I}=q.getState();return{response:G,thinkingContent:I}}catch(j){if(j instanceof te)throw j;if(j instanceof TypeError&&j.message.includes("fetch"))throw new te("Network error: Unable to connect to AI service","NETWORK_ERROR");const T=j instanceof Error?j.message:"Unknown error";throw new te(`Unexpected error: ${T}`,"API_ERROR")}}static async chatCompletion(i,o,c={}){const d=this.isAnthropicAPI(i.baseUrl),f=d?"/v1/messages":"/v1/chat/completions",h=this.transformUrlForProxy(i.baseUrl,f),g=this.getHeaders(i,i.baseUrl);g.Accept="application/json";let p;if(d){const{system:y,messages:j}=this.convertToAnthropicMessages(o);p={model:i.model,messages:j,max_tokens:c.maxTokens??1e3,temperature:c.temperature??.7},y&&(p.system=y)}else p={model:i.model,messages:o,stream:c.stream??!1,temperature:c.temperature??.7,max_tokens:c.maxTokens??1e3,top_p:1,frequency_penalty:0,presence_penalty:0,cache_control:{enabled:!1,ttl:"5m"}};try{const y=await fetch(h,{method:"POST",headers:g,body:JSON.stringify(p)});if(!y.ok)throw await this.handleErrorResponse(y);const j=await y.json();if(j&&typeof j=="object"&&"error"in j){const G=j.error;let B="API returned an error";if(G&&typeof G=="object"){const q=["message","detail","description","error"];for(const I of q)if(I in G&&typeof G[I]=="string"){B=G[I];break}if(B==="API returned an error")try{B=`API error: ${JSON.stringify(G)}`}catch{B="API returned an unreadable error"}}else typeof G=="string"&&(B=G);throw new te(B,"API_ERROR")}const T=this.parseChatCompletionResponse(j,d),{cleanedResponse:z}=yl.parseThinkingResponse(T);return z}catch(y){if(y instanceof te)throw y;if(y instanceof TypeError&&y.message.includes("fetch"))throw new te("Network error: Unable to connect to AI service","NETWORK_ERROR");if(y instanceof Error&&y.name==="AbortError")throw new te("Request timeout: AI service took too long to respond","TIMEOUT_ERROR");const j=y instanceof Error?y.message:"Unknown error";throw new te(`Unexpected error: ${j}`,"API_ERROR")}}static async chatCompletionWithRetry(i,o,c={}){const d=c.maxRetries??this.MAX_RETRIES;let f;for(let h=1;h<=d;h++)try{return await this.chatCompletion(i,o,c)}catch(g){const p=g instanceof Error?g.message:"Unknown error";if(f=g instanceof te?g:new te(`Attempt ${h} failed: ${p}`,"API_ERROR"),!f.retryable)throw f;if(h===d)break;await this.delay(Math.pow(2,h-1)*1e3)}throw f}static async testConnection(i){try{const o=[{role:"user",content:"Hello"}];return await this.chatCompletion(i,o,{maxTokens:10}),{success:!0}}catch(o){return{success:!1,error:o instanceof te?o.message:"Unknown connection error"}}}static async handleErrorResponse(i){let o=`HTTP ${i.status}: ${i.statusText}`,c="API_ERROR",d=!0;try{const f=await i.json();f.error?.message&&(o=f.error.message)}catch{}switch(i.status){case 401:c="AUTH_ERROR",d=!1,o="Invalid API key or unauthorized access";break;case 403:c="AUTH_ERROR",d=!1,o="Access forbidden - check your API key permissions";break;case 404:c="API_ERROR",d=!1,o="API endpoint not found - check your base URL";break;case 429:c="API_ERROR",d=!0,o="Rate limit exceeded - please try again later";break;case 500:case 502:case 503:case 504:c="API_ERROR",d=!0,o="Server error - please try again later";break}return new te(o,c,d,i.status)}static parseChatCompletionResponse(i,o=!1){try{if(o){if(!i||typeof i!="object"||!("content"in i)||!Array.isArray(i.content))throw new Error("Invalid Anthropic response format: expected content array");const g=i.content;if(g.length===0)throw new Error("No content blocks returned from Anthropic");let p="";for(const y of g)y&&typeof y=="object"&&"text"in y&&typeof y.text=="string"&&(p+=y.text);if(!p)throw new Error("No text content found in Anthropic response");return p.trim()}if(!i||typeof i!="object"||!("choices"in i)||!Array.isArray(i.choices)){if(i&&typeof i=="object"&&"content"in i&&typeof i.content=="string")return i.content.trim();if(typeof i=="string")return i.trim();if(i&&typeof i=="object"){const g=this.extractTextFromUnknownFormat(i);if(g)return g.trim()}throw new Error(`Invalid response format: expected choices array. Got: ${typeof i}`)}const c=i.choices;if(c.length===0)throw new Error("No choices returned from AI service");const d=c[0];if(!d||typeof d!="object"||!("message"in d))throw new Error("Invalid choice format: expected message object");const f=d.message;if(!f||typeof f!="object"||!("content"in f))throw new Error("Invalid message format: expected content string");const h=f.content;if(typeof h!="string")throw new Error("Invalid content format: expected string");return h.trim()}catch(c){const d=c instanceof Error?c.message:"Unknown parsing error";throw new te(`Failed to parse AI response: ${d}`,"PARSE_ERROR",!1)}}static extractTextFromUnknownFormat(i){if(!i||typeof i!="object")return null;const o=i,c=["text","content","message","response","output","result"];for(const d of c)if(d in o&&typeof o[d]=="string")return o[d];for(const d of Object.values(o))if(d&&typeof d=="object"){const f=this.extractTextFromUnknownFormat(d);if(f)return f}return null}static delay(i){return new Promise(o=>setTimeout(o,i))}static createSystemMessage(i){return{role:"system",content:i}}static createUserMessage(i){return{role:"user",content:i}}static createAssistantMessage(i){return{role:"assistant",content:i}}}class Wt{static STORY_SYSTEM_PROMPT=`You are a creative storyteller for an interactive Choose Your Own Adventure game. Your role is to:

1. Create engaging, immersive narratives with vivid descriptions
2. Maintain narrative continuity and consistency
3. Keep responses SHORT, CONCISE, but descriptive (2 paragraphs max)
4. Always end with a clear situation that requires a decision
5. NEVER include choices or options in the STORY section

Guidelines:
- Write in second person ("You...")
- Each story segment should advance the plot meaningfully
- The STORY section should contain ONLY narrative text
- The SCENE section should contain ONLY visual scene description
- DO NOT include "Do you:", choices, or options in the STORY section
- Choices will be generated separately in a different step`;static generateInitialStoryPrompt(i=!0){const f=`Create the opening scene for a new Choose Your Own Adventure story. 

Requirements:
- Set up an intriguing premise and setting
- Introduce the main character (the player)
- Create an engaging hook that draws the reader in
- End with a situation that requires a decision${i?`
- Include a brief scene description for potential image generation`:`
- Do NOT include any scene descriptions or SCENE: sections`}

Format your response as:
STORY: [The narrative text - NO choices, NO "Do you:" text, ONLY story narrative]${i?`
SCENE: [Brief visual description of the current scene for image generation]`:""}
CHOICES: [3-4 numbered choices, each on a new line]

IMPORTANT: The STORY section must contain ONLY narrative text. Do not include any choices, options, or "Do you:" prompts in the STORY section. Put all choices in the separate CHOICES section.${i?"":`

IMPORTANT: Do NOT include a SCENE section in your response. Only provide STORY and CHOICES sections.`}`;return Pt.truncateToTokenLimit(f)}static generateContinuationPrompt(i,o,c=!0){const{contextText:d,previousSegment:f,previousAction:h,segmentsIncluded:g,choicesIncluded:p}=Pt.buildEnhancedContext(o.storyHistory,o.choiceHistory,o.currentScene,5500),y=c?`
- Include a scene description for image generation`:`
- Do NOT include any scene descriptions or SCENE: sections`,j=c?`
SCENE: [Brief visual description of the new scene for image generation]`:"",T=c?"":`

IMPORTANT: Do NOT include a SCENE section in your response. Only provide STORY and CHOICES sections.`,z=`Continue the story based on the player's choice: "${i.text}"

IMMEDIATE CONTEXT:
Previous segment: ${f||"None"}
Previous action: ${h||"None"}
Current scene: ${o.currentScene}

STORY HISTORY (${g} segments, ${p} actions included):
${d}

Requirements:
- Show the consequences of the player's choice
- Advance the story meaningfully from the previous segment
- Maintain consistency with previous events and the established narrative
- Create a new situation requiring a decision${y}

Format your response as:
STORY: [The narrative text showing consequences and new developments - NO choices, NO "Do you:" text]${j}
CHOICES: [3-4 numbered choices, each on a new line]

IMPORTANT: The STORY section must contain ONLY narrative text. Do not include any choices, options, or "Do you:" prompts in the STORY section. Put all choices in the separate CHOICES section.${T}`;return Pt.truncateToTokenLimit(z)}static generateChoicesPrompt(i,o){return`Based on the current story situation, generate 3-4 meaningful choices for the player.

Current story: ${i.substring(0,500)}...
Current scene: ${o}

Requirements:
- Each choice should lead to different story outcomes
- Choices should be specific and actionable
- Avoid generic options like "Go left" or "Go right"
- Make choices feel consequential and interesting
- Keep each choice to 1-2 sentences maximum

Format your response as a numbered list:
1. [First choice option]
2. [Second choice option]
3. [Third choice option]
4. [Fourth choice option (if applicable)]`}}class ba{static async generateInitialStoryStream(i,o,c,d){const f=i.enableImageGeneration!==!1,h=[we.createSystemMessage(Wt.STORY_SYSTEM_PROMPT),we.createUserMessage(Wt.generateInitialStoryPrompt(f))];try{const{response:g,thinkingContent:p}=await we.chatCompletionStream(i,h,o,{temperature:c?.temperature??.8,maxTokens:2048,onThinkingChunk:d});return{...this.parseStoryResponse(g,f),thinkingContent:p}}catch(g){throw g instanceof te?g:new te(`Failed to generate initial story: ${g instanceof Error?g.message:"Unknown error"}`,"API_ERROR")}}static async generateInitialStory(i,o){const c=i.enableImageGeneration!==!1,d=[we.createSystemMessage(Wt.STORY_SYSTEM_PROMPT),we.createUserMessage(Wt.generateInitialStoryPrompt(c))];try{const f=await we.chatCompletionWithRetry(i,d,{temperature:o?.temperature??.8,maxTokens:2048});return this.parseStoryResponse(f,c)}catch(f){throw f instanceof te?f:new te(`Failed to generate initial story: ${f instanceof Error?f.message:"Unknown error"}`,"API_ERROR")}}static async continueStoryStream(i,o,c,d,f,h){const g=i.enableImageGeneration!==!1,p=[we.createSystemMessage(Wt.STORY_SYSTEM_PROMPT),we.createUserMessage(Wt.generateContinuationPrompt(o,c,g))];try{const{response:y,thinkingContent:j}=await we.chatCompletionStream(i,p,d,{temperature:f?.temperature??.8,maxTokens:2048,onThinkingChunk:h}),T=this.parseStoryResponse(y,g);if(T.choices.length===0){const z=await this.generateChoices(i,T.text,T.sceneDescription,f);T.choices=z}return{...T,thinkingContent:j}}catch(y){throw y instanceof te?y:new te(`Failed to continue story: ${y instanceof Error?y.message:"Unknown error"}`,"API_ERROR")}}static async continueStory(i,o,c,d){const f=i.enableImageGeneration!==!1,h=[we.createSystemMessage(Wt.STORY_SYSTEM_PROMPT),we.createUserMessage(Wt.generateContinuationPrompt(o,c,f))];try{const g=await we.chatCompletionWithRetry(i,h,{temperature:d?.temperature??.8,maxTokens:2048}),p=this.parseStoryResponse(g,f);if(p.choices.length===0){const y=await this.generateChoices(i,p.text,p.sceneDescription,d);p.choices=y}return p}catch(g){throw g instanceof te?g:new te(`Failed to continue story: ${g instanceof Error?g.message:"Unknown error"}`,"API_ERROR")}}static async generateChoices(i,o,c,d){const f=[we.createSystemMessage(Wt.STORY_SYSTEM_PROMPT),we.createUserMessage(Wt.generateChoicesPrompt(o,c))];try{const h=await we.chatCompletionWithRetry(i,f,{temperature:d?.temperature??.7,maxTokens:400});return this.parseChoicesResponse(h)}catch(h){throw h instanceof te?h:new te(`Failed to generate choices: ${h instanceof Error?h.message:"Unknown error"}`,"API_ERROR")}}static async generateInitialStoryWithRetry(i,o=3,c){let d;for(let f=1;f<=o;f++)try{const h=await this.generateInitialStory(i,c);if(h.choices.length===0){const g=await this.generateChoices(i,h.text,h.sceneDescription,c);h.choices=g}return h}catch(h){const g=h instanceof Error?h.message:"Unknown error";if(d=h instanceof te?h:new te(`Attempt ${f} failed: ${g}`,"API_ERROR"),!d.retryable)throw d;if(f===o)break;await this.delay(Math.pow(2,f-1)*1e3)}throw d}static parseStoryResponse(i,o=!0){try{const{cleanedResponse:c}=yl.parseThinkingResponse(i),d=c.match(/STORY:\s*(.*?)(?=\n\s*\*?\*?SCENE:?|\n\s*\*?\*?CHOICES:?|$)/is),f=c.match(/\*?\*?SCENE:\s*(.*?)(?=\n\s*\*?\*?CHOICES:?|$)/is),h=c.match(/\*?\*?CHOICES:?\*?\*?\s*(.*?)$/is);if(!d||!d[1]){const j=this.tryFallbackParsing(c);if(j)return j;let T="No story content found in response";throw i.includes("<think>")&&!i.includes("</think>")?T="AI response appears to be incomplete (truncated thinking). Try again or check your token limits.":i.length<50?T="AI response too short. The model may not be responding properly.":i.includes("STORY:")||(T="AI response missing expected format. The model may not be following instructions."),new Error(T)}const g=d[1].trim(),p=o&&f?f[1].trim():"A mysterious scene unfolds";if(g.length<50)throw new Error("Story content too short");let y=[];return h&&h[1]&&(y=this.parseChoicesFromText(h[1].trim())),{id:this.generateId(),text:g,sceneDescription:p,choices:y}}catch(c){throw new te(`Failed to parse story response: ${c instanceof Error?c.message:"Unknown error"}`,"PARSE_ERROR",!1)}}static parseChoicesResponse(i){try{const o=[],c=i.split(`
`).filter(d=>d.trim());for(const d of c){const f=d.match(/^\d+\.\s*(.+)$/);if(f&&f[1]){const h=f[1].trim();h.length>10&&o.push({id:this.generateId(),text:h})}}if(o.length<2)throw new Error("Not enough valid choices generated");return o.slice(0,4)}catch(o){throw new te(`Failed to parse choices response: ${o instanceof Error?o.message:"Unknown error"}`,"PARSE_ERROR",!1)}}static generateId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}static parseChoicesFromText(i){const o=[],c=i.split(`
`).filter(d=>d.trim());for(const d of c){const f=d.trim(),h=f.match(/^\d+[.)]\s*(.+)$/);h&&h[1]?o.push({id:this.generateId(),text:h[1].trim()}):f.length>0&&o.push({id:this.generateId(),text:f})}return o}static tryFallbackParsing(i){try{const o=i.trim();if(o.length<20)return null;if(o.length>50&&!o.includes("STORY:")&&!o.includes("CHOICES:")&&!o.includes("CHOICES")&&!o.includes("**CHOICES"))return{id:this.generateId(),text:o,sceneDescription:"A mysterious scene unfolds",choices:[]};const c=o.split(`
`).filter(h=>h.trim()),d=[];let f=!1;for(const h of c){const g=h.trim();g&&!g.match(/^\d+\./)&&!g.match(/^\*?\*?(STORY|SCENE|CHOICES):?\*?\*?/i)&&!g.match(/^(Do you|What do you|Your options|Choose)/i)&&(d.push(g),f=!0)}if(f&&d.length>0){const h=d.join(" ").trim();if(h.length>50)return{id:this.generateId(),text:h,sceneDescription:"A mysterious scene unfolds",choices:[]}}if(o.length>20){const h=[/You\s+(?:are|find|see|hear|feel|walk|run|stand|sit|look)\s+.*$/im,/The\s+.*$/im,/A\s+.*$/im,/As\s+you\s+.*$/im];for(const g of h){const p=o.match(g);if(p&&p[0]&&p[0].length>50)return{id:this.generateId(),text:p[0].trim(),sceneDescription:"A mysterious scene unfolds",choices:[]}}}return null}catch{return null}}static delay(i){return new Promise(o=>setTimeout(o,i))}static validateStoryContext(i){return i&&Array.isArray(i.storyHistory)&&Array.isArray(i.choiceHistory)&&typeof i.currentScene=="string"&&i.currentScene.length>0}static createStoryContext(i,o,c){return{storyHistory:[...i],choiceHistory:[...o],currentScene:c}}static async regenerateInitialStoryStream(i,o,c,d){const f={temperature:Math.min((c?.temperature??.7)+.1,1),minP:c?.minP??.05,repetitionPenalty:c?.repetitionPenalty??1.1,enableStreaming:c?.enableStreaming};return this.generateInitialStoryStream(i,o,f,d)}static async regenerateInitialStory(i,o){const c={temperature:Math.min((o?.temperature??.7)+.1,1),minP:o?.minP??.05,repetitionPenalty:o?.repetitionPenalty??1.1,enableStreaming:o?.enableStreaming};return this.generateInitialStory(i,c)}static async regenerateStoryStream(i,o,c,d,f,h){const g={temperature:Math.min((f?.temperature??.7)+.1,1),minP:f?.minP??.05,repetitionPenalty:f?.repetitionPenalty??1.1,enableStreaming:f?.enableStreaming};return this.continueStoryStream(i,o,c,d,g,h)}static async regenerateStory(i,o,c,d){const f={temperature:Math.min((d?.temperature??.7)+.1,1),minP:d?.minP??.05,repetitionPenalty:d?.repetitionPenalty??1.1,enableStreaming:d?.enableStreaming};return this.continueStory(i,o,c,f)}static async testStoryGeneration(i){try{const o=await this.generateInitialStory(i);return!o.text||o.text.length<50?{success:!1,error:"Generated story too short or empty"}:{success:!0}}catch(o){return{success:!1,error:o instanceof te?o.message:"Unknown story generation error"}}}}class $a{static CUSTOM_STORY_SYSTEM_PROMPT=`You are a creative storyteller for an interactive Choose Your Own Adventure game in CUSTOM MODE. Your role is to:

1. Continue stories based on user-provided scene descriptions and actions
2. Maintain narrative continuity and consistency
3. Keep responses SHORT, CONCISE, but descriptive (2 paragraphs max)
4. NEVER include choices or options in your response - the user provides their own actions

Guidelines:
- Write in second person ("You...")
- Each story segment should advance the plot meaningfully based on the user's input
- The STORY section should contain ONLY narrative text
- DO NOT include "Do you:", choices, options, or questions in the STORY section
- The user will provide their own custom actions`;static generateCustomInitialStoryPrompt(i,o=!0){const f=`The user has provided this initial setup for their custom adventure:
"${i}"

Begin this interactive story by:
1. Expanding on the user's setup, while avoiding purple prose
2. Creating an engaging opening situation
3. Establishing the tone and setting
4. Drawing the reader into the narrative

IMPORTANT: Do NOT include any choices or options. The user will provide their own actions.

Format your response as:
STORY: [The narrative opening - NO choices, NO "Do you:" text, ONLY story narrative]${o?`
SCENE: [Brief visual description of the current scene for image generation]`:""}${o?"":`

IMPORTANT: Do NOT include a SCENE section in your response. Only provide the STORY section.`}`;return Pt.truncateToTokenLimit(f)}static generateCustomContinuationPrompt(i,o,c=!0){const{contextText:d,previousSegment:f,previousAction:h,segmentsIncluded:g,choicesIncluded:p}=Pt.buildEnhancedContext(o.storyHistory,o.choiceHistory,o.currentScene,6e3),y=c?`
SCENE: [Brief visual description of the new scene for image generation]`:"",j=c?"":`

IMPORTANT: Do NOT include a SCENE section in your response. Only provide the STORY section.`,T=`The user chose to: "${i}"

IMMEDIATE CONTEXT:
Previous segment: ${f||"None"}
Previous action: ${h||"None"}
Current scene: ${o.currentScene}

STORY HISTORY (${g} segments, ${p} actions included):
${d}

Continue the story based on this action by:
1. Showing the immediate consequences of the user's action
2. Advancing the narrative meaningfully from the previous segment
3. Creating a new situation that flows naturally from their choice
4. Maintaining consistency with previous events and the established narrative

IMPORTANT: Do NOT include any choices or options. The user will provide their own next action.

Format your response as:
STORY: [The narrative continuation - NO choices, NO "Do you:" text, ONLY story narrative]${y}${j}`;return Pt.truncateToTokenLimit(T)}}class va{static async generateCustomInitialStoryStream(i,o,c,d,f){const h=i.enableImageGeneration!==!1,g=[we.createSystemMessage($a.CUSTOM_STORY_SYSTEM_PROMPT),we.createUserMessage($a.generateCustomInitialStoryPrompt(o,h))];try{const{response:p,thinkingContent:y}=await we.chatCompletionStream(i,g,c,{temperature:d?.temperature??.8,maxTokens:2048,onThinkingChunk:f});return{...this.parseCustomStoryResponse(p,h),thinkingContent:y}}catch(p){throw p instanceof te?p:new te(`Failed to generate custom initial story: ${p instanceof Error?p.message:"Unknown error"}`,"API_ERROR")}}static async generateCustomInitialStory(i,o,c){const d=i.enableImageGeneration!==!1,f=[we.createSystemMessage($a.CUSTOM_STORY_SYSTEM_PROMPT),we.createUserMessage($a.generateCustomInitialStoryPrompt(o,d))];try{const h=await we.chatCompletionWithRetry(i,f,{temperature:c?.temperature??.8,maxTokens:2048});return this.parseCustomStoryResponse(h,d)}catch(h){throw h instanceof te?h:new te(`Failed to generate custom initial story: ${h instanceof Error?h.message:"Unknown error"}`,"API_ERROR")}}static async continueCustomStoryStream(i,o,c,d,f,h){const g=i.enableImageGeneration!==!1,p=[we.createSystemMessage($a.CUSTOM_STORY_SYSTEM_PROMPT),we.createUserMessage($a.generateCustomContinuationPrompt(o,c,g))];try{const{response:y,thinkingContent:j}=await we.chatCompletionStream(i,p,d,{temperature:f?.temperature??.8,maxTokens:2048,onThinkingChunk:h});return{...this.parseCustomStoryResponse(y,g),thinkingContent:j}}catch(y){throw y instanceof te?y:new te(`Failed to continue custom story: ${y instanceof Error?y.message:"Unknown error"}`,"API_ERROR")}}static async continueCustomStory(i,o,c,d){const f=i.enableImageGeneration!==!1,h=[we.createSystemMessage($a.CUSTOM_STORY_SYSTEM_PROMPT),we.createUserMessage($a.generateCustomContinuationPrompt(o,c,f))];try{const g=await we.chatCompletionWithRetry(i,h,{temperature:d?.temperature??.8,maxTokens:2048});return this.parseCustomStoryResponse(g,f)}catch(g){throw g instanceof te?g:new te(`Failed to continue custom story: ${g instanceof Error?g.message:"Unknown error"}`,"API_ERROR")}}static parseCustomStoryResponse(i,o=!0){try{const{cleanedResponse:c}=yl.parseThinkingResponse(i),d=c.match(/STORY:\s*(.*?)(?=SCENE:|$)/s),f=c.match(/SCENE:\s*(.*?)$/s);if(!d||!d[1]){const p=this.tryFallbackParsing(c);if(p)return p;throw new Error("No story content found in response")}const h=d[1].trim(),g=o&&f?f[1].trim():"A mysterious scene unfolds";if(h.length<50)throw new Error("Story content too short");return{id:this.generateId(),text:h,sceneDescription:g,choices:[]}}catch(c){throw new te(`Failed to parse custom story response: ${c instanceof Error?c.message:"Unknown error"}`,"PARSE_ERROR",!1)}}static generateId(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}static validateStoryContext(i){return i&&Array.isArray(i.storyHistory)&&Array.isArray(i.choiceHistory)&&typeof i.currentScene=="string"&&i.currentScene.length>0}static createStoryContext(i,o,c){return{storyHistory:[...i],choiceHistory:[...o],currentScene:c}}static async regenerateCustomInitialStoryStream(i,o,c,d,f){const h={temperature:Math.min((d?.temperature??.8)+.1,1),minP:d?.minP??.05,repetitionPenalty:d?.repetitionPenalty??1.1,enableStreaming:d?.enableStreaming};return this.generateCustomInitialStoryStream(i,o,c,h,f)}static async regenerateCustomInitialStory(i,o,c){const d={temperature:Math.min((c?.temperature??.8)+.1,1),minP:c?.minP??.05,repetitionPenalty:c?.repetitionPenalty??1.1,enableStreaming:c?.enableStreaming};return this.generateCustomInitialStory(i,o,d)}static async regenerateCustomStoryStream(i,o,c,d,f,h){const g={temperature:Math.min((f?.temperature??.8)+.1,1),minP:f?.minP??.05,repetitionPenalty:f?.repetitionPenalty??1.1,enableStreaming:f?.enableStreaming};return this.continueCustomStoryStream(i,o,c,d,g,h)}static async regenerateCustomStory(i,o,c,d){const f={temperature:Math.min((d?.temperature??.8)+.1,1),minP:d?.minP??.05,repetitionPenalty:d?.repetitionPenalty??1.1,enableStreaming:d?.enableStreaming};return this.continueCustomStory(i,o,c,f)}static tryFallbackParsing(i){try{const o=i.trim();if(o.length>50&&!o.includes("STORY:")&&!o.includes("SCENE:"))return{id:this.generateId(),text:o,sceneDescription:"A mysterious scene unfolds",choices:[]};const c=o.split(`
`).filter(h=>h.trim()),d=[];let f=!1;for(const h of c){const g=h.trim();g&&(g.match(/^(STORY|SCENE):/i)||(d.push(g),f=!0))}if(f&&d.length>0){const h=d.join(" ").trim();if(h.length>50)return{id:this.generateId(),text:h,sceneDescription:"A mysterious scene unfolds",choices:[]}}return null}catch{return null}}static async testCustomStoryGeneration(i,o="You find yourself in a mysterious forest at twilight"){try{const c=await this.generateCustomInitialStory(i,o);return!c.text||c.text.length<50?{success:!1,error:"Generated story too short or empty"}:c.choices.length!==0?{success:!1,error:"Custom story should not include choices"}:{success:!0}}catch(c){return{success:!1,error:c instanceof te?c.message:"Unknown custom story generation error"}}}}class qo{static IMAGE_SYSTEM_PROMPT=`You are an AI assistant that creates detailed image prompts for DALL-E style image generation. Your role is to:

1. Create vivid, detailed visual descriptions
2. Focus on atmosphere, lighting, and composition
3. Include artistic style and mood descriptors
4. Keep prompts concise but descriptive (under 200 words)
5. Avoid text or writing in images

Guidelines:
- Use descriptive adjectives for mood and atmosphere
- Include lighting conditions (dramatic, soft, golden hour, etc.)
- Specify artistic style when appropriate (realistic, fantasy art, etc.)
- Focus on visual elements that enhance the story mood
- Avoid including people's faces in detail to maintain mystery`;static generateScenePrompt(i,o){let c="";if(o){const d=["Do you:","What do you do?","Your options are:","Choose your action:","You can:","Your choices:","1. **","2. **","3. **","4. **"];let f=o;for(const h of d){const g=f.indexOf(h);if(g!==-1){f=f.substring(0,g).trim();break}}f.length>50&&(c=`

Narrative context: ${f.substring(0,200)}...`)}return`Create a detailed image prompt for this scene: "${i}"${c}

Requirements:
- Focus on the environment, atmosphere, and mood
- Include lighting and weather conditions if relevant
- Specify artistic style (realistic, fantasy, cinematic, etc.)
- Keep the prompt under 200 words
- Make it visually compelling and atmospheric
- DO NOT include any choices, options, or decision text
- Focus purely on the visual scene description

Format your response as a single paragraph image prompt suitable for DALL-E or similar image generation models.`}static generateItemPrompt(i,o){const c=o?`

Context: ${o.substring(0,200)}...`:"";return`Create a detailed image prompt for this item or character: "${i}"${c}

Requirements:
- Focus on visual details, textures, and materials
- Include appropriate lighting and background
- Specify artistic style and mood
- Keep the prompt under 150 words
- Make it visually interesting and detailed

Format your response as a single paragraph image prompt suitable for DALL-E or similar image generation models.`}}class Lg{static IMAGE_REQUEST_TIMEOUT=6e4;static MAX_RETRIES=2;static async generateSceneImage(i,o,c){try{const d=await this.generateCleanImagePrompt(i,o);return await this.generateImage(i,d)}catch(d){throw d instanceof te?d:new te(`Failed to generate scene image: ${d instanceof Error?d.message:"Unknown error"}`,"API_ERROR")}}static async generateItemImage(i,o,c){try{const d=await this.generateItemImagePrompt(i,o,c);return await this.generateImage(i,d)}catch(d){throw d instanceof te?d:new te(`Failed to generate item image: ${d instanceof Error?d.message:"Unknown error"}`,"API_ERROR")}}static async generateSceneImageWithRetry(i,o,c,d=this.MAX_RETRIES){let f;for(let h=1;h<=d;h++)try{return await this.generateSceneImage(i,o,c)}catch(g){const p=g instanceof Error?g.message:"Unknown error";if(f=g instanceof te?g:new te(`Attempt ${h} failed: ${p}`,"API_ERROR"),!f.retryable)throw f;if(h===d)break;await this.delay(Math.pow(2,h)*2e3)}throw f}static async generateItemImageWithRetry(i,o,c,d=this.MAX_RETRIES){let f;for(let h=1;h<=d;h++)try{return await this.generateItemImage(i,o,c)}catch(g){const p=g instanceof Error?g.message:"Unknown error";if(f=g instanceof te?g:new te(`Attempt ${h} failed: ${p}`,"API_ERROR"),!f.retryable)throw f;if(h===d)break;await this.delay(Math.pow(2,h)*2e3)}throw f}static async generateCleanImagePrompt(i,o){const c=`Create a detailed image prompt for this scene: "${o}"

Requirements:
- Focus on the environment, atmosphere, and mood
- Include lighting and weather conditions if relevant
- Specify artistic style (realistic, fantasy, cinematic, etc.)
- Keep the prompt under 200 words
- Make it visually compelling and atmospheric
- DO NOT include any choices, options, or decision text
- Focus purely on the visual scene description

Format your response as a single paragraph image prompt suitable for DALL-E or similar image generation models.`,d=[we.createSystemMessage(qo.IMAGE_SYSTEM_PROMPT),we.createUserMessage(c)];try{return(await we.chatCompletionWithRetry(i,d,{temperature:.8,maxTokens:300})).trim()}catch(f){throw f instanceof te?f:new te(`Failed to generate image prompt: ${f instanceof Error?f.message:"Unknown error"}`,"API_ERROR")}}static async generateItemImagePrompt(i,o,c){const d=[we.createSystemMessage(qo.IMAGE_SYSTEM_PROMPT),we.createUserMessage(qo.generateItemPrompt(o,c))];try{return(await we.chatCompletionWithRetry(i,d,{temperature:.8,maxTokens:250})).trim()}catch(f){throw f instanceof te?f:new te(`Failed to generate item image prompt: ${f instanceof Error?f.message:"Unknown error"}`,"API_ERROR")}}static async generateImage(i,o){const c=i.imageConfig?.apiKey||i.apiKey,d=i.imageConfig?.baseUrl||i.baseUrl,f=i.imageConfig?.provider||"openai",h=i.imageConfig?.model||i.model;let g,p,y;switch(f){case"nano-gpt":{g=`${d}/api/generate-image`,p={prompt:o,model:h,size:"1024x1024"},y={"Content-Type":"application/json","x-api-key":c};break}case"openai":default:{g=`${d}/images/generations`,p={prompt:o,model:h,n:1,size:"1024x1024",response_format:"url"},y={Authorization:`Bearer ${c}`,"Content-Type":"application/json"};break}}try{const j=await this.makeImageRequest(g,{method:"POST",headers:y,body:JSON.stringify(p),signal:AbortSignal.timeout(this.IMAGE_REQUEST_TIMEOUT)});if(!j.ok)throw await this.handleImageErrorResponse(j);const T=await j.json();return this.parseImageResponse(T,f)}catch(j){if(j instanceof te)throw j;if(j instanceof TypeError&&j.message.includes("fetch"))throw new te("Network error: Unable to connect to image generation service","NETWORK_ERROR");if(j instanceof Error&&j.name==="AbortError")throw new te("Request timeout: Image generation took too long","TIMEOUT_ERROR");const T=j instanceof Error?j.message:"Unknown error";throw new te(`Unexpected image generation error: ${T}`,"API_ERROR")}}static async makeImageRequest(i,o){try{return await fetch(i,o)}catch(c){throw c instanceof TypeError?new te("Network error: Check your internet connection and image API endpoint","NETWORK_ERROR"):c}}static async handleImageErrorResponse(i){let o=`HTTP ${i.status}: ${i.statusText}`,c="API_ERROR",d=!0;try{const f=await i.json();f.error?.message&&(o=f.error.message)}catch{}switch(i.status){case 400:c="API_ERROR",d=!1,o="Invalid image generation request - check prompt content";break;case 401:c="AUTH_ERROR",d=!1,o="Invalid API key for image generation";break;case 403:c="AUTH_ERROR",d=!1,o="Access forbidden - check image generation permissions";break;case 429:c="API_ERROR",d=!0,o="Rate limit exceeded for image generation - please try again later";break;case 500:case 502:case 503:case 504:c="API_ERROR",d=!0,o="Image generation server error - please try again later";break}return new te(o,c,d,i.status)}static parseImageResponse(i,o="openai"){try{if(!i||typeof i!="object")throw new Error("Invalid response format: expected object");let c;switch(o){case"nano-gpt":{const d=i;if("image"in d&&typeof d.image=="string")c=d.image;else if("imageDataUrl"in d&&typeof d.imageDataUrl=="string")c=d.imageDataUrl;else if("image_url"in d&&typeof d.image_url=="string")c=d.image_url;else if("url"in d&&typeof d.url=="string")c=d.url;else if("data"in d&&Array.isArray(d.data)&&d.data.length>0){const f=d.data[0];if(f&&typeof f=="object"&&f!==null){const h=f;if("url"in h&&typeof h.url=="string")c=h.url;else if("image"in h&&typeof h.image=="string")c=h.image;else if("imageDataUrl"in h&&typeof h.imageDataUrl=="string")c=h.imageDataUrl;else if("image_url"in h&&typeof h.image_url=="string")c=h.image_url;else if("b64_json"in h&&typeof h.b64_json=="string")c=`data:image/jpeg;base64,${h.b64_json}`;else throw new Error(`Invalid nano-gpt data item format: no image URL found. Available fields: ${Object.keys(h).join(", ")}`)}else throw new Error("Invalid nano-gpt response format: no image URL found")}else throw console.error("Available fields in nano-gpt response:",Object.keys(d)),new Error(`Invalid nano-gpt response format: no image URL found. Available fields: ${Object.keys(d).join(", ")}`);break}case"openai":default:{if(!("data"in i)||!Array.isArray(i.data))throw new Error("Invalid OpenAI response format: expected data array");const d=i.data;if(d.length===0)throw new Error("No images returned from OpenAI service");const f=d[0];if(!f||typeof f!="object"||!("url"in f))throw new Error("Invalid OpenAI image format: expected url property");c=f.url;break}}if(typeof c!="string"||!c.startsWith("http")&&!c.startsWith("data:"))throw new Error("Invalid image URL format: expected valid HTTP URL or data URL");return c}catch(c){const d=c instanceof Error?c.message:"Unknown parsing error";throw new te(`Failed to parse ${o} image response: ${d}`,"PARSE_ERROR",!1)}}static async testImageGeneration(i){try{const o=await this.generateImage(i,"A simple test image of a peaceful landscape");return!o||!o.startsWith("http")?{success:!1,error:"Generated image URL is invalid"}:{success:!0}}catch(o){return{success:!1,error:o instanceof te?o.message:"Unknown image generation error"}}}static getEffectiveImageConfig(i){return{apiKey:i.imageConfig?.apiKey||i.apiKey,baseUrl:i.imageConfig?.baseUrl||i.baseUrl,model:i.imageConfig?.model||i.model}}static delay(i){return new Promise(o=>setTimeout(o,i))}static validateImageParams(i){return typeof i=="string"&&i.trim().length>10&&i.length<1e3}static createFallbackImageUrl(i){return`https://via.placeholder.com/512x512/4a5568/ffffff?text=${encodeURIComponent(i.substring(0,50))}`}}const Et={AI_CONFIG:"cyoa_ai_config",APP_SETTINGS:"cyoa_app_settings",SAVED_GAMES:"cyoa_saved_games"},Pf="1.0.0";class vs{static encode(i){return btoa(i)}static decode(i){try{return atob(i)}catch{return i}}static setItem(i,o){try{localStorage.setItem(i,this.encode(o))}catch(c){throw console.error("Failed to save to localStorage:",c),new Error("Failed to save configuration")}}static getItem(i){try{const o=localStorage.getItem(i);return o?this.decode(o):null}catch(o){return console.error("Failed to read from localStorage:",o),null}}static removeItem(i){try{localStorage.removeItem(i)}catch(o){console.error("Failed to remove from localStorage:",o)}}}class ja{static saveConfig(i){try{const o=JSON.stringify(i);vs.setItem(Et.AI_CONFIG,o)}catch(o){throw console.error("Failed to save AI config:",o),new Error("Failed to save AI configuration")}}static loadConfig(){try{const i=vs.getItem(Et.AI_CONFIG);return i?JSON.parse(i):null}catch(i){return console.error("Failed to load AI config:",i),null}}static clearConfig(){vs.removeItem(Et.AI_CONFIG)}static hasConfig(){return vs.getItem(Et.AI_CONFIG)!==null}}class Gg{static serialize(i){try{const o={...i,createdAt:i.createdAt.toISOString(),lastUpdated:i.lastUpdated.toISOString(),version:Pf};return JSON.stringify(o)}catch(o){throw console.error("Failed to serialize game state:",o),new Error("Failed to serialize game state")}}static deserialize(i){try{const o=JSON.parse(i);if(!this.validateGameState(o))throw new Error("Invalid game state format");return{...o,createdAt:new Date(o.createdAt),lastUpdated:new Date(o.lastUpdated),gameMode:o.gameMode||"standard"}}catch(o){throw console.error("Failed to deserialize game state:",o),new Error("Failed to deserialize game state")}}static validateGameState(i){if(!i||typeof i!="object")return!1;const o=i;if(!o.gameId||typeof o.gameId!="string"||!o.createdAt||!o.lastUpdated||!o.currentStory||typeof o.currentStory!="object"||!Array.isArray(o.storyHistory)||!Array.isArray(o.choiceHistory))return!1;const c=o.currentStory;if(!c.id||!c.text||!c.sceneDescription||!Array.isArray(c.choices))return!1;for(const d of c.choices){const f=d;if(!f.id||!f.text)return!1}return!0}}class Wa{static serialize(i){try{const o={...i,gameState:{...i.gameState,createdAt:i.gameState.createdAt.toISOString(),lastUpdated:i.gameState.lastUpdated.toISOString()},metadata:{...i.metadata,createdAt:i.metadata.createdAt.toISOString(),lastPlayed:i.metadata.lastPlayed.toISOString()},version:Pf};return JSON.stringify(o)}catch(o){throw console.error("Failed to serialize saved game:",o),new Error("Failed to serialize saved game")}}static deserialize(i){try{const o=JSON.parse(i);if(!this.validateSavedGame(o))throw new Error("Invalid saved game format");return{...o,gameState:{...o.gameState,createdAt:new Date(o.gameState.createdAt),lastUpdated:new Date(o.gameState.lastUpdated),gameMode:o.gameState.gameMode||"standard",customScene:o.gameState.customScene},metadata:{...o.metadata,createdAt:new Date(o.metadata.createdAt),lastPlayed:new Date(o.metadata.lastPlayed),gameMode:o.metadata.gameMode||o.gameState.gameMode||"standard"}}}catch(o){throw console.error("Failed to deserialize saved game:",o),new Error("Failed to deserialize saved game")}}static validateSavedGame(i){if(!i||typeof i!="object")return!1;const o=i;if(!o.gameId||typeof o.gameId!="string"||!o.gameState||typeof o.gameState!="object"||!o.metadata||typeof o.metadata!="object")return!1;const c=o.metadata;return!c.title||typeof c.title!="string"||!c.createdAt||!c.lastPlayed||typeof c.choiceCount!="number"?!1:Gg.validateGameState(o.gameState)}}class At{static MAX_SAVED_GAMES=10;static MAX_HISTORY_ITEMS=20;static compressGameState(i){return{...i,gameState:{...i.gameState,storyHistory:i.gameState.storyHistory.slice(-this.MAX_HISTORY_ITEMS).map(o=>({...o,imageUrl:void 0})),choiceHistory:i.gameState.choiceHistory.slice(-this.MAX_HISTORY_ITEMS)}}}static saveGame(i){try{const o=this.compressGameState(i),c=Wa.serialize(o);Wa.deserialize(c);const f=this.loadAllGames().filter(p=>p.gameId!==i.gameId);f.push(o),f.sort((p,y)=>new Date(y.metadata.lastPlayed).getTime()-new Date(p.metadata.lastPlayed).getTime());const h=f.slice(0,this.MAX_SAVED_GAMES),g=JSON.stringify(h.map(p=>Wa.serialize(p)));try{localStorage.setItem(Et.SAVED_GAMES,g)}catch(p){if(p instanceof DOMException&&p.name==="QuotaExceededError"){console.warn("Storage quota exceeded, removing old saves...");for(let y=h.length-1;y>=1;y--)try{const j=h.slice(0,y),T=JSON.stringify(j.map(z=>Wa.serialize(z)));localStorage.setItem(Et.SAVED_GAMES,T),console.log(`Successfully saved with ${y} games (removed ${h.length-y} old saves)`);return}catch{continue}throw new Error("Storage quota exceeded even after removing old saves")}throw p}}catch(o){throw console.error("Failed to save game:",o),new Error("Failed to save game: "+(o instanceof Error?o.message:"Unknown error"))}}static loadAllGames(){try{const i=localStorage.getItem(Et.SAVED_GAMES);if(!i)return[];const o=JSON.parse(i),c=[],d=[];for(const f of o)try{const h=Wa.deserialize(f);c.push(h)}catch(h){console.warn("Corrupted game data found, skipping:",h);try{const g=JSON.parse(f);g.gameId&&d.push(g.gameId)}catch{}}return d.length>0&&(console.warn(`Found ${d.length} corrupted games, cleaning up storage`),this.cleanupCorruptedGames(c)),c}catch(i){return console.error("Failed to load saved games:",i),this.clearAllGames(),[]}}static loadGame(i){try{return this.loadAllGames().find(c=>c.gameId===i)||null}catch(o){return console.error("Failed to load game:",o),null}}static deleteGame(i){try{const c=this.loadAllGames().filter(f=>f.gameId!==i),d=JSON.stringify(c.map(f=>Wa.serialize(f)));localStorage.setItem(Et.SAVED_GAMES,d)}catch(o){throw console.error("Failed to delete game:",o),new Error("Failed to delete game")}}static getMostRecentGame(){const i=this.loadAllGames();return i.length===0?null:i.reduce((o,c)=>new Date(c.metadata.lastPlayed)>new Date(o.metadata.lastPlayed)?c:o)}static hasGame(i){return this.loadAllGames().some(c=>c.gameId===i)}static getGameCount(){return this.loadAllGames().length}static clearAllGames(){try{localStorage.removeItem(Et.SAVED_GAMES)}catch(i){console.error("Failed to clear saved games:",i)}}static cleanupCorruptedGames(i){try{const o=JSON.stringify(i.map(c=>Wa.serialize(c)));localStorage.setItem(Et.SAVED_GAMES,o)}catch(o){console.error("Failed to cleanup corrupted games:",o)}}static validateAndRepairStorage(){const i={isValid:!0,repairedCount:0,errors:[]};try{const o=this.loadAllGames(),c=this.getStorageItemCount();return o.length<c&&(i.repairedCount=c-o.length,i.isValid=!1,i.errors.push(`Repaired ${i.repairedCount} corrupted game(s)`)),i}catch(o){return i.isValid=!1,i.errors.push(o instanceof Error?o.message:"Unknown storage error"),i}}static getStorageItemCount(){try{const i=localStorage.getItem(Et.SAVED_GAMES);return i?JSON.parse(i).length:0}catch{return 0}}static getStorageInfo(){try{const i=localStorage.getItem(Et.SAVED_GAMES),o=i?new Blob([i]).size:0,c=this.getGameCount();return{gameCount:c,estimatedSize:o,maxGames:this.MAX_SAVED_GAMES,canSaveMore:c<this.MAX_SAVED_GAMES}}catch{return{gameCount:0,estimatedSize:0,maxGames:this.MAX_SAVED_GAMES,canSaveMore:!0}}}static pruneOldGames(i=5){try{const o=this.loadAllGames();if(o.length<=i)return 0;o.sort((h,g)=>new Date(g.metadata.lastPlayed).getTime()-new Date(h.metadata.lastPlayed).getTime());const c=o.slice(0,i),d=o.length-i,f=JSON.stringify(c.map(h=>Wa.serialize(h)));return localStorage.setItem(Et.SAVED_GAMES,f),d}catch(o){return console.error("Failed to prune old games:",o),0}}}class Kt{static saveQueue=new Map;static SAVE_DEBOUNCE_MS=1e3;static MAX_SAVE_ATTEMPTS=3;static scheduleAutoSave(i){const o=i.gameId,c=this.saveQueue.get(o);c&&clearTimeout(c);const d=setTimeout(()=>{this.performAutoSave(i),this.saveQueue.delete(o)},this.SAVE_DEBOUNCE_MS);this.saveQueue.set(o,d)}static async performImmediateSave(i){const o=i.gameId,c=this.saveQueue.get(o);return c&&(clearTimeout(c),this.saveQueue.delete(o)),this.performAutoSave(i)}static async performAutoSave(i,o=1){try{const c=At.loadGame(i.gameId);if(c&&this.hasConflict(i,c.gameState)){console.warn("Save conflict detected, resolving...");const d=this.resolveConflict(i,c.gameState);return this.saveGameState(d)}return this.saveGameState(i)}catch(c){if(console.error(`Auto-save attempt ${o} failed:`,c),o<this.MAX_SAVE_ATTEMPTS){const d=Math.pow(2,o)*1e3;return await new Promise(f=>setTimeout(f,d)),this.performAutoSave(i,o+1)}return console.error("Auto-save failed after maximum attempts"),!1}}static saveGameState(i){try{const o={...i,gameMode:i.gameMode||"standard",customScene:i.gameMode==="custom"?i.customScene:void 0},c={gameId:o.gameId,gameState:o,metadata:{title:this.generateGameTitle(o),createdAt:o.createdAt,lastPlayed:new Date,choiceCount:o.choiceHistory.length,gameMode:o.gameMode}};return At.saveGame(c),!0}catch(o){return console.error("Failed to save game state:",o),!1}}static hasConflict(i,o){const c=i.lastUpdated.getTime();return o.lastUpdated.getTime()>c+5e3}static resolveConflict(i,o){if(o.choiceHistory.length>i.choiceHistory.length)return console.log("Resolving conflict: keeping existing state (more progress)"),{...o,lastUpdated:new Date};if(o.choiceHistory.length===i.choiceHistory.length){const c=o.lastUpdated>i.lastUpdated;return console.log(`Resolving conflict: using ${c?"existing":"new"} state (same progress, newer timestamp)`),c?o:i}return console.log("Resolving conflict: using new state (more progress)"),i}static generateGameTitle(i){const o=i.choiceHistory.length,c=i.gameId.slice(0,8),d=i.gameMode==="custom"?"Custom":"Adventure";if(i.gameMode==="custom"&&i.customScene){const p=i.customScene.trim().split(" ").filter(y=>y.length>3&&!["the","and","but","for","are","with","they","have","this","that","from","your","you"].includes(y.toLowerCase()));if(p.length>=2)return`${p.slice(0,3).join(" ")}... (${o} actions)`}const h=i.currentStory.text.split(/[.!?]+/).filter(p=>p.trim().length>0);if(h.length>0){const y=h[0].trim().split(" ").filter(j=>j.length>3&&!["the","and","but","for","are","with","they","have","this","that","from","your","you"].includes(j.toLowerCase()));if(y.length>=2){const j=y.slice(0,3).join(" "),T=i.gameMode==="custom"?"actions":"choices";return`${j}... (${o} ${T})`}}const g=i.gameMode==="custom"?"actions":"choices";return`${d} ${c} (${o} ${g})`}static validateGameState(i){const o=[];return i.gameId||o.push("Missing game ID"),i.currentStory||o.push("Missing current story"),i.createdAt||o.push("Missing creation date"),i.lastUpdated||o.push("Missing last updated date"),i.gameMode?i.gameMode!=="standard"&&i.gameMode!=="custom"&&o.push('Invalid game mode (must be "standard" or "custom")'):o.push("Missing game mode"),i.gameMode==="custom"&&(!i.customScene||i.customScene.trim().length===0?o.push("Custom mode game missing custom scene description"):i.customScene.trim().length<20?o.push("Custom scene description too short (minimum 20 characters)"):i.customScene.trim().length>500&&o.push("Custom scene description too long (maximum 500 characters)")),i.currentStory&&(i.currentStory.id||o.push("Missing story ID"),i.currentStory.text||o.push("Missing story text"),i.currentStory.sceneDescription||o.push("Missing scene description"),Array.isArray(i.currentStory.choices)||o.push("Invalid choices array")),Array.isArray(i.storyHistory)||o.push("Invalid story history"),Array.isArray(i.choiceHistory)||o.push("Invalid choice history"),i.choiceHistory.length>0&&i.storyHistory.length!==i.choiceHistory.length&&o.push("Story history and choice history length mismatch"),{isValid:o.length===0,errors:o}}static cleanup(){for(const[,i]of this.saveQueue.entries())clearTimeout(i);this.saveQueue.clear()}static getSaveStats(){return{pendingSaves:this.saveQueue.size,queuedGames:Array.from(this.saveQueue.keys())}}}const Bg=({aiConfig:x,onConfigurationNeeded:i,onBackToLauncher:o,onNewGame:c,gameToResume:d,gameMode:f,customScene:h})=>{const[g,p]=A.useState(null),[y,j]=A.useState(!1),[T,z]=A.useState(null),[G,B]=A.useState(null),[q,I]=A.useState(!1),[ue,oe]=A.useState(!1),[Q,W]=A.useState(null),[je,be]=A.useState(!1),[V,R]=A.useState(x?.samplerSettings||{temperature:.7,minP:.05,repetitionPenalty:1.1,enableStreaming:!0}),[U,Y]=A.useState(""),[se,ie]=A.useState(!1),[qe,ae]=A.useState(""),[xe,E]=A.useState(""),[L,X]=A.useState(!1),[re,ge]=A.useState(null),[v,O]=A.useState(null);A.useEffect(()=>{x?.samplerSettings&&R(x.samplerSettings)},[x]);const K=A.useCallback(Z=>{if(R(Z),x){const J={...x,samplerSettings:Z};ja.saveConfig(J)}},[x]),F=A.useCallback(Z=>{try{p(Z.gameState),z(null),j(!1)}catch(J){const $=J instanceof Error?J.message:"Failed to resume game";z($),console.error("Failed to resume game:",J)}},[]);A.useEffect(()=>{d&&F(d),I(!0)},[d,F]),A.useEffect(()=>{if(!g||!q)return;const Z=Kt.validateGameState(g);if(!Z.isValid){console.warn("Invalid game state, skipping auto-save:",Z.errors);return}return Kt.scheduleAutoSave(g),()=>{}},[g,q]),A.useEffect(()=>()=>{Kt.cleanup()},[]);const de=()=>`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,he=A.useCallback(Z=>{const J=[...Z.storyHistory,Z.currentStory];return ba.createStoryContext(J,Z.choiceHistory,Z.currentStory.sceneDescription)},[]),Se=A.useCallback(Z=>{const J=["Do you:","What do you do?","Your options are:","Choose your action:","You can:","Your choices:"];for(const $ of J){const ve=Z.indexOf($);if(ve!==-1)return Z.substring(0,ve).trim()}return Z.trim()},[]),Ue=A.useCallback(async(Z,J)=>{if(!x||x.enableImageGeneration===!1)return null;try{return oe(!0),W(null),await Lg.generateSceneImageWithRetry(x,Z.sceneDescription,J)}catch($){const ve=$ instanceof Error?$.message:"Failed to generate image";return W(ve),console.warn("Image generation failed:",ve),null}finally{oe(!1)}},[x]),Xe=A.useCallback(async()=>{if(!g||!x)return;const Z=g.storyHistory.length>0?Se(g.storyHistory[g.storyHistory.length-1].text):void 0,J=await Ue(g.currentStory,Z);if(J){const $={...g.currentStory,imageUrl:J};p({...g,currentStory:$,lastUpdated:new Date})}},[g,x,Ue,Se]),Mt=A.useCallback(async()=>{if(!x){i();return}z(null),B(null),W(null),Y(""),ae(""),E("");const Z=V.enableStreaming??!0;Z?(ie(!0),j(!1)):(j(!0),ie(!1));try{const J=Z?await ba.generateInitialStoryStream(x,ve=>{Y(le=>le+ve)},V,ve=>{ae(le=>le+ve)}):await ba.generateInitialStory(x,V);ie(!1),j(!1);const $={gameId:de(),currentStory:J,storyHistory:[],choiceHistory:[],createdAt:new Date,lastUpdated:new Date,gameMode:"standard"};p($),Y(""),E(J.thinkingContent||""),ae(""),Kt.performImmediateSave($).catch(ve=>{console.warn("Failed to perform immediate save for new game:",ve)}),Ue(J).then(ve=>{ve&&p(le=>{if(!le||le.gameId!==$.gameId)return le;const fe={...le,currentStory:{...le.currentStory,imageUrl:ve},lastUpdated:new Date};return Kt.scheduleAutoSave(fe),fe})})}catch(J){const $=J instanceof Error?J.message:"Failed to start new game";z($),B({type:"initial"}),ie(!1),Y(""),ae(""),j(!1)}},[x,i,Ue,V]),Qt=A.useCallback(async Z=>{if(!x){i();return}z(null),B(null),W(null),Y(""),ae(""),E("");const J=V.enableStreaming??!0;J?(ie(!0),j(!1)):(j(!0),ie(!1));try{const $=J?await va.generateCustomInitialStoryStream(x,Z,le=>{Y(fe=>fe+le)},V,le=>{ae(fe=>fe+le)}):await va.generateCustomInitialStory(x,Z,V);ie(!1),j(!1);const ve={gameId:de(),currentStory:$,storyHistory:[],choiceHistory:[],createdAt:new Date,lastUpdated:new Date,gameMode:"custom",customScene:Z};p(ve),Y(""),E($.thinkingContent||""),ae(""),Kt.performImmediateSave(ve).catch(le=>{console.warn("Failed to perform immediate save for new game:",le)}),Ue($).then(le=>{le&&p(fe=>{if(!fe||fe.gameId!==ve.gameId)return fe;const Oe={...fe,currentStory:{...fe.currentStory,imageUrl:le},lastUpdated:new Date};return Kt.scheduleAutoSave(Oe),Oe})})}catch($){const ve=$ instanceof Error?$.message:"Failed to start custom game";z(ve),B({type:"custom-initial",data:Z}),ie(!1),Y(""),ae(""),j(!1)}},[x,i,Ue,V]),ka=A.useCallback(async Z=>{if(!g||!x){i();return}z(null),B(null),W(null),Y(""),ae(""),E("");const J=V.enableStreaming??!0;J?(ie(!0),j(!1)):(j(!0),ie(!1));try{const $=he(g),ve=J?await ba.continueStoryStream(x,Z,$,Oe=>{Y(Ke=>Ke+Oe)},V,Oe=>{ae(Ke=>Ke+Oe)}):await ba.continueStory(x,Z,$,V);ie(!1),j(!1);const le={...g,currentStory:ve,storyHistory:[...g.storyHistory,g.currentStory],choiceHistory:[...g.choiceHistory,{...Z,selected:!0}],lastUpdated:new Date};p(le),Y(""),E(ve.thinkingContent||""),ae(""),Kt.performImmediateSave(le).catch(Oe=>{console.warn("Failed to perform immediate save after choice:",Oe)});const fe=Se(ve.text);Ue(ve,fe).then(Oe=>{Oe&&p(Ke=>!Ke||Ke.gameId!==le.gameId?Ke:{...Ke,currentStory:{...Ke.currentStory,imageUrl:Oe},lastUpdated:new Date})})}catch($){const ve=$ instanceof Error?$.message:"Failed to continue story";z(ve),B({type:"choice",data:Z}),ie(!1),Y(""),ae(""),j(!1)}},[g,x,i,he,Ue,Se,V]),xl=A.useCallback(async Z=>{if(!g||!x){i();return}z(null),B(null),W(null),Y(""),ae(""),E("");const J=V.enableStreaming??!0;J?(ie(!0),j(!1)):(j(!0),ie(!1));try{const $={id:de(),text:Z,selected:!0,isCustom:!0},ve=[...g.storyHistory,g.currentStory],le=va.createStoryContext(ve,g.choiceHistory,g.currentStory.sceneDescription),fe=J?await va.continueCustomStoryStream(x,Z,le,Rt=>{Y(ut=>ut+Rt)},V,Rt=>{ae(ut=>ut+Rt)}):await va.continueCustomStory(x,Z,le,V);ie(!1),j(!1);const Oe={...g,currentStory:fe,storyHistory:[...g.storyHistory,g.currentStory],choiceHistory:[...g.choiceHistory,$],lastUpdated:new Date};p(Oe),Y(""),E(fe.thinkingContent||""),ae(""),Kt.performImmediateSave(Oe).catch(Rt=>{console.warn("Failed to perform immediate save after custom action:",Rt)});const Ke=Se(fe.text);Ue(fe,Ke).then(Rt=>{Rt&&p(ut=>!ut||ut.gameId!==Oe.gameId?ut:{...ut,currentStory:{...ut.currentStory,imageUrl:Rt},lastUpdated:new Date})})}catch($){const ve=$ instanceof Error?$.message:"Failed to continue custom story";z(ve),B({type:"custom-action",data:Z}),ie(!1),Y(""),ae(""),j(!1)}},[g,x,i,Ue,Se,V]),ea=A.useCallback(()=>{if(G)switch(G.type){case"initial":Mt();break;case"custom-initial":typeof G.data=="string"&&Qt(G.data);break;case"choice":G.data&&typeof G.data=="object"&&ka(G.data);break;case"custom-action":typeof G.data=="string"&&xl(G.data);break}else if(g){const Z=g.choiceHistory[g.choiceHistory.length-1];Z?ka(Z):g.gameMode==="custom"&&g.customScene?Qt(g.customScene):Mt()}else f==="custom"&&h?Qt(h):Mt()},[G,g,ka,Mt,Qt,xl,f,h]),an=A.useCallback(async()=>{if(!g||!x){i();return}z(null),W(null),Y(""),ae(""),E("");const Z=V.enableStreaming??!0;Z?(ie(!0),j(!1)):(j(!0),ie(!1));try{let J;if(g.choiceHistory.length===0)g.gameMode==="custom"&&g.customScene?J=Z?await va.regenerateCustomInitialStoryStream(x,g.customScene,le=>{Y(fe=>fe+le)},V,le=>{ae(fe=>fe+le)}):await va.regenerateCustomInitialStory(x,g.customScene,V):J=Z?await ba.regenerateInitialStoryStream(x,le=>{Y(fe=>fe+le)},V,le=>{ae(fe=>fe+le)}):await ba.regenerateInitialStory(x,V);else{const le=g.choiceHistory[g.choiceHistory.length-1],fe=he(g);g.gameMode==="custom"&&le.isCustom?J=Z?await va.regenerateCustomStoryStream(x,le.text,fe,Oe=>{Y(Ke=>Ke+Oe)},V,Oe=>{ae(Ke=>Ke+Oe)}):await va.regenerateCustomStory(x,le.text,fe,V):J=Z?await ba.regenerateStoryStream(x,le,fe,Oe=>{Y(Ke=>Ke+Oe)},V,Oe=>{ae(Ke=>Ke+Oe)}):await ba.regenerateStory(x,le,fe,V)}ie(!1),j(!1);const $={...g,currentStory:J,lastUpdated:new Date};p($),Y(""),E(J.thinkingContent||""),ae(""),Kt.performImmediateSave($).catch(le=>{console.warn("Failed to perform immediate save after regeneration:",le)});const ve=Se(J.text);Ue(J,ve).then(le=>{le&&p(fe=>!fe||fe.gameId!==$.gameId?fe:{...fe,currentStory:{...fe.currentStory,imageUrl:le},lastUpdated:new Date})})}catch(J){const $=J instanceof Error?J.message:"Failed to regenerate story";z($),ie(!1),Y(""),ae(""),j(!1)}},[g,x,i,he,Ue,Se,V]),ln=A.useCallback(()=>{c?c():o?o():(p(null),z(null),j(!1))},[c,o]),Na=A.useCallback((Z,J)=>{const $=[];if(Z<0&&$.push("Segment index cannot be negative"),Z>=J.storyHistory.length&&$.push("Segment index exceeds story history length"),(!J.storyHistory||J.storyHistory.length===0)&&$.push("No story history available for rollback"),J.choiceHistory||$.push("Choice history is missing"),J.storyHistory&&J.choiceHistory){const ve=Z;J.choiceHistory.length<ve&&$.push("Insufficient choice history for rollback operation");const le=J.storyHistory[Z];le?(le.id||$.push("Target segment is missing required ID"),le.text||$.push("Target segment is missing story text"),le.sceneDescription||$.push("Target segment is missing scene description")):$.push("Target segment does not exist")}return J.gameId||$.push("Game state is missing game ID"),J.currentStory||$.push("Game state is missing current story"),{isValid:$.length===0,errors:$}},[]),nn=A.useCallback((Z,J)=>{const $=Na(Z,J);if(!$.isValid)throw new Error(`Rollback validation failed: ${$.errors.join(", ")}`);const ve=J.storyHistory[Z];if(!ve)throw new Error("Target segment does not exist");const le=J.storyHistory.length-Z-1+1,fe=J.choiceHistory.length-Z;if(le<0)throw new Error("Invalid rollback: target segment is beyond history");if(fe<0)throw new Error("Data integrity error: insufficient choice history for rollback");const Oe=J.storyHistory.slice(0,Z),Ke=J.choiceHistory.slice(0,Z),ut={...J,currentStory:ve,storyHistory:Oe,choiceHistory:Ke,lastUpdated:new Date};if(!ut.gameId||!ut.currentStory)throw new Error("Failed to create valid rollback state: missing required properties");return{targetSegmentIndex:Z,segmentsToDelete:le,choicesToDelete:fe,newGameState:ut}},[Na]),rn=A.useCallback(Z=>{if(O(null),!g){O("No game state available for rollback");return}const J=Na(Z,g);if(!J.isValid){O(`Cannot rollback: ${J.errors.join(", ")}`);return}ge(Z),X(!0)},[g,Na]),sn=A.useCallback(async()=>{if(re!==null&&g)try{O(null);const Z=Na(re,g);if(!Z.isValid)throw new Error(`Rollback validation failed: ${Z.errors.join(", ")}`);const J=nn(re,g);if(!J.newGameState)throw new Error("Failed to calculate valid rollback state");if(y||se)throw new Error("Cannot perform rollback while other operations are in progress");p(J.newGameState),z(null),W(null),B(null),j(!1),ie(!1),oe(!1),Y(""),ae("");try{await Kt.performImmediateSave(J.newGameState)}catch($){console.error("Failed to save after rollback:",$),O("Rollback completed but failed to save. Your progress may not be preserved.")}X(!1),ge(null)}catch(Z){const J=Z instanceof Error?Z.message:"Failed to perform rollback";O(J),console.error("Rollback failed:",Z)}else O(g?"No target segment selected":"No game state available"),console.error("Rollback failed: Invalid state -",{targetSegmentIndex:re,hasGameState:!!g})},[re,g,nn,Na,y,se]),on=A.useCallback(()=>{X(!1),ge(null),O(null)},[]);return A.useEffect(()=>{f==="custom"&&h&&!g&&q&&!d?Qt(h):f==="standard"&&!g&&q&&!d&&Mt()},[f,h,g,q,d]),x?!g&&!y&&!se&&!T?s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center relative",children:[s.jsx("div",{className:"absolute top-4 right-4",children:s.jsxs("button",{onClick:()=>be(!0),className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:"Adjust sampler settings",children:[s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"AI Sampler"]})}),je&&s.jsx(lr,{settings:V,onSettingsChange:K,onClose:()=>be(!1)}),s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900/30 mb-6",children:s.jsx("svg",{className:"h-8 w-8 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Ready for Adventure"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"Start a new Choose Your Own Adventure story powered by AI. Your choices will shape the narrative as it unfolds."}),s.jsx("div",{className:"space-y-4",children:s.jsxs("button",{onClick:Mt,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Start New Adventure"]})})]})}):s.jsxs("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6 space-y-4 sm:space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 w-full sm:w-auto",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Your Adventure"}),g&&s.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:["Choices made: ",g.choiceHistory.length]})]}),s.jsx("div",{className:"flex space-x-2 w-full sm:w-auto",children:s.jsxs("button",{onClick:ln,className:"inline-flex items-center justify-center flex-1 sm:flex-none px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-xs sm:text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-1 sm:mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"New Game"]})})]}),s.jsx(_g,{currentStory:g?.currentStory||null,storyHistory:g?.storyHistory||[],isLoading:y,error:T,onRetry:ea,onRegenerate:an,canRegenerate:!!g&&!y&&!se,isGeneratingImage:ue,imageError:Q,onImageRetry:Xe,samplerSettings:V,onSamplerSettingsChange:K,streamingText:U,isStreaming:se,enableImageGeneration:x?.enableImageGeneration??!0,thinkingContent:xe,streamingThinking:qe,onRollback:rn}),v&&!L&&s.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Rollback Failed"}),s.jsx("p",{className:"mt-1 text-sm text-red-700 dark:text-red-300",children:v})]}),s.jsx("div",{className:"ml-auto pl-3",children:s.jsx("button",{onClick:()=>O(null),className:"inline-flex text-red-400 hover:text-red-600 dark:text-red-500 dark:hover:text-red-300 transition-colors","aria-label":"Dismiss error",children:s.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]})}),g&&!T&&(g.gameMode==="custom"?s.jsx(Dg,{isLoading:y||se,disabled:y||se,onActionSubmit:xl,choiceHistory:g.choiceHistory}):s.jsx(Ug,{choices:g.currentStory.choices,choiceHistory:g.choiceHistory,isLoading:y||se,onChoiceSelect:ka})),g&&s.jsx(Hg,{isOpen:L,onClose:on,onConfirm:sn,segmentIndex:re||0,segmentCount:g.storyHistory.length,choiceCount:g.choiceHistory.length,error:v})]}):s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Configuration Required"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Please configure your AI settings before starting a new adventure."}),s.jsx("button",{onClick:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Configure AI Settings"})]})})},Yg=({onResumeGame:x,onDeleteGame:i,onNewGame:o})=>{const[c,d]=A.useState([]),[f,h]=A.useState(!0),[g,p]=A.useState(null),[y,j]=A.useState(null),[T,z]=A.useState(new Set),[G,B]=A.useState(!1),[q,I]=A.useState(!1);A.useEffect(()=>{ue()},[]);const ue=async()=>{try{h(!0),p(null);const U=At.loadAllGames();d(U);const Y=At.validateAndRepairStorage();!Y.isValid&&Y.errors.length>0&&console.warn("Storage validation issues:",Y.errors)}catch(U){const Y=U instanceof Error?U.message:"Failed to load saved games";p(Y),console.error("Failed to load saved games:",U)}finally{h(!1)}},oe=async U=>{try{j(U),At.deleteGame(U),d(Y=>Y.filter(se=>se.gameId!==U)),i&&i(U)}catch(Y){const se=Y instanceof Error?Y.message:"Failed to delete game";p(se),console.error("Failed to delete game:",Y)}finally{j(null)}},Q=U=>{z(Y=>{const se=new Set(Y);return se.has(U)?se.delete(U):se.add(U),se})},W=()=>{T.size===c.length?z(new Set):z(new Set(c.map(U=>U.gameId)))},je=async()=>{if(T.size!==0)try{I(!0);for(const U of T)At.deleteGame(U),i&&i(U);d(U=>U.filter(Y=>!T.has(Y.gameId))),z(new Set),B(!1)}catch(U){const Y=U instanceof Error?U.message:"Failed to delete selected games";p(Y),console.error("Failed to bulk delete games:",U)}finally{I(!1)}},be=()=>{z(new Set),B(!1)},V=U=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(U),R=U=>{const se=new Date().getTime()-U.getTime(),ie=Math.floor(se/(1e3*60*60)),qe=Math.floor(ie/24);return ie<1?"Just now":ie<24?`${ie} hour${ie>1?"s":""} ago`:qe<7?`${qe} day${qe>1?"s":""} ago`:V(U)};return f?s.jsx("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/2 sm:w-1/3 mb-4 sm:mb-6"}),s.jsx("div",{className:"space-y-3 sm:space-y-4",children:[1,2,3].map(U=>s.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[s.jsx("div",{className:"h-5 sm:h-6 bg-gray-200 dark:bg-gray-700 rounded w-3/4 sm:w-1/2 mb-2"}),s.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2 sm:w-1/4 mb-2"}),s.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 sm:w-1/3"})]},U))})]})})}):g?s.jsx("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Error Loading Games"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:g}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 sm:justify-center",children:[s.jsx("button",{onClick:ue,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Try Again"}),s.jsx("button",{onClick:o,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Start New Game"})]})]})})}):s.jsx("div",{className:"max-w-4xl mx-auto p-4 sm:p-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8",children:[s.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Your Adventures"}),c.length>1&&!G&&s.jsxs("button",{onClick:()=>B(!0),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 shadow-sm text-xs font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("span",{className:"hidden sm:inline",children:"Select Multiple"}),s.jsx("span",{className:"sm:hidden",children:"Select"})]})]}),!G&&s.jsxs("button",{onClick:o,className:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Adventure"]})]}),G&&s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[s.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium",children:[T.size," of ",c.length," selected"]}),s.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[s.jsx("button",{onClick:W,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 shadow-sm text-xs font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:T.size===c.length?"Deselect All":"Select All"}),s.jsx("button",{onClick:je,disabled:T.size===0||q,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-red-600 dark:bg-red-500 hover:bg-red-700 dark:hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:q?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"mr-1.5 h-3 w-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"hidden sm:inline",children:"Deleting..."}),s.jsx("span",{className:"sm:hidden",children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"mr-1.5 h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete (",T.size,")"]})}),s.jsx("button",{onClick:be,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-3 py-1.5 border border-gray-300 dark:border-gray-600 shadow-sm text-xs font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Cancel"})]})]})]}),c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-gray-100 dark:bg-gray-700 mb-6",children:s.jsx("svg",{className:"h-8 w-8 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No Saved Adventures"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Start your first Choose Your Own Adventure story to begin your journey."}),s.jsxs("button",{onClick:o,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Start Your First Adventure"]})]}):s.jsx("div",{className:"space-y-3 sm:space-y-4",children:c.map(U=>s.jsx("div",{className:`border rounded-lg p-4 sm:p-6 transition-colors ${G&&T.has(U.gameId)?"border-blue-300 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:s.jsxs("div",{className:"flex flex-col space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[G&&s.jsx("div",{className:"flex items-center pt-1",children:s.jsx("input",{type:"checkbox",checked:T.has(U.gameId),onChange:()=>Q(U.gameId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100 truncate",children:U.metadata.title}),U.metadata.gameMode&&s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium self-start ${U.metadata.gameMode==="custom"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:U.metadata.gameMode==="custom"?" Custom":" Standard"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 sm:gap-4 text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Choices:"})," ",U.metadata.choiceCount]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Last played:"})," ",R(U.metadata.lastPlayed)]}),s.jsxs("div",{className:"hidden sm:block",children:[s.jsx("span",{className:"font-medium",children:"Created:"})," ",V(U.metadata.createdAt)]})]})]})]}),s.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md",children:s.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 line-clamp-2 sm:line-clamp-3",children:[U.gameState.currentStory.text.substring(0,150),U.gameState.currentStory.text.length>150?"...":""]})}),!G&&s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[s.jsxs("button",{onClick:()=>x(U),className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 dark:bg-green-500 hover:bg-green-700 dark:hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-green-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resume Adventure"]}),s.jsx("button",{onClick:()=>oe(U.gameId),disabled:y===U.gameId,className:"flex-1 sm:flex-none inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm font-medium rounded-md text-red-700 dark:text-red-400 bg-white dark:bg-gray-700 hover:bg-red-50 dark:hover:bg-red-900/20 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y===U.gameId?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("span",{className:"hidden sm:inline",children:"Deleting..."}),s.jsx("span",{className:"sm:hidden",children:"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{className:"hidden sm:inline",children:"Delete"}),s.jsx("span",{className:"sm:hidden",children:"Delete"})]})})]})]})},U.gameId))})]})})},qg=({onModeSelect:x,aiConfig:i,samplerSettings:o,onSamplerSettingsChange:c})=>{const[d,f]=A.useState(!1);return s.jsxs("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8 relative",children:[s.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 sm:h-16 sm:w-16 rounded-full bg-purple-100 dark:bg-purple-900/30 mb-4 sm:mb-6",children:s.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3",children:"Choose Your Adventure Mode"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Select how you want to experience your story"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[s.jsxs("button",{onClick:()=>x("standard"),className:"group relative bg-white dark:bg-gray-700 border-2 border-gray-300 dark:border-gray-600 rounded-lg p-4 sm:p-6 hover:border-blue-500 dark:hover:border-blue-400 hover:shadow-lg transition-all duration-200 text-left focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400",children:[s.jsxs("div",{className:"flex items-start mb-3 sm:mb-4",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-colors",children:s.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),s.jsxs("div",{className:"ml-3 sm:ml-4 flex-1",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1 sm:mb-2",children:"Standard Mode"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 leading-relaxed",children:"Choose from AI-generated options at each step. Perfect for guided storytelling with curated choices."})]})]}),s.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-blue-600 dark:text-blue-400 font-medium group-hover:text-blue-700 dark:group-hover:text-blue-300",children:["Select Standard Mode",s.jsx("svg",{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),s.jsxs("button",{onClick:()=>x("custom"),className:"group relative bg-white dark:bg-gray-700 border-2 border-gray-300 dark:border-gray-600 rounded-lg p-4 sm:p-6 hover:border-purple-500 dark:hover:border-purple-400 hover:shadow-lg transition-all duration-200 text-left focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 dark:focus:ring-purple-400",children:[s.jsxs("div",{className:"flex items-start mb-3 sm:mb-4",children:[s.jsx("div",{className:"flex-shrink-0 h-10 w-10 sm:h-12 sm:w-12 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-colors",children:s.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsxs("div",{className:"ml-3 sm:ml-4 flex-1",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1 sm:mb-2",children:"Custom Scenario Mode"}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 leading-relaxed",children:"Write your own scene and actions. Complete creative freedom to shape your unique adventure."})]})]}),s.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-purple-600 dark:text-purple-400 font-medium group-hover:text-purple-700 dark:group-hover:text-purple-300",children:["Select Custom Mode",s.jsx("svg",{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})]}),s.jsxs("div",{className:"mt-6 sm:mt-8 space-y-4",children:[s.jsx("div",{className:"flex justify-center",children:s.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 dark:focus:ring-purple-400 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"AI Sampler"]})}),s.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 text-center flex items-center justify-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"You can't switch modes once your adventure begins"]})})]})]}),d&&i&&s.jsx(lr,{onClose:()=>f(!1),settings:o,onSettingsChange:c})]})},Vg=({onSceneSubmit:x,onBack:i,aiConfig:o,samplerSettings:c,onSamplerSettingsChange:d})=>{const[f,h]=A.useState(""),[g,p]=A.useState(""),[y,j]=A.useState(!1),[T,z]=A.useState(!1),[G,B]=A.useState(""),[q,I]=A.useState(""),[ue,oe]=A.useState(!1),[Q,W]=A.useState(!1),je=20,be=500,V=ae=>{const xe=ae.target.value;h(xe),g&&p("")},R=ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),ie&&U())},U=()=>{const ae=f.trim();if(ae.length===0){p("Please enter a scene description");return}if(ae.length<je){p(`Scene description must be at least ${je} characters`);return}if(ae.length>be){p(`Scene description must not exceed ${be} characters`);return}x(ae)},Y=async()=>{if(!o){B("AI configuration is required to generate scene ideas");return}z(!0),B(""),h(""),p(""),I(""),oe(!1);try{const xe=[we.createSystemMessage("You are a creative writing assistant specializing in adventure story openings. DO NOT end it with What do you do?"),we.createUserMessage(`Generate a SIMPLE and SHORT opening scene (25-75 words) for a choose-your-own-adventure story. 
Write only the scene description  no dialogue, no choices, no setup notes.

The scene should:
- Set a clear location
- Present a simple situation or problem
- Use straightforward, clear language
- Avoid flowery or overly descriptive language

Keep it SHORT it a SIMPLE scene, NO CHARACTER ACTIONS.`)];if(c.enableStreaming??!0){oe(!0);const L=yl.createStreamingProcessor();let X=!1;const{response:re,thinkingContent:ge}=await we.chatCompletionStream(o,xe,v=>{const O=L.processChunk(v);O.displayChunk&&(X||(oe(!1),W(!0),X=!0),h(K=>K+O.displayChunk))},{temperature:c?.temperature??.8,maxTokens:2048,onThinkingChunk:v=>{I(O=>O+v)}});if(oe(!1),W(!1),ge&&I(ge),re&&re.trim()){const{thinkingContent:v,cleanedResponse:O}=yl.parseThinkingResponse(re);v&&!ge&&I(v),O.trim()&&O.trim()!==f.trim()&&h(O.trim()),p("")}else B("Failed to generate scene idea. Please try again.")}else{const L=await we.chatCompletionWithRetry(o,xe,{temperature:c?.temperature??.8,maxTokens:2048});if(L&&L.trim()){const{thinkingContent:X,cleanedResponse:re}=yl.parseThinkingResponse(L);X&&I(X),h(re.trim()),p("")}else B("Failed to generate scene idea. Please try again.")}}catch(ae){const xe=ae instanceof Error?ae.message:"Failed to generate scene idea";B(xe),console.error("Scene generation error:",ae)}finally{z(!1),oe(!1),W(!1)}},se=f.length,ie=se>=je&&se<=be,qe=se>be*.9;return s.jsxs("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8",children:[s.jsxs("div",{className:"text-center mb-6 sm:mb-8 relative",children:[s.jsx("div",{className:"absolute top-0 right-0",children:s.jsxs("button",{onClick:()=>j(!0),className:"inline-flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:"Adjust AI settings",children:[s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),s.jsx("span",{className:"hidden sm:inline",children:"AI Settings"})]})}),s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 sm:h-16 sm:w-16 rounded-full bg-purple-100 dark:bg-purple-900/30 mb-4 sm:mb-6",children:s.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2 sm:mb-3",children:"Set Your Scene"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Describe the initial scene for your custom adventure"})]}),s.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"sceneDescription",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Scene Description"}),o&&s.jsx("button",{onClick:Y,disabled:T,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-700 dark:text-purple-300 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-700 rounded-md hover:bg-purple-100 dark:hover:bg-purple-900/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Generate a scene idea using AI",children:T?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ue?"Thinking...":Q?"Writing...":"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3l14 9-14 9V3z"})})," Imagine a Scene"]})})]}),q&&s.jsx("div",{className:"mb-3",children:s.jsx(Ff,{thinkingContent:q,isStreaming:ue})}),s.jsx("textarea",{id:"sceneDescription",value:f+(Q?"|":""),onChange:V,onKeyDown:R,placeholder:"You wake up in a mysterious forest, surrounded by ancient trees. The air is thick with fog, and you hear strange sounds in the distance...",rows:6,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none placeholder-gray-400 dark:placeholder-gray-500",readOnly:Q}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[je,"-",be," characters required"]}),s.jsxs("p",{className:`text-xs font-medium ${se===0?"text-gray-500 dark:text-gray-400":ie?"text-green-600 dark:text-green-400":qe?"text-orange-600 dark:text-orange-400":"text-red-600 dark:text-red-400"}`,children:[se," / ",be]})]}),g&&s.jsx("div",{className:"mt-2 p-3 rounded-md bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-red-600 dark:text-red-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.jsx("p",{className:"text-xs sm:text-sm",children:g})]})}),G&&s.jsx("div",{className:"mt-2 p-3 rounded-md bg-orange-50 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300 border border-orange-200 dark:border-orange-800",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("svg",{className:"w-4 h-4 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs sm:text-sm",children:G}),(G.includes("Empty response")||G.includes("API error")||G.includes("Failed to generate"))&&s.jsx("div",{className:"mt-2 p-2 bg-orange-100 dark:bg-orange-800/30 rounded border border-orange-300 dark:border-orange-600",children:s.jsxs("p",{className:"text-xs text-orange-700 dark:text-orange-300",children:[s.jsx("strong",{children:" Tip:"})," If scene generation fails, try adjusting your AI settings, checking your API connection, or writing your own scene description instead."]})})]})]})})]}),s.jsxs("div",{className:"p-3 sm:p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[s.jsxs("h3",{className:"text-sm font-semibold text-purple-900 dark:text-purple-300 mb-2 flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Tips for a great scene:"]}),s.jsxs("ul",{className:"text-xs sm:text-sm text-purple-800 dark:text-purple-300 space-y-1",children:[s.jsx("li",{children:" Set the location and atmosphere"}),s.jsx("li",{children:" Describe what your character sees or feels"}),s.jsx("li",{children:" Create an intriguing situation or mystery"}),s.jsx("li",{children:" Leave room for the story to develop"}),o&&s.jsx("li",{children:"  Use the Imagine tool for AI-generated inspiration"}),s.jsx("li",{children:"  If your AI uses thinking, you'll see its reasoning process above"})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 pt-2",children:[s.jsx("button",{onClick:i,disabled:T,className:"flex-1 px-4 sm:px-6 py-2 sm:py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:text-gray-400 dark:disabled:text-gray-600 disabled:cursor-not-allowed transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-gray-500 dark:focus:ring-gray-400 font-medium text-sm sm:text-base",children:" Back"}),s.jsx("button",{onClick:U,disabled:!ie,className:"flex-1 px-4 sm:px-6 py-2 sm:py-3 bg-purple-600 dark:bg-purple-500 text-white rounded-lg hover:bg-purple-700 dark:hover:bg-purple-600 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-purple-500 dark:focus:ring-purple-400 font-medium text-sm sm:text-base shadow-lg hover:shadow-xl disabled:shadow-none",children:"Start Adventure "})]})]})]}),y&&o&&s.jsx(lr,{onClose:()=>j(!1),settings:c,onSettingsChange:d})]})},Xg=({aiConfig:x,onConfigurationNeeded:i,onStartNewGame:o,onResumeGame:c,startWithModeSelection:d=!1,startWithSavedGames:f=!1})=>{const[h,g]=A.useState("welcome"),[p,y]=A.useState(null),[j,T]=A.useState(!1),[z,G]=A.useState(!0),[B,q]=A.useState(!1),[I,ue]=A.useState(x?.samplerSettings||{temperature:.7,minP:.05,repetitionPenalty:1.1}),[oe,Q]=A.useState("welcome");A.useEffect(()=>{je()},[]),A.useEffect(()=>{x?.samplerSettings&&ue(x.samplerSettings)},[x]),A.useEffect(()=>{d?Q("mode-select"):(Q("welcome"),g("welcome"))},[d]),A.useEffect(()=>{f&&(Q("welcome"),g("saved-games"))},[f]);const W=A.useCallback(xe=>{if(ue(xe),x){const E={...x,samplerSettings:xe};ja.saveConfig(E)}},[x]),je=()=>{try{G(!0);const xe=At.getGameCount(),E=At.getMostRecentGame();T(xe>0),y(E),g("welcome")}catch(xe){console.error("Failed to check for saved games:",xe),T(!1),y(null)}finally{G(!1)}},be=()=>{try{const xe=At.getGameCount(),E=At.getMostRecentGame();T(xe>0),y(E)}catch(xe){console.error("Failed to refresh saved games:",xe),T(!1),y(null)}},V=()=>{g("saved-games")},R=()=>{g("welcome"),Q("welcome"),be()},U=xe=>{console.log(`Game ${xe} deleted, refreshing list`),be()},Y=()=>{g("welcome"),Q("mode-select")},se=xe=>{xe==="custom"?Q("custom-scene"):o("standard")},ie=xe=>{o("custom",xe)},qe=()=>{Q("mode-select")},ae=()=>{Q("welcome")};return x?z?s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:s.jsxs("div",{className:"animate-pulse text-center",children:[s.jsx("div",{className:"h-16 w-16 bg-gray-200 dark:bg-gray-700 rounded-full mx-auto mb-6"}),s.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mx-auto mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mx-auto mb-8"}),s.jsx("div",{className:"h-12 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mx-auto"})]})})}):h==="saved-games"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"max-w-4xl mx-auto p-6 mb-4",children:s.jsxs("button",{onClick:R,className:"inline-flex items-center text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Welcome"]})}),s.jsx(Yg,{onResumeGame:c,onDeleteGame:U,onNewGame:Y})]}):oe==="mode-select"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 mb-4",children:s.jsxs("button",{onClick:ae,className:"inline-flex items-center text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})}),s.jsx(qg,{onModeSelect:se,aiConfig:x,samplerSettings:I,onSamplerSettingsChange:W})]}):oe==="custom-scene"?s.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6",children:s.jsx(Vg,{onSceneSubmit:ie,onBack:qe,aiConfig:x,samplerSettings:I,onSamplerSettingsChange:W})}):s.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-6 py-3 sm:py-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-8 text-center relative",children:[s.jsx("div",{className:"absolute top-2 right-2 sm:top-4 sm:right-4",children:s.jsxs("button",{onClick:()=>q(!0),className:"inline-flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:"Adjust sampler settings",children:[s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),s.jsx("span",{className:"hidden sm:inline",children:"AI Sampler"})]})}),B&&s.jsx(lr,{settings:I,onSettingsChange:W,onClose:()=>q(!1)}),s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 sm:h-16 sm:w-16 rounded-full bg-blue-100 dark:bg-blue-900/30 mb-4 sm:mb-6 mt-6 sm:mt-0",children:s.jsx("svg",{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100 mb-3 sm:mb-4",children:"Welcome to AI Adventure"}),s.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-6 sm:mb-8 px-2",children:"Experience interactive storytelling powered by AI. Your choices shape the narrative as it unfolds."}),j&&p&&s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 sm:p-6 mb-6 sm:mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-base sm:text-lg font-medium text-green-900 dark:text-green-300",children:"Continue Your Adventure"}),p.metadata.gameMode&&s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p.metadata.gameMode==="custom"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:p.metadata.gameMode==="custom"?" Custom":" Standard"})]}),s.jsxs("p",{className:"text-xs sm:text-sm text-green-700 dark:text-green-400 mb-3 sm:mb-4",children:['Resume "',p.metadata.title,'" - ',p.metadata.choiceCount," choices made"]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-md p-2 sm:p-3 mb-3 sm:mb-4",children:s.jsxs("p",{className:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 line-clamp-2 break-words",children:[p.gameState.currentStory.text.substring(0,150),p.gameState.currentStory.text.length>150?"...":""]})}),s.jsxs("button",{onClick:()=>c(p),className:"w-full sm:w-auto inline-flex items-center justify-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-sm sm:text-base font-medium rounded-md shadow-sm text-white bg-green-600 dark:bg-green-500 hover:bg-green-700 dark:hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 dark:focus:ring-green-400 transition-colors",children:[s.jsx("svg",{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Resume Adventure"]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-center justify-center",children:[s.jsxs("button",{onClick:Y,className:"w-full sm:w-64 h-14 inline-flex items-center justify-center px-6 py-4 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-3 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Start New Adventure"]}),j&&s.jsxs("button",{onClick:V,className:"w-full sm:w-64 h-14 inline-flex items-center justify-center px-6 py-4 border border-gray-300 dark:border-gray-600 shadow-sm text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:[s.jsx("svg",{className:"mr-3 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"View All Saved Games (",At.getGameCount(),")"]})]}),!j&&s.jsx("div",{className:"mt-6 sm:mt-8 p-3 sm:p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:s.jsx("p",{className:"text-xs sm:text-sm text-blue-700 dark:text-blue-300",children:" This is your first adventure! Your progress will be automatically saved as you play."})})]})}):s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Configuration Required"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Please configure your AI settings before starting or resuming an adventure."}),s.jsx("button",{onClick:i,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 dark:bg-blue-500 hover:bg-blue-700 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",children:"Configure AI Settings"})]})})};class Wf{static validateOpenAIKey(i){if(!i||typeof i!="string")return!1;const o=i.trim();return!!(o.startsWith("sk-")&&o.length>=20)}static validateGenericKey(i){if(!i||typeof i!="string")return!1;const o=i.trim();return o.length>=8&&o.length<=200?/^[a-zA-Z0-9\-_.]+$/.test(o):!1}static validateAPIKey(i){return this.validateOpenAIKey(i)?{isValid:!0,type:"openai"}:this.validateGenericKey(i)?{isValid:!0,type:"generic"}:{isValid:!1,type:"invalid"}}}class Ft{static validateBaseURL(i){if(!i||typeof i!="string")return!1;try{const o=new URL(i.trim());return!(!["http:","https:"].includes(o.protocol)||!o.hostname)}catch{return!1}}static normalizeBaseURL(i){const o=i.trim();return o.endsWith("/")?o.slice(0,-1):o}}class js{static validateConfig(i){const o=[],c=[];if(!i.apiKey)o.push("API key is required");else{const d=Wf.validateAPIKey(i.apiKey);d.isValid?d.type==="generic"&&(i.baseUrl?.includes("openai.com")||i.baseUrl?.includes("api.openai.com"))&&c.push("API key format not recognized as OpenAI - ensure compatibility"):o.push("Invalid API key format")}if(i.baseUrl?Ft.validateBaseURL(i.baseUrl)||o.push("Invalid base URL format"):o.push("Base URL is required"),i.model?(typeof i.model!="string"||i.model.trim().length===0)&&o.push("Invalid model selection"):o.push("Model selection is required"),i.imageConfig){if(i.imageConfig.provider?["openai","nano-gpt"].includes(i.imageConfig.provider)||o.push("Invalid image provider selection"):o.push("Image provider selection is required when image config is provided"),i.imageConfig.apiKey){const d=Wf.validateAPIKey(i.imageConfig.apiKey);d.isValid?d.type==="generic"&&i.imageConfig.provider==="openai"&&c.push("Image API key format not recognized as OpenAI - ensure compatibility"):o.push("Invalid image API key format")}i.imageConfig.baseUrl&&(Ft.validateBaseURL(i.imageConfig.baseUrl)||o.push("Invalid image base URL format")),i.imageConfig.model?(typeof i.imageConfig.model!="string"||i.imageConfig.model.trim().length===0)&&o.push("Invalid image model selection"):o.push("Image model selection is required when image config is provided")}return{isValid:o.length===0,errors:o,warnings:c}}static createDefaultConfig(){return{baseUrl:"https://api.openai.com/v1",model:"gpt-3.5-turbo",availableModels:[]}}static sanitizeConfig(i){const o={};return i.apiKey&&(o.apiKey=i.apiKey.trim()),i.baseUrl&&(o.baseUrl=Ft.normalizeBaseURL(i.baseUrl)),i.model&&(o.model=i.model.trim()),i.availableModels&&(o.availableModels=i.availableModels.filter(c=>typeof c=="string"&&c.trim().length>0)),typeof i.enableImageGeneration=="boolean"&&(o.enableImageGeneration=i.enableImageGeneration),i.imageConfig&&i.imageConfig.model&&i.imageConfig.provider&&(o.imageConfig={provider:i.imageConfig.provider,model:i.imageConfig.model.trim()},i.imageConfig.apiKey&&(o.imageConfig.apiKey=i.imageConfig.apiKey.trim()),i.imageConfig.baseUrl&&(o.imageConfig.baseUrl=Ft.normalizeBaseURL(i.imageConfig.baseUrl)),i.imageConfig.availableModels&&(o.imageConfig.availableModels=i.imageConfig.availableModels.filter(c=>typeof c=="string"&&c.trim().length>0))),i.samplerSettings&&(o.samplerSettings=i.samplerSettings),o}}class ct extends Error{code;retryable;constructor(i,o,c=!0){super(i),this.name="ModelServiceError",this.code=o,this.retryable=c}}class Sa{static REQUEST_TIMEOUT=1e4;static MAX_RETRIES=3;static async fetchAvailableModels(i){if(!i.apiKey||!i.baseUrl)throw new ct("API key and base URL are required","API_ERROR",!1);if(i.baseUrl.includes("api.anthropic.com"))return[{id:"claude-3-5-sonnet-20241022",name:"Claude 3.5 Sonnet (Latest)",description:"Most intelligent model"},{id:"claude-3-5-haiku-20241022",name:"Claude 3.5 Haiku",description:"Fastest model"},{id:"claude-3-opus-20240229",name:"Claude 3 Opus",description:"Powerful model for complex tasks"},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet",description:"Balanced performance"},{id:"claude-3-haiku-20240307",name:"Claude 3 Haiku",description:"Fast and efficient"}];let o=`${i.baseUrl}/models`;const c={Authorization:`Bearer ${i.apiKey}`,"Content-Type":"application/json"};i.baseUrl.includes("api.openai.com")&&(o="/api/openai/v1/models");try{const d=await this.makeRequest(o,{method:"GET",headers:c,signal:AbortSignal.timeout(this.REQUEST_TIMEOUT)});if(!d.ok)throw await this.handleErrorResponse(d);const f=await d.json();return this.parseModelsResponse(f)}catch(d){if(d instanceof ct)throw d;if(d instanceof TypeError&&d.message.includes("fetch"))throw new ct("Network error: Unable to connect to API endpoint","NETWORK_ERROR");if(d instanceof Error&&d.name==="AbortError")throw new ct("Request timeout: API took too long to respond","NETWORK_ERROR");const f=d instanceof Error?d.message:"Unknown error";throw new ct(`Unexpected error: ${f}`,"API_ERROR")}}static async validateModelAccess(i,o){try{return(await this.fetchAvailableModels(i)).some(d=>d.id===o)}catch{return!1}}static async getModelInfo(i,o){try{return(await this.fetchAvailableModels(i)).find(d=>d.id===o)||null}catch{return null}}static async fetchModelsWithRetry(i,o=this.MAX_RETRIES){let c;for(let d=1;d<=o;d++)try{return await this.fetchAvailableModels(i)}catch(f){const h=f instanceof Error?f.message:"Unknown error";if(c=f instanceof ct?f:new ct(`Attempt ${d} failed: ${h}`,"API_ERROR"),!c.retryable)throw c;if(d===o)break;await this.delay(Math.pow(2,d-1)*1e3)}throw c}static async testConnection(i){try{return await this.fetchAvailableModels(i),{success:!0}}catch(o){return{success:!1,error:o instanceof ct?o.message:"Unknown connection error"}}}static async makeRequest(i,o){try{return await fetch(i,o)}catch(c){throw c instanceof TypeError?new ct("Network error: Check your internet connection and API endpoint, If running local ensure CORS is enabled.","NETWORK_ERROR"):c}}static async handleErrorResponse(i){let o=`HTTP ${i.status}: ${i.statusText}`,c="API_ERROR",d=!0;try{const f=await i.json();f.error?.message&&(o=f.error.message)}catch{}switch(i.status){case 401:c="AUTH_ERROR",d=!1,o="Invalid API key or unauthorized access";break;case 403:c="AUTH_ERROR",d=!1,o="Access forbidden - check your API key permissions";break;case 404:c="API_ERROR",d=!1,o="API endpoint not found - check your base URL";break;case 429:c="API_ERROR",d=!0,o="Rate limit exceeded - please try again later";break;case 500:case 502:case 503:case 504:c="API_ERROR",d=!0,o="Server error - please try again later";break}return new ct(o,c,d)}static parseModelsResponse(i){try{if(!i||typeof i!="object"||!("data"in i)||!Array.isArray(i.data))throw new Error("Invalid response format: expected data array. Are you using /v1 at the end of the url?");return i.data.filter(c=>c&&typeof c=="object"&&c!==null&&"id"in c&&typeof c.id=="string").map(c=>{const d=c;return{id:d.id,name:d.id,description:d.description||void 0}}).sort((c,d)=>c.name.localeCompare(d.name))}catch(o){const c=o instanceof Error?o.message:"Unknown parsing error";throw new ct(`Failed to parse models response: ${c}`,"PARSE_ERROR",!1)}}static delay(i){return new Promise(o=>setTimeout(o,i))}static filterTextModels(i){const o=[/^gpt/i,/^claude/i,/^llama/i,/^mistral/i,/^gemini/i,/text/i,/chat/i,/instruct/i],c=[/dall-e/i,/whisper/i,/tts/i,/embedding/i,/moderation/i];return i.filter(d=>c.some(f=>f.test(d.id))?!1:(o.some(f=>f.test(d.id)),!0))}static filterImageModels(i){const o=[/^dall-e/i,/^midjourney/i,/stable.*diffusion/i,/^imagen/i,/^firefly/i,/flux/i,/playground/i,/^sd-/i,/^sdxl/i],c=[/^dall-e-2$/i,/^dall-e-3$/i,/^stable-diffusion/i,/^midjourney/i,/^flux-/i,/^playground-/i];return i.filter(d=>c.some(f=>f.test(d.id))?!0:o.some(f=>f.test(d.id))?![/gpt/i,/llama/i,/claude/i,/mistral/i,/gemini/i,/chat/i,/instruct/i,/text/i,/70b/i,/13b/i,/7b/i,/\d+b/i].some(h=>h.test(d.id)):!1)}static async fetchAvailableImageModels(i){if(i.imageConfig?.provider==="nano-gpt")return console.log("Nano-GPT provider detected - skipping model fetching (manual entry required)"),[];const o=i.imageConfig?{apiKey:i.imageConfig.apiKey||i.apiKey,baseUrl:i.imageConfig.baseUrl||i.baseUrl,model:i.imageConfig.model,availableModels:i.imageConfig.availableModels}:i,c=await this.fetchAvailableModels(o),d=this.filterImageModels(c);return d.length===0&&console.log("No image models found after filtering. All available models:",c.map(f=>f.id)),d}static async fetchImageModelsWithRetry(i,o=this.MAX_RETRIES){let c;for(let d=1;d<=o;d++)try{return await this.fetchAvailableImageModels(i)}catch(f){const h=f instanceof Error?f.message:"Unknown error";if(c=f instanceof ct?f:new ct(`Attempt ${d} failed: ${h}`,"API_ERROR"),!c.retryable)throw c;if(d===o)break;await this.delay(Math.pow(2,d-1)*1e3)}throw c}static async testImageConnection(i){if(i.imageConfig?.provider==="nano-gpt"){const o=i.imageConfig.apiKey||i.apiKey,c=i.imageConfig.baseUrl||i.baseUrl;return!o||!c?{success:!1,error:"API key and base URL are required for nano-gpt"}:{success:!0}}try{return await this.fetchAvailableImageModels(i),{success:!0}}catch(o){return{success:!1,error:o instanceof ct?o.message:"Unknown connection error"}}}static async fetchAllModelsForImageConfig(i){if(i.imageConfig?.provider==="nano-gpt")return console.log("Nano-GPT provider detected - skipping model fetching (manual entry required)"),[];const o=i.imageConfig?{apiKey:i.imageConfig.apiKey||i.apiKey,baseUrl:i.imageConfig.baseUrl||i.baseUrl,model:i.imageConfig.model,availableModels:i.imageConfig.availableModels}:i;return await this.fetchAvailableModels(o)}}const Kg=({config:x,onConfigSave:i,onClose:o,className:c=""})=>{const[d,f]=A.useState({apiKey:x?.apiKey||"",baseUrl:x?.baseUrl||"https://api.openai.com/v1",model:x?.model||"gpt-3.5-turbo",enableImageGeneration:x?.enableImageGeneration??!0,enableImageConfig:!!x?.imageConfig,imageProvider:x?.imageConfig?.provider||"openai",imageApiKey:x?.imageConfig?.apiKey||"",imageBaseUrl:x?.imageConfig?.baseUrl||"",imageModel:x?.imageConfig?.model||"dall-e-3"}),[h,g]=A.useState(x?.availableModels?.map(R=>({id:R,name:R}))||[]),[p,y]=A.useState(x?.imageConfig?.availableModels?.map(R=>({id:R,name:R}))||[]),[j,T]=A.useState({errors:[],warnings:[],isValid:!1}),[z,G]=A.useState({models:!1,testing:!1,saving:!1,imageModels:!1,imageTesting:!1}),[B,q]=A.useState({tested:!1,success:!1}),[I,ue]=A.useState({tested:!1,success:!1});A.useEffect(()=>{const R={apiKey:d.apiKey,baseUrl:d.baseUrl,model:d.model,enableImageGeneration:d.enableImageGeneration};d.enableImageConfig&&(R.imageConfig={provider:d.imageProvider,apiKey:d.imageApiKey||void 0,baseUrl:d.imageBaseUrl||void 0,model:d.imageModel});const U=js.validateConfig(R);T(U)},[d]);const oe=(R,U)=>{if(f(Y=>({...Y,[R]:U})),(R==="apiKey"||R==="baseUrl")&&(q({tested:!1,success:!1}),g([])),(R==="imageApiKey"||R==="imageBaseUrl"||R==="imageProvider")&&(ue({tested:!1,success:!1}),y([]),R==="imageProvider")){if(U==="nano-gpt"){f(Y=>({...Y,[R]:U,imageModel:"flux-1.1-pro",imageBaseUrl:Y.imageBaseUrl||"https://nano-gpt.com"}));return}else if(U==="openai"){f(Y=>({...Y,[R]:U,imageModel:"dall-e-3",imageBaseUrl:Y.imageBaseUrl||"https://api.openai.com/v1"}));return}}R==="enableImageConfig"&&!U&&(ue({tested:!1,success:!1}),y([]))},Q=async()=>{if(j.isValid){G(R=>({...R,testing:!0,models:!0})),q({tested:!1,success:!1});try{const R={apiKey:d.apiKey,baseUrl:Ft.normalizeBaseURL(d.baseUrl),model:d.model,availableModels:[]},U=await Sa.fetchAvailableModels(R),Y=Sa.filterTextModels(U);g(Y),q({tested:!0,success:!0}),!Y.some(se=>se.id===d.model)&&Y.length>0&&f(se=>({...se,model:Y[0].id}))}catch(R){const U=R instanceof ct?R.message:"Failed to connect to API";q({tested:!0,success:!1,error:U}),g([])}finally{G(R=>({...R,testing:!1,models:!1}))}}},W=async()=>{if(j.isValid){G(R=>({...R,models:!0}));try{const R={apiKey:d.apiKey,baseUrl:Ft.normalizeBaseURL(d.baseUrl),model:d.model,availableModels:[]},U=await Sa.fetchModelsWithRetry(R),Y=Sa.filterTextModels(U);g(Y)}catch(R){console.error("Failed to fetch models:",R)}finally{G(R=>({...R,models:!1}))}}},je=async()=>{if(!(!d.enableImageConfig||!j.isValid)){G(R=>({...R,imageTesting:!0,imageModels:!0})),ue({tested:!1,success:!1});try{const R={apiKey:d.apiKey,baseUrl:Ft.normalizeBaseURL(d.baseUrl),model:d.model,availableModels:[],imageConfig:{provider:d.imageProvider,apiKey:d.imageApiKey||void 0,baseUrl:d.imageBaseUrl?Ft.normalizeBaseURL(d.imageBaseUrl):void 0,model:d.imageModel,availableModels:[]}};if(d.imageProvider==="nano-gpt"){const U=await Sa.testImageConnection(R);U.success?(ue({tested:!0,success:!0}),y([])):ue({tested:!0,success:!1,error:U.error})}else{let U=await Sa.fetchAvailableImageModels(R);U.length===0&&(console.log("No image models found with filtering, fetching all models..."),U=await Sa.fetchAllModelsForImageConfig(R)),y(U),ue({tested:!0,success:!0}),!U.some(Y=>Y.id===d.imageModel)&&U.length>0&&f(Y=>({...Y,imageModel:U[0].id}))}}catch(R){const U=R instanceof ct?R.message:"Failed to connect to image API";ue({tested:!0,success:!1,error:U}),y([])}finally{G(R=>({...R,imageTesting:!1,imageModels:!1}))}}},be=async()=>{if(!(!d.enableImageConfig||!j.isValid)){G(R=>({...R,imageModels:!0}));try{const R={apiKey:d.apiKey,baseUrl:Ft.normalizeBaseURL(d.baseUrl),model:d.model,availableModels:[],imageConfig:{provider:d.imageProvider,apiKey:d.imageApiKey||void 0,baseUrl:d.imageBaseUrl?Ft.normalizeBaseURL(d.imageBaseUrl):void 0,model:d.imageModel,availableModels:[]}};if(d.imageProvider==="nano-gpt"){y([]);return}let U=await Sa.fetchImageModelsWithRetry(R);U.length===0&&(console.log("No image models found with filtering in retry, fetching all models..."),U=await Sa.fetchAllModelsForImageConfig(R)),y(U)}catch(R){console.error("Failed to fetch image models:",R)}finally{G(R=>({...R,imageModels:!1}))}}},V=async()=>{if(j.isValid){G(R=>({...R,saving:!0}));try{const R={apiKey:d.apiKey,baseUrl:d.baseUrl,model:d.model,enableImageGeneration:d.enableImageGeneration,samplerSettings:x?.samplerSettings};d.enableImageConfig&&(R.imageConfig={provider:d.imageProvider,apiKey:d.imageApiKey||void 0,baseUrl:d.imageBaseUrl||void 0,model:d.imageModel,availableModels:p.map(se=>se.id)});const U=js.sanitizeConfig(R),Y={apiKey:U.apiKey,baseUrl:U.baseUrl,model:U.model,availableModels:h.map(se=>se.id),enableImageGeneration:U.enableImageGeneration,imageConfig:U.imageConfig,samplerSettings:U.samplerSettings};i(Y)}finally{G(R=>({...R,saving:!1}))}}};return s.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 sm:p-6 max-w-2xl mx-auto ${c}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[s.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:"API Configuration"}),o&&s.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 text-2xl sm:text-xl font-bold flex-shrink-0 ml-2","aria-label":"Close settings",children:""})]}),s.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"apiKey",className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Key *"}),s.jsx("input",{id:"apiKey",type:"password",value:d.apiKey,onChange:R=>oe("apiKey",R.target.value),placeholder:"sk-...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:'Your OpenAI-compatible API key. For local LLMs, use any 8+ character string like "12345678". This is stored locally and never sent to our servers.'})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"baseUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Base URL *"}),s.jsx("input",{id:"baseUrl",type:"url",value:d.baseUrl,onChange:R=>oe("baseUrl",R.target.value),placeholder:"https://api.openai.com/v1",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"The base URL for your OpenAI-compatible API endpoint. For local LLMs with CORS enabled use something like http://127.0.0.1:1234/v1"})]}),s.jsxs("div",{children:[s.jsx("button",{onClick:Q,disabled:!j.isValid||z.testing,className:"bg-blue-600 dark:bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-700 dark:hover:bg-blue-600 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center gap-2",children:z.testing?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Testing Connection..."]}):"Test Connection & Fetch Models"}),B.tested&&s.jsx("div",{className:`mt-2 p-3 rounded-md ${B.success?"bg-green-50 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800"}`,children:B.success?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-green-600 dark:text-green-400",children:""}),"Connection successful! Found ",h.length," compatible models."]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),"Connection failed"]}),B.error&&s.jsx("p",{className:"text-sm",children:B.error}),s.jsx("button",{onClick:Q,className:"text-sm underline hover:no-underline mt-1",children:"Try again"})]})})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"model",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Model *"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{id:"model",value:d.model,onChange:R=>oe("model",R.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:h.length===0?s.jsx("option",{value:d.model,children:d.model}):h.map(R=>s.jsx("option",{value:R.id,children:R.name},R.id))}),h.length===0&&!z.models&&s.jsx("button",{onClick:W,disabled:!j.isValid,className:"px-3 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 disabled:bg-gray-50 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:"Fetch Models"})]}),z.models&&s.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 dark:border-gray-400"}),"Loading available models..."]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:h.length===0?"Test connection first to load available models":`Choose from ${h.length} available text generation models`})]}),s.jsxs("div",{className:"border-t dark:border-gray-700 pt-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("input",{id:"enableImageGeneration",type:"checkbox",checked:d.enableImageGeneration,onChange:R=>oe("enableImageGeneration",R.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"enableImageGeneration",className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Enable Image Generation"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Generate AI images for each story scene. Disable this to play without images for faster story generation."})]}),d.enableImageGeneration&&s.jsxs("div",{className:"border-t dark:border-gray-700 pt-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("input",{id:"enableImageConfig",type:"checkbox",checked:d.enableImageConfig,onChange:R=>oe("enableImageConfig",R.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"enableImageConfig",className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Separate Image Generation Configuration"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Configure a separate API endpoint and model for image generation. If disabled, the main configuration will be used for both text and images."}),d.enableImageConfig&&s.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-blue-200 dark:border-blue-800",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"imageProvider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Image Provider *"}),s.jsxs("select",{id:"imageProvider",value:d.imageProvider,onChange:R=>oe("imageProvider",R.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"openai",children:"OpenAI Compatible (DALL-E, etc.)"}),s.jsx("option",{value:"nano-gpt",children:"Nano-GPT"})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Select the image generation service provider. Different providers use different API formats."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"imageApiKey",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Image API Key"}),s.jsx("input",{id:"imageApiKey",type:"password",value:d.imageApiKey,onChange:R=>oe("imageApiKey",R.target.value),placeholder:"Leave empty to use main API key",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Optional: Use a different API key for image generation. Leave empty to use the main API key."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"imageBaseUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Image Base URL"}),s.jsx("input",{id:"imageBaseUrl",type:"url",value:d.imageBaseUrl,onChange:R=>oe("imageBaseUrl",R.target.value),placeholder:d.imageProvider==="nano-gpt"?"https://nano-gpt.com":"https://api.openai.com/v1",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Optional: Use a different base URL for image generation. Leave empty to use the main base URL.",d.imageProvider==="nano-gpt"&&" For nano-gpt, use: https://nano-gpt.com"]})]}),s.jsxs("div",{children:[s.jsx("button",{onClick:je,disabled:!j.isValid||z.imageTesting,className:"bg-purple-600 dark:bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-700 dark:hover:bg-purple-600 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center gap-2",children:z.imageTesting?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Testing Image Connection..."]}):"Test Image Connection & Fetch Models"}),I.tested&&s.jsx("div",{className:`mt-2 p-3 rounded-md ${I.success?"bg-green-50 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-200 dark:border-red-800"}`,children:I.success?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-green-600 dark:text-green-400",children:""}),d.imageProvider==="nano-gpt"?"Image connection validated! Enter your model name manually below.":`Image connection successful! Found ${p.length} compatible image models.`]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),"Image connection failed"]}),I.error&&s.jsx("p",{className:"text-sm",children:I.error}),s.jsx("button",{onClick:je,className:"text-sm underline hover:no-underline mt-1",children:"Try again"})]})})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"imageModel",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Image Model *"}),d.imageProvider==="nano-gpt"?s.jsxs("div",{children:[s.jsx("input",{id:"imageModel",type:"text",value:d.imageModel,onChange:R=>oe("imageModel",R.target.value),placeholder:"Enter model name (e.g., flux-1.1-pro, stable-diffusion-xl)",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Enter the exact model name as required by nano-gpt. Common models: flux-1.1-pro, stable-diffusion-xl, dall-e-3"})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("select",{id:"imageModel",value:d.imageModel,onChange:R=>oe("imageModel",R.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:p.length===0?s.jsx("option",{value:d.imageModel,children:d.imageModel}):p.map(R=>s.jsx("option",{value:R.id,children:R.name},R.id))}),p.length===0&&!z.imageModels&&s.jsx("button",{onClick:be,disabled:!j.isValid,className:"px-3 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 disabled:bg-gray-50 dark:disabled:bg-gray-800 disabled:cursor-not-allowed",children:"Fetch Models"})]}),z.imageModels&&s.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 dark:border-gray-400"}),"Loading available image models..."]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:p.length===0?"Test image connection first to load available models":`Choose from ${p.length} available image generation models`})]})]})]})]}),(j.errors.length>0||j.warnings.length>0)&&s.jsxs("div",{className:"space-y-2",children:[j.errors.map((R,U)=>s.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/30 p-2 rounded",children:R},`error-${U}`)),j.warnings.map((R,U)=>s.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/30 p-2 rounded",children:R},`warning-${U}`))]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t dark:border-gray-700",children:[s.jsx("button",{onClick:V,disabled:!j.isValid||z.saving,className:"bg-green-600 dark:bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-700 dark:hover:bg-green-600 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center gap-2",children:z.saving?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):"Save Configuration"}),o&&s.jsx("button",{onClick:o,className:"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-6 py-2 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",children:"Cancel"})]})]})]})},Qg=({onGetStarted:x})=>s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-20 w-20 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 mb-8",children:s.jsx("svg",{className:"h-10 w-10 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Welcome to AI Adventure"}),s.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Experience interactive storytelling powered by artificial intelligence"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8 text-left",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 h-6 w-6 rounded-full bg-green-100 flex items-center justify-center mt-1",children:s.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Dynamic Stories"}),s.jsx("p",{className:"text-sm text-gray-600",children:"AI creates unique narratives based on your choices"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 h-6 w-6 rounded-full bg-green-100 flex items-center justify-center mt-1",children:s.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Visual Scenes"}),s.jsx("p",{className:"text-sm text-gray-600",children:"AI-generated images bring your adventure to life"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 h-6 w-6 rounded-full bg-green-100 flex items-center justify-center mt-1",children:s.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Your API Key"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Use your own OpenAI-compatible API for full control"})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 h-6 w-6 rounded-full bg-green-100 flex items-center justify-center mt-1",children:s.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Auto-Save"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Your progress is automatically saved as you play"})]})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8",children:[s.jsxs("div",{className:"flex items-center justify-center mb-3",children:[s.jsx("svg",{className:"h-6 w-6 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Quick Setup Required"})]}),s.jsx("p",{className:"text-blue-800 text-sm",children:"To get started, you'll need to configure your OpenAI-compatible API key. This allows the AI to generate your personalized adventure stories and images."}),s.jsxs("div",{className:"mt-4 text-xs text-blue-700",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Supported services:"})," OpenAI, Azure OpenAI, and other compatible APIs"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Privacy:"})," Your API key is stored securely on your device only"]})]})]}),s.jsxs("button",{onClick:x,className:"inline-flex items-center px-8 py-4 border border-transparent text-lg font-medium rounded-lg shadow-sm text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 transform hover:scale-105",children:[s.jsx("svg",{className:"mr-3 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),"Get Started"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-6",children:"By continuing, you agree to configure your own AI service credentials"})]})})}),e0=A.createContext(void 0),Ig=({children:x})=>{const[i,o]=A.useState([]),c=A.useCallback(()=>`error-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,[]),d=A.useCallback((z,G,B,q=!0)=>{const I={id:c(),message:z,type:G,timestamp:new Date,retryAction:B,dismissible:!0,autoHide:q};return o(ue=>[...ue,I]),q&&(G==="success"||G==="info"||G==="warning")&&setTimeout(()=>{o(ue=>ue.filter(oe=>oe.id!==I.id))},5e3),I.id},[c]),f=A.useCallback((z,G)=>d(z,"error",G,!1),[d]),h=A.useCallback(z=>d(z,"warning",void 0,!0),[d]),g=A.useCallback(z=>d(z,"info",void 0,!0),[d]),p=A.useCallback(z=>d(z,"success",void 0,!0),[d]),y=A.useCallback(z=>{o(G=>G.filter(B=>B.id!==z))},[]),j=A.useCallback(()=>{o([])},[]),T={errors:i,showError:f,showWarning:h,showInfo:g,showSuccess:p,dismissError:y,clearAllErrors:j};return s.jsx(e0.Provider,{value:T,children:x})},t0=()=>{const x=A.useContext(e0);if(!x)throw new Error("useError must be used within an ErrorProvider");return x},a0=A.createContext(void 0),Zg=({children:x})=>{const[i,o]=A.useState(()=>localStorage.getItem("theme")||"light");A.useEffect(()=>{const f=window.document.documentElement;f.classList.remove("light","dark"),f.classList.add(i),localStorage.setItem("theme",i)},[i]);const c=()=>{o(f=>f==="light"?"dark":"light")},d=f=>{o(f)};return s.jsx(a0.Provider,{value:{theme:i,toggleTheme:c,setTheme:d},children:x})},Jg=()=>{const x=A.useContext(a0);if(!x)throw new Error("useTheme must be used within ThemeProvider");return x},$g=()=>{const{errors:x,dismissError:i}=t0();if(x.length===0)return null;const o=f=>{switch(f){case"error":return s.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})});case"warning":return s.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})});case"success":return s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"info":return s.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},c=f=>{switch(f){case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"success":return"bg-green-50 border-green-200 text-green-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800"}},d=f=>{switch(f){case"error":return"text-red-600 hover:text-red-800 hover:bg-red-100";case"warning":return"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100";case"success":return"text-green-600 hover:text-green-800 hover:bg-green-100";case"info":return"text-blue-600 hover:text-blue-800 hover:bg-blue-100"}};return s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm",children:x.map(f=>s.jsx("div",{className:`rounded-lg border p-4 shadow-lg transition-all duration-300 ${c(f.type)}`,children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:o(f.type)}),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsx("p",{className:"text-sm font-medium",children:f.message}),f.timestamp&&s.jsx("p",{className:"text-xs opacity-75 mt-1",children:f.timestamp.toLocaleTimeString()})]}),s.jsxs("div",{className:"ml-4 flex-shrink-0 flex space-x-1",children:[f.retryAction&&s.jsxs("button",{onClick:()=>{f.retryAction(),i(f.id)},className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded transition-colors ${d(f.type)}`,title:"Retry operation",children:[s.jsx("svg",{className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Retry"]}),f.dismissible&&s.jsx("button",{onClick:()=>i(f.id),className:`inline-flex items-center p-1 text-xs rounded transition-colors ${d(f.type)}`,title:"Dismiss notification",children:s.jsx("svg",{className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})},f.id))})},Wg=({message:x="Loading...",size:i="medium",inline:o=!1,className:c=""})=>{const d=()=>{switch(i){case"small":return"h-4 w-4";case"medium":return"h-6 w-6";case"large":return"h-8 w-8"}},f=()=>{switch(i){case"small":return"text-xs";case"medium":return"text-sm";case"large":return"text-base"}};return o?s.jsxs("div",{className:`inline-flex items-center space-x-2 ${c}`,children:[s.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${d()}`}),x&&s.jsx("span",{className:`text-gray-600 ${f()}`,children:x})]}):s.jsxs("div",{className:`flex flex-col items-center justify-center space-y-3 ${c}`,children:[s.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${d()}`}),x&&s.jsx("p",{className:`text-gray-600 ${f()} text-center`,children:x})]})},Fg=()=>{const{theme:x,toggleTheme:i}=Jg();return s.jsx("button",{onClick:i,className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors","aria-label":`Switch to ${x==="light"?"dark":"light"} mode`,title:`Switch to ${x==="light"?"dark":"light"} mode`,children:x==="light"?s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})};class Pg extends Ng.Component{constructor(i){super(i),this.state={hasError:!1}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,o){console.error("Error caught by boundary:",i,o),this.props.onError?.(i,o)}render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-md mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center",children:[s.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900 mb-4",children:s.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"An unexpected error occurred. Please refresh the page to try again."}),s.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Refresh Page"})]})}):this.props.children}}const eh=()=>s.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex items-center justify-center",children:s.jsx(Wg,{message:"Loading your adventure...",size:"large"})}),th=()=>{const[x,i]=A.useState("welcome"),[o,c]=A.useState(null),[d,f]=A.useState(null),[h,g]=A.useState(!0),[p,y]=A.useState(!1),[j,T]=A.useState(0),[z,G]=A.useState(!1),{showError:B,showSuccess:q,showWarning:I,clearAllErrors:ue}=t0(),oe=A.useCallback(async()=>{try{g(!0),ue();const L=ja.loadConfig(),X=At.getGameCount()>0;if(L){const ge=js.validateConfig(L);ge.isValid?(c(L),i("launcher"),y(!1),ge.warnings.length>0&&ge.warnings.forEach(v=>I(v))):(console.warn("Invalid existing config found:",ge.errors),I("Your saved configuration is invalid and needs to be updated."),y(!0),i("welcome"))}else X?(i("settings"),y(!1),I("Please configure your AI settings to continue playing.")):(y(!0),i("welcome"));const re=At.validateAndRepairStorage();re.isValid||(console.warn("Storage validation issues:",re.errors),re.repairedCount>0&&I(`Repaired ${re.repairedCount} corrupted saved game(s).`),re.errors.forEach(ge=>{ge.includes("Repaired")||B(ge,()=>oe())}))}catch(L){const X=L instanceof Error?L.message:"Failed to initialize application";B(X,()=>oe()),console.error("App initialization error:",L)}finally{g(!1)}},[B,I,ue]);A.useEffect(()=>{oe()},[oe]);const Q=L=>{try{const X=js.validateConfig(L);if(!X.isValid){B(`Configuration validation failed: ${X.errors.join(", ")}`);return}ja.saveConfig(L),c(L),i("launcher"),y(!1),q("AI configuration saved successfully!"),X.warnings.length>0&&X.warnings.forEach(re=>I(re))}catch(X){const re=X instanceof Error?X.message:"Failed to save configuration";B(re,()=>Q(L)),console.error("Config save error:",X)}},W=()=>{i("settings")},[je,be]=A.useState("standard"),[V,R]=A.useState(void 0),[U,Y]=A.useState(!1),se=(L="standard",X)=>{f(null),be(L),R(X),Y(!1),G(!1);const re=ja.loadConfig();re&&c(re),i("game")},ie=L=>{f(L),Y(!1),G(!1);const X=ja.loadConfig();X&&c(X),i("game")},qe=()=>{const L=ja.loadConfig();L&&c(L),i("settings")},ae=()=>{f(null);const L=ja.loadConfig();L&&c(L),x==="game"||x==="settings"?(Y(!1),G(!0),i("launcher")):(Y(!1),G(!1),i("launcher"),T(X=>X+1))},xe=()=>{f(null);const L=ja.loadConfig();L&&c(L),Y(!0),G(!1),i("launcher")},E=(L,X)=>{console.error("Global error boundary triggered:",L,X),B(`Application error: ${L.message}`,()=>window.location.reload())};return h?s.jsx(eh,{}):s.jsx(Pg,{onError:E,children:s.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col",children:[x!=="welcome"&&s.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:s.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-14 sm:h-16",children:[s.jsx("div",{className:"flex items-center min-w-0",children:s.jsxs("button",{onClick:ae,className:"flex items-center space-x-2 text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:[s.jsx("div",{className:"flex items-center justify-center h-7 w-7 sm:h-8 sm:w-8 rounded-full bg-blue-100 dark:bg-blue-900 flex-shrink-0",children:s.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),s.jsx("h1",{className:"text-base sm:text-xl font-bold truncate",children:"AI Adventure"})]})}),s.jsxs("nav",{className:"flex items-center space-x-1 sm:space-x-4",children:[s.jsx(Fg,{}),x!=="launcher"&&s.jsxs("button",{onClick:ae,className:"inline-flex items-center px-2 sm:px-3 py-1.5 sm:py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-xs sm:text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[s.jsxs("svg",{className:"sm:mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"})]}),s.jsx("span",{className:"hidden sm:inline",children:"Games"})]}),s.jsxs("button",{onClick:qe,className:`inline-flex items-center px-2 sm:px-3 py-1.5 sm:py-2 border shadow-sm text-xs sm:text-sm leading-4 font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${x==="settings"?"border-blue-300 dark:border-blue-600 text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900 hover:bg-blue-100 dark:hover:bg-blue-800":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[s.jsxs("svg",{className:"sm:mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]})]})})}),s.jsxs("main",{className:`flex-1 ${x==="welcome"?"":"py-3 sm:py-6"}`,children:[x==="welcome"&&s.jsx(Qg,{onGetStarted:W}),x==="settings"&&s.jsx("div",{className:"max-w-4xl mx-auto px-2 sm:px-4 lg:px-8",children:s.jsx(Kg,{config:o,onConfigSave:Q,onClose:p?void 0:()=>i("launcher")})}),x==="launcher"&&s.jsx(Xg,{aiConfig:o,onConfigurationNeeded:qe,onStartNewGame:se,onResumeGame:ie,startWithModeSelection:U,startWithSavedGames:z},j),x==="game"&&s.jsx(Bg,{aiConfig:o,onConfigurationNeeded:qe,onBackToLauncher:ae,onNewGame:xe,gameToResume:d,gameMode:je,customScene:V})]}),x!=="welcome"&&s.jsx("footer",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 flex-shrink-0",children:s.jsx("div",{className:"max-w-7xl mx-auto py-3 sm:py-4 px-2 sm:px-4 lg:px-8",children:s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-2 text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:[s.jsx("p",{className:"text-center sm:text-left",children:"AI-powered CYOA"}),s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[o&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",children:[s.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full mr-1"}),"Connected"]}),s.jsxs("span",{className:"truncate max-w-[150px] sm:max-w-none",children:["Model: ",o?.model||"Not configured"]})]})]})})}),s.jsx($g,{})]})})};function ah(){return s.jsx(Zg,{children:s.jsx(Ig,{children:s.jsx(th,{})})})}Rg.createRoot(document.getElementById("root")).render(s.jsx(A.StrictMode,{children:s.jsx(ah,{})}));
